<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Model Components API Reference &#8212; SciStanPy Alpha documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../../_static/documentation_options.js?v=6b921976"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Abstract Model Component API Reference" href="abstract_model_component.html" />
    <link rel="prev" title="Model API Reference" href="../index.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="model-components-api-reference">
<h1>Model Components API Reference<a class="headerlink" href="#model-components-api-reference" title="Link to this heading">¶</a></h1>
<p>This reference covers the comprehensive model component framework in SciStanPy.</p>
<p>The model components submodule provides the foundational building blocks for constructing probabilistic models. It includes abstract interfaces, concrete parameter implementations, mathematical transformations, and specialized probability distributions.</p>
<section id="model-components-submodule-overview">
<h2>Model Components Submodule Overview<a class="headerlink" href="#model-components-submodule-overview" title="Link to this heading">¶</a></h2>
<p>The model components submodule consists of several key areas:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="abstract_model_component.html">Abstract Model Component API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">Constants API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_distributions/index.html">Custom Distributions API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">Parameters API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="transformations/index.html">Transformations API Reference</a></li>
</ul>
</div>
</section>
<section id="component-architecture">
<h2>Component Architecture<a class="headerlink" href="#component-architecture" title="Link to this heading">¶</a></h2>
<p>Core model components for SciStanPy probabilistic modeling framework.</p>
<p>This submodule contains the fundamental building blocks for constructing
probabilistic models in SciStanPy. It provides a comprehensive set of
components that enable users to define complex probabilistic models through
composition of simple, well-defined elements.</p>
<p>The components system is designed around several key principles:</p>
<dl class="simple">
<dt><strong>Multi-Backend Support</strong>: All components work across NumPy, PyTorch, and Stan</dt><dd><p>backends, enabling flexible computation while maintaining consistent interfaces.</p>
</dd>
<dt><strong>Automatic Code Generation</strong>: Components automatically generate appropriate</dt><dd><p>Stan code for their mathematical operations, enabling compilation to
high-performance sampling algorithms.</p>
</dd>
<dt><strong>Compositional Design</strong>: Complex models are built by combining simple components</dt><dd><p>through mathematical operations and transformations.</p>
</dd>
<dt><strong>Type Safety</strong>: Comprehensive type checking and validation ensure model</dt><dd><p>correctness and provide clear error messages.</p>
</dd>
</dl>
<p>Core Component Categories:</p>
<dl class="simple">
<dt><strong>Abstract Infrastructure</strong> (abstract_model_component):</dt><dd><p>Base classes and interfaces that define the fundamental behavior and
structure of all model components. Provides the foundation for shape
inference, Stan code generation, and multi-backend operation.</p>
</dd>
<dt><strong>Probability Distributions</strong> (parameters):</dt><dd><p>Comprehensive library of probability distributions for both continuous
and discrete random variables. Includes standard distributions with
enhanced functionality and multiple parameterizations for flexibility.</p>
</dd>
<dt><strong>Mathematical Transformations</strong> (transformations):</dt><dd><p>Operations that combine and transform parameters through mathematical
functions. Enables creation of complex relationships while maintaining
automatic differentiation and Stan code generation.</p>
</dd>
<dt><strong>Custom Distributions</strong> (custom_distributions):</dt><dd><p>Extended and custom distribution implementations that address limitations
in standard libraries. Provides enhanced batch operations, numerical
stability improvements, and distributions not available elsewhere.</p>
</dd>
<dt><strong>Constants and Data</strong> (constants):</dt><dd><p>Components for incorporating fixed data and constants into models.
Handles data input, shape validation, and integration with variable
components.</p>
</dd>
</dl>
<p>Key Features:</p>
<dl class="simple">
<dt><strong>Automatic Shape Inference</strong>: Components automatically determine output</dt><dd><p>shapes based on input shapes and mathematical operations, reducing
the need for manual shape specification.</p>
</dd>
<dt><strong>Stan Code Generation</strong>: All components can generate appropriate Stan</dt><dd><p>code for their operations, enabling compilation to efficient MCMC
and optimization algorithms.</p>
</dd>
<dt><strong>Gradient Compatibility</strong>: Components maintain PyTorch tensor operations</dt><dd><p>with automatic differentiation for gradient-based optimization and
variational inference.</p>
</dd>
<dt><strong>Error Checking</strong>: Comprehensive validation of parameter constraints,</dt><dd><p>shape compatibility, and mathematical validity with informative
error messages.</p>
</dd>
</dl>
</section>
<section id="component-hierarchy">
<h2>Component Hierarchy<a class="headerlink" href="#component-hierarchy" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt><strong>Foundation Layer</strong></dt><dd><p>Abstract base classes that define the core component interface and behavior patterns</p>
</dd>
<dt><strong>Parameter Layer</strong></dt><dd><p>Concrete implementations of probability distributions and statistical parameters</p>
</dd>
<dt><strong>Transformation Layer</strong></dt><dd><p>Mathematical operations and transformations that can be applied to parameters</p>
</dd>
<dt><strong>Specialization Layer</strong></dt><dd><p>Custom distributions and domain-specific components for advanced modeling</p>
</dd>
</dl>
</section>
<section id="key-design-principles">
<h2>Key Design Principles<a class="headerlink" href="#key-design-principles" title="Link to this heading">¶</a></h2>
<p><strong>Compositional Design:</strong></p>
<p>All components follow a compositional design that enables complex model construction through combination of simple elements:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scistanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ssp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Basic components</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Composition through mathematical operations</span>
<span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">linear_predictor</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x_data</span>

<span class="c1"># Further composition</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">linear_predictor</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">noise</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Automatic Dependency Tracking:</strong></p>
<p>Components automatically track their relationships to enable proper Stan code generation and sampling:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dependencies are tracked automatically</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Linear predictor depends on: </span><span class="si">{</span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">model_varname</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">linear_predictor</span><span class="o">.</span><span class="n">parents</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Intercept is used by: </span><span class="si">{</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">model_varname</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">intercept</span><span class="o">.</span><span class="n">children</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Multi-Backend Support:</strong></p>
<p>All components work consistently across NumPy, PyTorch, and Stan backends:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Same model, different backends</span>
<span class="n">samples_numpy</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">likelihood</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>           <span class="c1"># NumPy backend</span>
<span class="n">likelihood</span><span class="o">.</span><span class="n">init_pytorch</span><span class="p">()</span>                           <span class="c1"># Switch to PyTorch</span>
<span class="n">tensor_samples</span> <span class="o">=</span> <span class="n">likelihood</span><span class="o">.</span><span class="n">torch_parametrization</span>   <span class="c1"># PyTorch tensors</span>
<span class="n">stan_model</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">likelihood</span><span class="p">)</span><span class="o">.</span><span class="n">to_stan</span><span class="p">()</span>        <span class="c1"># Stan backend</span>
</pre></div>
</div>
</section>
<section id="component-types">
<h2>Component Types<a class="headerlink" href="#component-types" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt><strong>Parameters:</strong></dt><dd><p>Probability distributions representing unknown quantities to be inferred</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Various parameter types</span>
<span class="n">continuous_param</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">discrete_param</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Poisson</span><span class="p">(</span><span class="n">lambda_</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">simplex_param</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">positive_param</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt><strong>Constants:</strong></dt><dd><p>Fixed values that provide structure and constraints to models</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constants with different characteristics</span>
<span class="n">data_matrix</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="n">X_data</span><span class="p">)</span>
<span class="n">hyperparameter</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">design_point</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">Constant</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">enforce_uniformity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt><strong>Transformations:</strong></dt><dd><p>Mathematical operations that create derived quantities</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mathematical transformations</span>
<span class="n">base_param</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">exp_transform</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">base_param</span><span class="p">)</span>      <span class="c1"># Exponential transformation</span>
<span class="n">standardized</span> <span class="o">=</span> <span class="p">(</span><span class="n">base_param</span> <span class="o">-</span> <span class="n">mu_hat</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma_hat</span>    <span class="c1"># Arithmetic operations</span>
<span class="n">indexed</span> <span class="o">=</span> <span class="n">matrix_param</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span>                     <span class="c1"># Array indexing</span>
</pre></div>
</div>
<dl class="simple">
<dt><strong>Custom Distributions:</strong></dt><dd><p>Specialized probability distributions for domain-specific modeling</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Custom distributions for advanced modeling</span>
<span class="n">log_wealth</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">ExpLomax</span><span class="p">(</span><span class="n">lambda_</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>    <span class="c1"># Heavy-tailed</span>
<span class="n">log_proportions</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">ExpDirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># Log-simplex</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">MultinomialLogit</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="n">logits</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>   <span class="c1"># Unconstrained</span>
</pre></div>
</div>
</section>
<section id="component-relationships">
<h2>Component Relationships<a class="headerlink" href="#component-relationships" title="Link to this heading">¶</a></h2>
<p><strong>Parent-Child Dependencies:</strong></p>
<p>Components form directed acyclic graphs representing dependency relationships:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build dependency relationships</span>
<span class="n">global_mean</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">group_effects</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span>
    <span class="n">mu</span><span class="o">=</span><span class="n">global_mean</span><span class="p">,</span>  <span class="c1"># Parent relationship</span>
    <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,)</span>
<span class="p">)</span>
<span class="n">observations</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span>
    <span class="n">mu</span><span class="o">=</span><span class="n">group_effects</span><span class="p">,</span>  <span class="c1"># Another parent relationship</span>
    <span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span>
<span class="p">)</span>

<span class="c1"># Analyze relationships</span>
<span class="k">def</span><span class="w"> </span><span class="nf">show_dependencies</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="s2">&quot;  &quot;</span> <span class="o">*</span> <span class="n">level</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">indent</span><span class="si">}{</span><span class="n">component</span><span class="o">.</span><span class="n">model_varname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">component</span><span class="o">.</span><span class="n">parents</span><span class="p">:</span>
        <span class="n">show_dependencies</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">show_dependencies</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Shape Broadcasting:</strong></p>
<p>Components automatically handle shape broadcasting following NumPy conventions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Automatic shape inference and broadcasting</span>
<span class="n">scalar_param</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>          <span class="c1"># Shape: ()</span>
<span class="n">vector_param</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,))</span> <span class="c1"># Shape: (5,)</span>

<span class="c1"># Broadcasting in operations</span>
<span class="n">broadcasted</span> <span class="o">=</span> <span class="n">scalar_param</span> <span class="o">+</span> <span class="n">vector_param</span>  <span class="c1"># Result shape: (5,)</span>

<span class="c1"># Multi-dimensional broadcasting</span>
<span class="n">matrix_param</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">vector_param</span> <span class="o">+</span> <span class="n">matrix_param</span>  <span class="c1"># Result shape: (3, 5)</span>
</pre></div>
</div>
</section>
<section id="stan-code-generation">
<h2>Stan Code Generation<a class="headerlink" href="#stan-code-generation" title="Link to this heading">¶</a></h2>
<p><strong>Automatic Code Generation:</strong></p>
<p>Components automatically generate appropriate Stan code for all program blocks:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Components generate Stan code automatically</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
<span class="n">stan_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to_stan</span><span class="p">()</span>

<span class="c1"># Inspect generated code</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generated Stan program:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stan_model</span><span class="o">.</span><span class="n">code</span><span class="p">())</span>
</pre></div>
</div>
<p><strong>Block Organization:</strong></p>
<p>Components are automatically organized into appropriate Stan program blocks:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example of generated Stan structure:</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">data {</span>
<span class="sd">    // Observable parameters and constants</span>
<span class="sd">}</span>

<span class="sd">parameters {</span>
<span class="sd">    // Unobserved parameters for inference</span>
<span class="sd">}</span>

<span class="sd">transformed parameters {</span>
<span class="sd">    // Derived quantities and transformations</span>
<span class="sd">}</span>

<span class="sd">model {</span>
<span class="sd">    // Prior and likelihood statements</span>
<span class="sd">}</span>

<span class="sd">generated quantities {</span>
<span class="sd">    // Posterior predictive samples</span>
<span class="sd">}</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p><strong>Loop Optimization:</strong></p>
<p>Multi-dimensional components generate optimized Stan loops:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Multi-dimensional parameter</span>
<span class="n">param_3d</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># Generates optimized Stan loops:</span>
<span class="c1"># for (i in 1:4) {</span>
<span class="c1">#     for (j in 1:5) {</span>
<span class="c1">#         param_3d[i,j] ~ normal(0, 1);  // Last dimension vectorized</span>
<span class="c1">#     }</span>
<span class="c1"># }</span>
</pre></div>
</div>
</section>
<section id="advanced-component-features">
<h2>Advanced Component Features<a class="headerlink" href="#advanced-component-features" title="Link to this heading">¶</a></h2>
<p><strong>Observable Parameters:</strong></p>
<p>Parameters can be marked as observable to represent known data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Observable parameters represent data</span>
<span class="n">observed_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">])</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">predicted_mean</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">error_std</span><span class="p">)</span>
<span class="n">likelihood</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">observed_data</span><span class="p">)</span>  <span class="c1"># Mark as observable</span>

<span class="c1"># Or use the .as_observable() method</span>
<span class="n">observations</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">as_observable</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Non-Centered Parameterization:</strong></p>
<p>Hierarchical parameters automatically use non-centered parameterization for better MCMC performance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Automatic non-centered parameterization</span>
<span class="n">mu_global</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">sigma_global</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Automatically non-centered in Stan:</span>
<span class="c1"># z_raw ~ std_normal();</span>
<span class="c1"># z = mu_global + sigma_global * z_raw;</span>
<span class="n">group_effects</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span>
    <span class="n">mu</span><span class="o">=</span><span class="n">mu_global</span><span class="p">,</span>
    <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_global</span><span class="p">,</span>
    <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,)</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Interactive Support:</strong></p>
<p>Constants can be made interactive for model exploration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Interactive constants for exploration</span>
<span class="n">interactive_prior</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">lower_bound</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">upper_bound</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
    <span class="n">togglable</span><span class="o">=</span><span class="kc">True</span>  <span class="c1"># Enable interactive widgets</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="component-validation">
<h2>Component Validation<a class="headerlink" href="#component-validation" title="Link to this heading">¶</a></h2>
<p><strong>Automatic Validation:</strong></p>
<p>Components perform comprehensive validation during construction:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Automatic parameter validation</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">invalid_param</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span>
        <span class="n">alpha</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Must be positive</span>
        <span class="n">beta</span><span class="o">=</span><span class="mi">2</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter validation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Shape compatibility validation</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">incompatible</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span>
        <span class="n">mu</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
        <span class="n">sigma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>  <span class="c1"># Incompatible shape</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape compatibility failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Constraint Enforcement:</strong></p>
<p>Components automatically enforce distributional constraints:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constraint checking during sampling</span>
<span class="n">positive_param</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Gamma</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">samples</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">positive_param</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">samples</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Automatic constraint enforcement</span>

<span class="c1"># Simplex constraint enforcement</span>
<span class="n">simplex_param</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">simplex_samples</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">simplex_param</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">simplex_samples</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="performance-considerations">
<h2>Performance Considerations<a class="headerlink" href="#performance-considerations" title="Link to this heading">¶</a></h2>
<p><strong>Efficient Construction:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Efficient: Single multi-dimensional parameter</span>
<span class="n">efficient</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>

<span class="c1"># Less efficient: Many individual parameters</span>
<span class="c1"># inefficient = [[ssp.parameters.Normal(mu=0, sigma=1)</span>
<span class="c1">#                 for j in range(50)] for i in range(100)]</span>
</pre></div>
</div>
<p><strong>Memory Management:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Share parent components to reduce memory usage</span>
<span class="n">shared_hyperprior</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Multiple parameters sharing the same parent</span>
<span class="n">group_variances</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">shared_hyperprior</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="p">]</span>  <span class="c1"># shared_hyperprior referenced, not copied</span>
</pre></div>
</div>
<p><strong>Computation Optimization:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Components are optimized for different backends</span>
<span class="n">param</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>

<span class="c1"># NumPy backend: CPU-optimized sampling</span>
<span class="n">samples</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># PyTorch backend: GPU acceleration available</span>
<span class="n">param</span><span class="o">.</span><span class="n">init_pytorch</span><span class="p">()</span>
<span class="n">gpu_samples</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">torch_parametrization</span>

<span class="c1"># Stan backend: Compiled C++ performance</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
<span class="n">stan_results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mcmc</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p><strong>Use appropriate component types</strong> for your modeling needs</p></li>
<li><p><strong>Leverage automatic shape broadcasting</strong> instead of manual management</p></li>
<li><p><strong>Build models compositionally</strong> from simple to complex</p></li>
<li><p><strong>Validate component relationships</strong> before running inference</p></li>
<li><p><strong>Use descriptive variable names</strong> for model interpretability</p></li>
<li><p><strong>Take advantage of automatic Stan optimizations</strong> like non-centering</p></li>
<li><p><strong>Monitor memory usage</strong> in large hierarchical models</p></li>
<li><p><strong>Test component behavior</strong> with prior predictive simulation</p></li>
</ol>
<p>The model components framework provides a comprehensive foundation for probabilistic modeling that scales from simple parameter estimation to complex hierarchical models while maintaining mathematical rigor and computational efficiency.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">SciStanPy</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">SciStanPy API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../index.html#scope">Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#top-level-package">Top-Level Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#module-overview">Module Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html#quick-navigation">Quick Navigation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../custom_types.html">Custom Types API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../defaults.html">Defaults API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../exceptions.html">Exceptions API Reference</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">Model API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plotting/index.html">Plotting API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../operations.html">Operations API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils.html">Utils API Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#usage-notes">Usage Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#stability">Stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#missing-something">Missing Something?</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">SciStanPy API Reference</a><ul>
  <li><a href="../index.html">Model API Reference</a><ul>
      <li>Previous: <a href="../index.html" title="previous chapter">Model API Reference</a></li>
      <li>Next: <a href="abstract_model_component.html" title="next chapter">Abstract Model Component API Reference</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Bruce Wittmann.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.3.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../../../_sources/rst/api/model/components/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>