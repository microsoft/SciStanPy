<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Hamiltonian Monte Carlo Results API Reference &#8212; SciStanPy Alpha documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../_static/documentation_options.js?v=6b921976"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Stan Submodule API Reference" href="../stan/index.html" />
    <link rel="prev" title="Maximum Likelihood Estimation Results API Reference" href="mle.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-scistanpy.model.results.hmc">
<span id="hamiltonian-monte-carlo-results-api-reference"></span><h1>Hamiltonian Monte Carlo Results API Reference<a class="headerlink" href="#module-scistanpy.model.results.hmc" title="Link to this heading">¶</a></h1>
<p>Hamiltonian Monte Carlo (HMC) sampling results analysis and diagnostics.</p>
<p>This module provides tools for analyzing and diagnosing HMC sampling results from
Stan models. It offers specialized classes and functions for processing
MCMC output, conducting diagnostic tests, and creating interactive visualizations
for model validation and troubleshooting.</p>
<p>The module centers around the <a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults" title="scistanpy.model.results.hmc.SampleResults"><code class="xref py py-class docutils literal notranslate"><span class="pre">SampleResults</span></code></a>
class, which extends <code class="xref py py-class docutils literal notranslate"><span class="pre">MLEInferenceRes</span></code> to provide
HMC-specific functionality including convergence diagnostics, sample quality assessment,
and specialized visualization tools for identifying problematic parameters and sampling
behavior.</p>
<p>Key Features:</p>
<blockquote>
<div><ul class="simple">
<li><p>MCMC diagnostic test suites</p></li>
<li><p>Interactive visualization tools for failed diagnostics</p></li>
<li><p>Efficient CSV to NetCDF conversion for large datasets</p></li>
<li><p>Dask-enabled processing for memory-intensive operations</p></li>
<li><p>Specialized trace plot analysis for problematic variables</p></li>
<li><p>Automated detection and reporting of sampling issues</p></li>
</ul>
</div></blockquote>
<p>Diagnostic Capabilities:</p>
<blockquote>
<div><ul class="simple">
<li><p>R-hat convergence assessment</p></li>
<li><p>Effective sample size (ESS) evaluation</p></li>
<li><p>Energy fraction of missing information (E-BFMI) analysis</p></li>
<li><p>Divergence detection and analysis</p></li>
<li><p>Tree depth saturation monitoring</p></li>
<li><p>Variable-specific failure pattern identification</p></li>
</ul>
</div></blockquote>
<p>The module is designed to handle both small-scale interactive analysis and
large-scale batch processing of MCMC results, with particular attention to
memory efficiency and computational performance for complex models.</p>
<p>The main class that users will interact with is
<a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults" title="scistanpy.model.results.hmc.SampleResults"><code class="xref py py-class docutils literal notranslate"><span class="pre">SampleResults</span></code></a>. Other classes in this module
provide supporting functionality for diagnostics, visualization, and data conversion.</p>
<section id="sample-results-analysis">
<h2>Sample Results Analysis<a class="headerlink" href="#sample-results-analysis" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.SampleResults">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.results.hmc.</span></span><span class="sig-name descname"><span class="pre">SampleResults</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'Model'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">fit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">CmdStanMCMC</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">npt.NDArray</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'double'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'single'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'half'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'single'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">inference_obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">az.InferenceData</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mib_per_chunk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_dask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#SampleResults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.SampleResults" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mle.html#scistanpy.model.results.mle.MLEInferenceRes" title="scistanpy.model.results.mle.MLEInferenceRes"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLEInferenceRes</span></code></a></p>
<p>Comprehensive analysis interface for HMC sampling results. This class should
never be instantiated directly. Instead, use the <cite>from_disk</cite> method to load the
appropriate results object from disk.</p>
<p>This class extends MLEInferenceRes to provide specialized functionality
for analyzing Hamiltonian Monte Carlo sampling results from Stan. It offers
comprehensive diagnostic capabilities, interactive visualization tools,
and efficient data management for large MCMC datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="../model.html#scistanpy.model.model.Model" title="scistanpy.model.model.Model"><em>Model</em></a><em>]</em>) – SciStanPy model used for sampling. Defaults to None.</p></li>
<li><p><strong>fit</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>os.PathLike</em><em>, </em><em>CmdStanMCMC</em><em>]</em><em>]</em>) – CmdStanMCMC object or path to CSV files. Defaults to None.</p></li>
<li><p><strong>data</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>npt.NDArray</em><em>]</em><em>]</em>) – Observed data dictionary. Defaults to None.</p></li>
<li><p><strong>precision</strong> (<em>Literal</em><em>[</em><em>&quot;double&quot;</em><em>, </em><em>&quot;single&quot;</em><em>, </em><em>&quot;half&quot;</em><em>]</em>) – Numerical precision for arrays. Defaults to “single”.</p></li>
<li><p><strong>inference_obj</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>az.InferenceData</em><em>, </em><em>str</em><em>]</em><em>]</em>) – Pre-existing InferenceData or NetCDF path. Defaults to None.</p></li>
<li><p><strong>mib_per_chunk</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Memory limit per chunk in MiB. Defaults to None.</p></li>
<li><p><strong>use_dask</strong> (<em>bool</em>) – Whether to use Dask for computation. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>fit</strong> – CmdStanMCMC object containing sampling metadata</p></li>
<li><p><strong>use_dask</strong> – Flag controlling Dask usage for computation</p></li>
</ul>
</dd>
</dl>
<p>The class provides comprehensive functionality for:</p>
<ul class="simple">
<li><p>MCMC convergence diagnostics and reporting</p></li>
<li><p>Sample quality assessment and visualization</p></li>
<li><p>Interactive analysis of problematic variables</p></li>
<li><p>Efficient handling of large datasets with Dask integration</p></li>
<li><p>Automated detection and reporting of sampling issues</p></li>
</ul>
<p>Key Diagnostic Features:</p>
<ul class="simple">
<li><p>R-hat convergence assessment</p></li>
<li><p>Effective sample size evaluation</p></li>
<li><p>Energy-based diagnostics (E-BFMI)</p></li>
<li><p>Divergence detection and analysis</p></li>
<li><p>Tree depth saturation monitoring</p></li>
</ul>
<p>The class automatically handles NetCDF conversion for efficient storage
and supports both in-memory and out-of-core computation depending on
dataset size and available memory.</p>
<dl>
<dt>Example:</dt><dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scistanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ssp</span>

<span class="c1"># Get MCMC results</span>
<span class="n">mcmc_results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">observed_data</span><span class="p">,</span> <span class="n">chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">iter_sampling</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>

<span class="c1"># Run full diagnostics</span>
<span class="n">diagnostics</span> <span class="o">=</span> <span class="n">mcmc_results</span><span class="o">.</span><span class="n">diagnose</span><span class="p">()</span>

<span class="c1"># Posterior predictive check (interactive in notebook)</span>
<span class="n">mcmc_results</span><span class="o">.</span><span class="n">run_ppc</span><span class="p">()</span>

<span class="c1"># Evaluate problematic samples (interactive in notebook)</span>
<span class="n">mcmc_results</span><span class="o">.</span><span class="n">plot_sample_failure_quantile_traces</span><span class="p">()</span>

<span class="c1"># Evaluate problematic variables (interactive in notebook)</span>
<span class="n">mcmc_results</span><span class="o">.</span><span class="n">plot_variable_failure_quantile_traces</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.SampleResults.calculate_diagnostics">
<span class="sig-name descname"><span class="pre">calculate_diagnostics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#SampleResults.calculate_diagnostics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.SampleResults.calculate_diagnostics" title="Link to this definition">¶</a></dt>
<dd><p>Shortcut to running <a class="reference internal" href="mle.html#scistanpy.model.results.mle.MLEInferenceRes.calculate_summaries" title="scistanpy.model.results.mle.MLEInferenceRes.calculate_summaries"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculate_summaries()</span></code></a>
with <code class="docutils literal notranslate"><span class="pre">kind=&quot;diagnostics&quot;</span></code> and no other arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dataset containing diagnostic metrics</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>xr.Dataset</p>
</dd>
</dl>
<p>The method is designed as a simple interface for users who only need
diagnostic information without summary statistics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.SampleResults.calculate_summaries">
<span class="sig-name descname"><span class="pre">calculate_summaries</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">var_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">filter_vars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'like'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'regex'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'all'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'stats'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'diagnostics'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">round_to</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">circ_var_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stat_focus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mean'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stat_funcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">callable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">extend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">hdi_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.94</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">skipna</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">diagnostic_varnames</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('mcse_mean',</span> <span class="pre">'mcse_sd',</span> <span class="pre">'ess_bulk',</span> <span class="pre">'ess_tail',</span> <span class="pre">'r_hat')</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">xr.Dataset</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#SampleResults.calculate_summaries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.SampleResults.calculate_summaries" title="Link to this definition">¶</a></dt>
<dd><p>Compute comprehensive summary statistics and diagnostics for MCMC results.</p>
<p>This method extends the parent class functionality to provide HMC-specific
diagnostic capabilities, including automatic separation of statistics and
diagnostics into appropriate InferenceData groups. See <code class="docutils literal notranslate"><span class="pre">az.summary</span></code> for
more detail on arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var_names</strong> (<em>Optional</em><em>[</em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em>) – Variable names to include. Defaults to None (all variables).</p></li>
<li><p><strong>filter_vars</strong> (<em>Optional</em><em>[</em><em>Literal</em><em>[</em><em>None</em><em>, </em><em>&quot;like&quot;</em><em>, </em><em>&quot;regex&quot;</em><em>]</em><em>]</em>) – Variable filtering method. Defaults to None.</p></li>
<li><p><strong>kind</strong> (<em>Literal</em><em>[</em><em>&quot;all&quot;</em><em>, </em><em>&quot;stats&quot;</em><em>, </em><em>&quot;diagnostics&quot;</em><em>]</em>) – Type of computations to perform. Defaults to “all”.</p></li>
<li><p><strong>round_to</strong> (<em>custom_types.Integer</em>) – Decimal places for rounding. Defaults to 2.</p></li>
<li><p><strong>circ_var_names</strong> (<em>Optional</em><em>[</em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em>) – Names of circular variables. Defaults to None.</p></li>
<li><p><strong>stat_focus</strong> (<em>str</em>) – Primary statistic for focus. Defaults to “mean”.</p></li>
<li><p><strong>stat_funcs</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>callable</em><em>]</em><em>, </em><em>callable</em><em>]</em><em>]</em>) – Custom statistic functions. Defaults to None.</p></li>
<li><p><strong>extend</strong> (<em>bool</em>) – Whether to include extended statistics. Defaults to True.
Only meaningful if <cite>stat_funcs</cite> is not <cite>None</cite>.</p></li>
<li><p><strong>hdi_prob</strong> (<em>custom_types.Float</em>) – Probability for highest density interval. Defaults to 0.94.</p></li>
<li><p><strong>skipna</strong> (<em>bool</em>) – Whether to skip NaN values. Defaults to False.</p></li>
<li><p><strong>diagnostic_varnames</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Names of diagnostic metrics. Defaults to (“mcse_mean”,
“mcse_sd”, “ess_bulk”, “ess_tail”, “r_hat”).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Combined dataset with all computed metrics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
<p>Enhanced Features:</p>
<ul class="simple">
<li><p>Automatic Dask acceleration for large datasets</p></li>
<li><p>Separation of statistics and diagnostics into appropriate groups</p></li>
<li><p>Memory-efficient computation strategies</p></li>
</ul>
<p>The method automatically updates the InferenceData object with new groups:</p>
<ul class="simple">
<li><p>variable_summary_stats: Basic summary statistics</p></li>
<li><p>variable_diagnostic_stats: MCMC diagnostic metrics</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.SampleResults.diagnose">
<span class="sig-name descname"><span class="pre">diagnose</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">max_tree_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ebfmi_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">r_hat_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.01</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ess_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'custom_types.StrippedTestRes'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'custom_types.StrippedTestRes'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#SampleResults.diagnose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.SampleResults.diagnose" title="Link to this definition">¶</a></dt>
<dd><p>Runs the complete MCMC diagnostic pipeline. This involves running, in order:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.calculate_diagnostics" title="scistanpy.model.results.hmc.SampleResults.calculate_diagnostics"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculate_diagnostics()</span></code></a></p></li>
<li><p><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.evaluate_sample_stats" title="scistanpy.model.results.hmc.SampleResults.evaluate_sample_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate_sample_stats()</span></code></a></p></li>
<li><p><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.evaluate_variable_diagnostic_stats" title="scistanpy.model.results.hmc.SampleResults.evaluate_variable_diagnostic_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate_variable_diagnostic_stats()</span></code></a></p></li>
<li><p><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.identify_failed_diagnostics" title="scistanpy.model.results.hmc.SampleResults.identify_failed_diagnostics"><code class="xref py py-meth docutils literal notranslate"><span class="pre">identify_failed_diagnostics()</span></code></a></p></li>
</ol>
<p>Typically, users will want to use this method rather than calling the individual
methods themselves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_tree_depth</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Maximum tree depth threshold. Uses model default if None.
Defaults to None.</p></li>
<li><p><strong>ebfmi_thresh</strong> (<em>custom_types.Float</em>) – E-BFMI threshold for energy diagnostics. Defaults to 0.2.</p></li>
<li><p><strong>r_hat_thresh</strong> (<em>custom_types.Float</em>) – R-hat threshold for convergence assessment. Defaults to 1.01.</p></li>
<li><p><strong>ess_thresh</strong> (<em>custom_types.Float</em>) – ESS threshold per chain. Defaults to 100.</p></li>
<li><p><strong>silent</strong> (<em>bool</em>) – Whether to suppress diagnostic output. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (sample_failures, variable_failures) as returned by
identify_failed_diagnostics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[custom_types.StrippedTestRes, dict[str, custom_types.StrippedTestRes]]</p>
</dd>
</dl>
<p>The method provides comprehensive assessment of MCMC sampling quality,
identifying both immediate issues (e.g., divergences, energy problems) and
convergence concerns (e.g., R-hat, effective sample size).</p>
<p>All intermediate results are stored in the <code class="docutils literal notranslate"><span class="pre">inference_obj</span></code> attribute
for later access and further analysis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.SampleResults.evaluate_sample_stats">
<span class="sig-name descname"><span class="pre">evaluate_sample_stats</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">max_tree_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ebfmi_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">xr.Dataset</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#SampleResults.evaluate_sample_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.SampleResults.evaluate_sample_stats" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate sample-level diagnostic statistics for MCMC quality assessment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_tree_depth</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Maximum tree depth threshold. Uses model default if None.
Defaults to None.</p></li>
<li><p><strong>ebfmi_thresh</strong> (<em>custom_types.Float</em>) – E-BFMI threshold for energy diagnostics. Defaults to 0.2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset with boolean arrays indicating test failures</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
<p>This method evaluates sample-level diagnostic statistics to identify
problematic samples in the MCMC chains. Tests are considered failures
when samples exhibit the following characteristics:</p>
<ul class="simple">
<li><p><strong>Tree Depth</strong>: Sample reached maximum tree depth (saturation)</p></li>
<li><p><strong>E-BFMI</strong>: Energy-based fraction of missing information below threshold</p></li>
<li><p><strong>Divergence</strong>: Sample diverged during Hamiltonian dynamics</p></li>
</ul>
<p>The resulting boolean arrays have <code class="docutils literal notranslate"><span class="pre">True</span></code> values indicating failed samples
and <code class="docutils literal notranslate"><span class="pre">False</span></code> values indicating successful samples. This information is
stored in the ‘sample_diagnostic_tests’ group of the InferenceData object.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sample_tests</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">evaluate_sample_stats</span><span class="p">(</span><span class="n">ebfmi_thresh</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_diverged</span> <span class="o">=</span> <span class="n">sample_tests</span><span class="o">.</span><span class="n">diverged</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of divergent samples: </span><span class="si">{</span><span class="n">n_diverged</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.SampleResults.evaluate_variable_diagnostic_stats">
<span class="sig-name descname"><span class="pre">evaluate_variable_diagnostic_stats</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">r_hat_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.01</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ess_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">xr.Dataset</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#SampleResults.evaluate_variable_diagnostic_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.SampleResults.evaluate_variable_diagnostic_stats" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate variable-level diagnostic statistics for convergence assessment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_hat_thresh</strong> (<em>custom_types.Float</em>) – R-hat threshold for convergence. Defaults to 1.01.</p></li>
<li><p><strong>ess_thresh</strong> (<em>custom_types.Integer</em>) – ESS threshold <em>per chain</em>. Defaults to 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset with boolean arrays indicating variable-level test failures</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If variable_diagnostic_stats group doesn’t exist</p></li>
<li><p><strong>ValueError</strong> – If required metrics are missing</p></li>
</ul>
</dd>
</dl>
<p>This method evaluates variable-level diagnostic statistics to identify
parameters that exhibit poor sampling behavior. Tests are considered
failures when variables meet the following criteria:</p>
<p>Failure Conditions:</p>
<ul class="simple">
<li><p><strong>R-hat</strong>: Split R-hat statistic &gt;= threshold (poor convergence)</p></li>
<li><p><strong>ESS Bulk</strong>: Bulk effective sample size / n_chains &lt;= threshold per chain</p></li>
<li><p><strong>ESS Tail</strong>: Tail effective sample size / n_chains &lt;= threshold per chain</p></li>
</ul>
<p>Results are stored in the ‘variable_diagnostic_tests’ group with boolean
arrays indicating which variables failed which tests.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var_tests</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">evaluate_variable_diagnostic_stats</span><span class="p">(</span><span class="n">r_hat_thresh</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">failed_convergence</span> <span class="o">=</span> <span class="n">var_tests</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s1">&#39;r_hat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variables with poor convergence: </span><span class="si">{</span><span class="n">failed_convergence</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.SampleResults.from_disk">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_disk</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">csv_files</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">skip_fit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_dask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults" title="scistanpy.model.results.hmc.SampleResults"><span class="pre">SampleResults</span></a></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#SampleResults.from_disk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.SampleResults.from_disk" title="Link to this definition">¶</a></dt>
<dd><p>Load SampleResults from saved NetCDF file with optional CSV metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – Path to NetCDF file containing inference data</p></li>
<li><p><strong>csv_files</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>str</em><em>]</em><em>]</em>) – Paths to CSV files output by Stan. Can also be a glob
pattern in place of a list. Defaults to None (auto-detect based on
<code class="docutils literal notranslate"><span class="pre">path</span></code> value).</p></li>
<li><p><strong>skip_fit</strong> (<em>bool</em>) – Whether to skip loading CSV metadata. Defaults to False.</p></li>
<li><p><strong>use_dask</strong> (<em>bool</em>) – Whether to enable Dask for computation. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded SampleResults object ready for analysis</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults" title="scistanpy.model.results.hmc.SampleResults">SampleResults</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – If the specified NetCDF file doesn’t exist</p>
</dd>
</dl>
<p>This class method enables loading of previously saved MCMC results from
NetCDF format, with optional access to original CSV metadata for complete
functionality.</p>
<p>Loading Modes:</p>
<ul class="simple">
<li><p><strong>Full loading</strong>: NetCDF + CSV metadata (complete functionality)</p></li>
<li><p><strong>NetCDF only</strong>: Fast loading without CSV metadata (limited functionality)</p></li>
<li><p><strong>Auto-detection</strong>: Automatically finds CSV files based on NetCDF path</p></li>
</ul>
<p>When use_dask=True, the loaded data supports out-of-core computation
for memory-efficient analysis of large datasets. Management of Dask happens
internally, so users do not need to be familiar with Dask to take advantage
of it.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load with auto-detected CSV files (csvs must have same basename)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">SampleResults</span><span class="o">.</span><span class="n">from_disk</span><span class="p">(</span><span class="s1">&#39;model_results.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load with explicit CSV files</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">SampleResults</span><span class="o">.</span><span class="n">from_disk</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;results.nc&#39;</span><span class="p">,</span> <span class="n">csv_files</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;chain_1.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;chain_2.csv&#39;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fast loading without CSV metadata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">SampleResults</span><span class="o">.</span><span class="n">from_disk</span><span class="p">(</span><span class="s1">&#39;results.nc&#39;</span><span class="p">,</span> <span class="n">skip_fit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.SampleResults.identify_failed_diagnostics">
<span class="sig-name descname"><span class="pre">identify_failed_diagnostics</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'custom_types.StrippedTestRes'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'custom_types.StrippedTestRes'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#SampleResults.identify_failed_diagnostics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.SampleResults.identify_failed_diagnostics" title="Link to this definition">¶</a></dt>
<dd><p>Identify and report diagnostic test failures with comprehensive summary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>silent</strong> (<em>bool</em>) – Whether to suppress printed output. Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (sample_failures, variable_failures) dictionaries</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[custom_types.StrippedTestRes, dict[str, custom_types.StrippedTestRes]]</p>
</dd>
</dl>
<p>This method analyzes the results of diagnostic tests and provides both
programmatic access to failure information and human-readable summaries.
It requires that diagnostic evaluation methods have been run previously.</p>
<p>Return Structure:</p>
<ul class="simple">
<li><p><strong>sample_failures</strong>: Dictionary mapping test names to arrays of failed
sample indices</p></li>
<li><p><strong>variable_failures</strong>: Dictionary mapping metric names to dictionaries
of failed variables</p></li>
</ul>
<p>The method processes test results to extract:</p>
<ul class="simple">
<li><p>Indices of samples that failed each diagnostic test</p></li>
<li><p>Names of variables that failed each diagnostic metric</p></li>
<li><p>Summary statistics showing failure rates and percentages</p></li>
</ul>
<p>When not silent, provides detailed reporting including:</p>
<ul class="simple">
<li><p>Failure counts and percentages for each test type</p></li>
<li><p>Variable-specific failure information organized by metric</p></li>
<li><p>Clear categorization of sample vs. variable-level issues</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.SampleResults.plot_sample_failure_quantile_traces">
<span class="sig-name descname"><span class="pre">plot_sample_failure_quantile_traces</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">HoloMap</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#SampleResults.plot_sample_failure_quantile_traces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.SampleResults.plot_sample_failure_quantile_traces" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">plot_sample_failure_quantile_traces</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Overlay</span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Visualize quantile traces for samples that failed diagnostic tests.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>display</strong> (<em>bool</em>) – Whether to return formatted layout for display. Defaults to True.</p></li>
<li><p><strong>width</strong> (<em>custom_types.Integer</em>) – Width of plots in pixels. Defaults to 600.</p></li>
<li><p><strong>height</strong> (<em>custom_types.Integer</em>) – Height of plots in pixels. Defaults to 600.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantile trace plots in requested format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[hv.HoloMap, dict[str, hv.Overlay]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If no samples failed diagnostic tests</p>
</dd>
</dl>
<p>This method creates specialized trace plots showing how samples that
failed diagnostic tests compare to those that passed. The visualization
helps identify systematic patterns in sampling failures.</p>
<p>Plot Structure:</p>
<ul class="simple">
<li><p><strong>X-axis</strong>: Cumulative fraction of parameters (0 to 1, sorted by typical
quantile of failed samples)</p></li>
<li><p><strong>Y-axis</strong>: Quantiles of failed samples relative to passing samples</p></li>
<li><p><strong>Individual traces</strong>: Semi-transparent lines for each failed sample</p></li>
<li><p><strong>Typical trace</strong>: Bold line showing median behavior across failures</p></li>
<li><p><strong>Reference line</strong>: Diagonal indicating perfect calibration</p></li>
</ul>
<p>The plots reveal:</p>
<ul class="simple">
<li><p>Whether failures are systematic across parameters</p></li>
<li><p>Patterns in how failed samples deviate from typical behavior</p></li>
<li><p>The severity and consistency of sampling problems</p></li>
</ul>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Display interactive traces</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">plot_sample_failure_quantile_traces</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.SampleResults.plot_variable_failure_quantile_traces">
<span class="sig-name descname"><span class="pre">plot_variable_failure_quantile_traces</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">plot_quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#scistanpy.model.results.hmc.VariableAnalyzer" title="scistanpy.model.results.hmc.VariableAnalyzer"><span class="pre">VariableAnalyzer</span></a></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#SampleResults.plot_variable_failure_quantile_traces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.SampleResults.plot_variable_failure_quantile_traces" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">plot_variable_failure_quantile_traces</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">plot_quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">HoloViews</span></span></span></dt>
<dd><p>Create interactive analyzer for variables that failed diagnostic tests.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>display</strong> (<em>bool</em>) – Whether to return display-ready analyzer. Defaults to True.</p></li>
<li><p><strong>width</strong> (<em>custom_types.Integer</em>) – Width of plots in pixels. Defaults to 800.</p></li>
<li><p><strong>height</strong> (<em>custom_types.Integer</em>) – Height of plots in pixels. Defaults to 400.</p></li>
<li><p><strong>plot_quantiles</strong> (<em>bool</em>) – Whether to plot quantiles vs raw values. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interactive analyzer or Panel layout</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#scistanpy.model.results.hmc.VariableAnalyzer" title="scistanpy.model.results.hmc.VariableAnalyzer">VariableAnalyzer</a>, pn.pane.HoloViews]</p>
</dd>
</dl>
<p>This method creates an interactive analysis tool for examining individual
variables that failed diagnostic tests. The analyzer provides widgets for
selecting specific variables, diagnostic metrics, and array indices.</p>
<p>Interactive Features:</p>
<ul class="simple">
<li><p><strong>Variable Selection</strong>: Choose from variables that failed any test</p></li>
<li><p><strong>Metric Selection</strong>: Focus on specific diagnostic failures</p></li>
<li><p><strong>Index Selection</strong>: Examine individual array elements for multi-dimensional parameters</p></li>
</ul>
<p>The resulting trace plots show:</p>
<ul class="simple">
<li><p>Sample trajectories across MCMC chains with distinct colors</p></li>
<li><p>Quantile analysis relative to parameters that passed tests</p></li>
<li><p>Hover information with detailed sample metadata</p></li>
<li><p>Chain-specific behavior identification</p></li>
</ul>
<p>This tool is particularly valuable for:</p>
<ul class="simple">
<li><p>Understanding the nature of convergence problems</p></li>
<li><p>Identifying problematic parameter regions</p></li>
<li><p>Diagnosing systematic vs. sporadic sampling issues</p></li>
<li><p>Planning model reparameterization strategies</p></li>
</ul>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Interactive analysis in notebook</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">plot_variable_failure_quantile_traces</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">analyzer</span>  <span class="c1"># Display widget interface</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="variable-failure-analyzer">
<h2>Variable Failure Analyzer<a class="headerlink" href="#variable-failure-analyzer" title="Link to this heading">¶</a></h2>
<p>Users will not typically instantiate this class directly. It is the return type of <a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.plot_variable_failure_quantile_traces" title="scistanpy.model.results.hmc.SampleResults.plot_variable_failure_quantile_traces"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_variable_failure_quantile_traces()</span></code></a> and provides the interactive analysis interface.</p>
<dl class="py class">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.VariableAnalyzer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.results.hmc.</span></span><span class="sig-name descname"><span class="pre">VariableAnalyzer</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">sample_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults" title="scistanpy.model.results.hmc.SampleResults"><span class="pre">SampleResults</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">plot_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">800</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">plot_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">400</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">plot_quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#VariableAnalyzer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.VariableAnalyzer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Interactive analysis tool for variables that fail MCMC diagnostic tests.</p>
<p>This class provides an interactive interface for analyzing individual variables
that have failed diagnostic tests during MCMC sampling. It creates a dashboard
with widgets for selecting variables, metrics, and specific array indices,
along with trace plots showing the problematic sampling behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_results</strong> (<a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults" title="scistanpy.model.results.hmc.SampleResults"><em>SampleResults</em></a>) – SampleResults object containing MCMC diagnostics</p></li>
<li><p><strong>plot_width</strong> (<em>custom_types.Integer</em>) – Width of plots in pixels. Defaults to 800.</p></li>
<li><p><strong>plot_height</strong> (<em>custom_types.Integer</em>) – Height of plots in pixels. Defaults to 400.</p></li>
<li><p><strong>plot_quantiles</strong> (<em>bool</em>) – Whether to plot quantiles vs raw values. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sample_results</strong> – Reference to source sampling results</p></li>
<li><p><strong>plot_quantiles</strong> – Flag controlling plot content type</p></li>
<li><p><strong>n_chains</strong> – Number of MCMC chains in the results</p></li>
<li><p><strong>x</strong> – Array of step indices for x-axis</p></li>
<li><p><strong>failed_vars</strong> – Dictionary mapping variable names to failure information</p></li>
<li><p><strong>varchoice</strong> – Widget for selecting variables to analyze</p></li>
<li><p><strong>metricchoice</strong> – Widget for selecting diagnostic metrics</p></li>
<li><p><strong>indexchoice</strong> – Widget for selecting array indices</p></li>
<li><p><strong>plot_width</strong> – Recorded width of plots</p></li>
<li><p><strong>plot_height</strong> – Recorded height of plots</p></li>
<li><p><strong>fig</strong> – HoloViews pane containing the current plot</p></li>
<li><p><strong>layout</strong> – Panel layout containing all interface elements</p></li>
</ul>
</dd>
</dl>
<p>The analyzer automatically identifies variables that have failed diagnostic
tests and organizes them by failure type. It provides trace plots that can
show either raw parameter values or their quantiles relative to passing
samples, helping identify the nature of sampling problems.</p>
<p>Key Features:</p>
<ul class="simple">
<li><p>Automatic identification of failed variables and metrics</p></li>
<li><p>Interactive widget-based navigation</p></li>
<li><p>Trace plots with chain-specific coloring</p></li>
<li><p>Quantile-based analysis for identifying sampling bias</p></li>
<li><p>Real-time plot updates based on widget selections</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class should not be instantiated directly. Use the
<a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.plot_variable_failure_quantile_traces" title="scistanpy.model.results.hmc.SampleResults.plot_variable_failure_quantile_traces"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_variable_failure_quantile_traces()</span></code></a>
method of <a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults" title="scistanpy.model.results.hmc.SampleResults"><code class="xref py py-class docutils literal notranslate"><span class="pre">SampleResults</span></code></a> instead.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.VariableAnalyzer.display">
<span class="sig-name descname"><span class="pre">display</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#VariableAnalyzer.display"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.VariableAnalyzer.display" title="Link to this definition">¶</a></dt>
<dd><p>Display the complete interactive analysis interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Panel layout containing all widgets and plots</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pn.Layout</p>
</dd>
</dl>
<p>This method returns the complete interactive interface for display
in Jupyter notebooks or Panel applications.</p>
</dd></dl>

</dd></dl>

</section>
<section id="csv-to-netcdf-conversion">
<h2>CSV to NetCDF Conversion<a class="headerlink" href="#csv-to-netcdf-conversion" title="Link to this heading">¶</a></h2>
<p>Stan results are output in CSV format, which is quite inefficient for large datasets. The following utilities are responsible for converting these CSV files into the more efficient NetCDF file format. Once in NetCDF format, it is easy to manipulate samples using packages such as xarray, dask, and arviz.</p>
<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.cmdstan_csv_to_netcdf">
<span class="sig-prename descclassname"><span class="pre">scistanpy.model.results.hmc.</span></span><span class="sig-name descname"><span class="pre">cmdstan_csv_to_netcdf</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">CmdStanMCMC</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../model.html#scistanpy.model.model.Model" title="scistanpy.model.model.Model"><span class="pre">Model</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">output_filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'double'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'single'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'half'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'single'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mib_per_chunk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#cmdstan_csv_to_netcdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.cmdstan_csv_to_netcdf" title="Link to this definition">¶</a></dt>
<dd><p>Convert CmdStan CSV output to NetCDF format.</p>
<p>This function provides a high-level interface for converting CmdStan
sampling results from CSV format to NetCDF, enabling efficient storage
and processing of large MCMC datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>os.PathLike</em><em>, </em><em>CmdStanMCMC</em><em>]</em>) – Path to CSV files or CmdStanMCMC object</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="../model.html#scistanpy.model.model.Model" title="scistanpy.model.model.Model"><em>Model</em></a>) – SciStanPy model used for sampling</p></li>
<li><p><strong>data</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Observed data dictionary. Uses model default if None. Defaults to None.</p></li>
<li><p><strong>output_filename</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Output NetCDF filename. Auto-generated if None. Defaults to None.</p></li>
<li><p><strong>precision</strong> (<em>Literal</em><em>[</em><em>&quot;double&quot;</em><em>, </em><em>&quot;single&quot;</em><em>, </em><em>&quot;half&quot;</em><em>]</em>) – Numerical precision for stored arrays. Defaults to “single”.</p></li>
<li><p><strong>mib_per_chunk</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Memory limit per chunk in MiB. Defaults to None, meaning
use Dask default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to created NetCDF file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p>The conversion process:</p>
<ol class="arabic simple">
<li><p>Analyzes model structure to determine optimal storage layout</p></li>
<li><p>Creates NetCDF file with appropriate groups and dimensions</p></li>
<li><p>Converts CSV data with proper chunking for memory efficiency</p></li>
<li><p>Organizes results into ArviZ-compatible structure</p></li>
</ol>
<p>Benefits of NetCDF format:</p>
<ul class="simple">
<li><p>Significantly faster loading compared to CSV</p></li>
<li><p>Memory-efficient access with chunking support</p></li>
<li><p>Metadata preservation and self-describing format</p></li>
<li><p>Integration with scientific Python ecosystem</p></li>
</ul>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">netcdf_path</span> <span class="o">=</span> <span class="n">cmdstan_csv_to_netcdf</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;model_output*.csv&#39;</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="s1">&#39;single&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">SampleResults</span><span class="o">.</span><span class="n">from_disk</span><span class="p">(</span><span class="n">netcdf_path</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.CmdStanMCMCToNetCDFConverter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.results.hmc.</span></span><span class="sig-name descname"><span class="pre">CmdStanMCMCToNetCDFConverter</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">fit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CmdStanMCMC</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">os.PathLike</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../model.html#scistanpy.model.model.Model" title="scistanpy.model.model.Model"><span class="pre">Model</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#CmdStanMCMCToNetCDFConverter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.CmdStanMCMCToNetCDFConverter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Object responsible for converting CmdStan CSV output to NetCDF format. This
class is used internally by the <a class="reference internal" href="#scistanpy.model.results.hmc.cmdstan_csv_to_netcdf" title="scistanpy.model.results.hmc.cmdstan_csv_to_netcdf"><code class="xref py py-func docutils literal notranslate"><span class="pre">cmdstan_csv_to_netcdf()</span></code></a>
function and should not be instantiated directly in most use cases.</p>
<p>This class handles the conversion of CmdStan CSV output files to NetCDF
format, providing efficient storage and access for large MCMC datasets.
It properly organizes data into appropriate groups and handles dimension
naming and chunking strategies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit</strong> (<em>Union</em><em>[</em><em>CmdStanMCMC</em><em>, </em><em>str</em><em>, </em><em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>os.PathLike</em><em>]</em>) – CmdStanMCMC object or path to CSV files</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="../model.html#scistanpy.model.model.Model" title="scistanpy.model.model.Model"><em>Model</em></a>) – SciStanPy model object for metadata extraction</p></li>
<li><p><strong>data</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Optional observed data dictionary. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>fit</strong> – CmdStanMCMC object containing sampling results</p></li>
<li><p><strong>model</strong> – Reference to the original SciStanPy model</p></li>
<li><p><strong>data</strong> – Observed data used for model fitting</p></li>
<li><p><strong>config</strong> – Configuration dictionary from Stan sampling</p></li>
<li><p><strong>num_draws</strong> – Total number of draws including warmup if saved</p></li>
<li><p><strong>varname_to_column_order</strong> – Mapping from variables to csv column indices</p></li>
</ul>
</dd>
</dl>
<p>The converter handles:</p>
<ul class="simple">
<li><p>Automatic detection of variable types and dimensions</p></li>
<li><p>Proper NetCDF group organization</p></li>
<li><p>Chunking strategies for large datasets</p></li>
<li><p>Data type optimization based on precision requirements</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.CmdStanMCMCToNetCDFConverter.write_netcdf">
<span class="sig-name descname"><span class="pre">write_netcdf</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'double'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'single'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'half'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'single'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mib_per_chunk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#CmdStanMCMCToNetCDFConverter.write_netcdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.CmdStanMCMCToNetCDFConverter.write_netcdf" title="Link to this definition">¶</a></dt>
<dd><p>Write the converted data to NetCDF format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Output filename. Auto-generated if None. Defaults to None.</p></li>
<li><p><strong>precision</strong> (<em>Literal</em><em>[</em><em>&quot;double&quot;</em><em>, </em><em>&quot;single&quot;</em><em>, </em><em>&quot;half&quot;</em><em>]</em>) – Numerical precision for arrays. Defaults to “single”.</p></li>
<li><p><strong>mib_per_chunk</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Memory limit per chunk in MiB. Defaults to None, meaning
use Dask default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to the created NetCDF file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p>This method orchestrates the complete conversion process:
1. Creates NetCDF file with appropriate structure
2. Sets up dimensions based on model and data characteristics
3. Creates variables with optimal chunking strategies
4. Populates data from CSV files with progress tracking</p>
<p>The resulting NetCDF file contains properly organized groups for
posterior samples, posterior predictive samples, sample statistics,
and observed data.</p>
</dd></dl>

</dd></dl>

</section>
<section id="utility-functions">
<h2>Utility Functions<a class="headerlink" href="#utility-functions" title="Link to this heading">¶</a></h2>
<p>The following utility functions are used internally by the other classes and functions in this module and will not typically be called directly by users.</p>
<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.dask_enabled_summary_stats">
<span class="sig-prename descclassname"><span class="pre">scistanpy.model.results.hmc.</span></span><span class="sig-name descname"><span class="pre">dask_enabled_summary_stats</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">inference_obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">InferenceData</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#dask_enabled_summary_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.dask_enabled_summary_stats" title="Link to this definition">¶</a></dt>
<dd><p>Compute summary statistics using Dask for memory efficiency. This is used
inside the <a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.calculate_summaries" title="scistanpy.model.results.hmc.SampleResults.calculate_summaries"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SampleResults.calculate_summaries()</span></code></a> method when
Dask is enabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inference_obj</strong> (<em>az.InferenceData</em>) – ArviZ InferenceData object containing posterior samples</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset containing computed summary statistics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
<p>This function computes basic summary statistics (mean, standard deviation,
and highest density intervals) using Dask for memory-efficient computation
on large datasets that might not fit in memory.</p>
<p>The function leverages Dask’s lazy evaluation to:</p>
<ul class="simple">
<li><p>Queue multiple computations for efficient execution</p></li>
<li><p>Minimize memory usage through chunked processing</p></li>
<li><p>Provide progress tracking for long-running computations</p></li>
</ul>
<p>Computed Statistics:</p>
<ul class="simple">
<li><p>Mean across chains and draws</p></li>
<li><p>Standard deviation across chains and draws</p></li>
<li><p>94% highest density intervals</p></li>
</ul>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span> <span class="o">=</span> <span class="n">dask_enabled_summary_stats</span><span class="p">(</span><span class="n">inference_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.dask_enabled_diagnostics">
<span class="sig-prename descclassname"><span class="pre">scistanpy.model.results.hmc.</span></span><span class="sig-name descname"><span class="pre">dask_enabled_diagnostics</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">inference_obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">InferenceData</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#dask_enabled_diagnostics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.dask_enabled_diagnostics" title="Link to this definition">¶</a></dt>
<dd><p>Compute MCMC diagnostics using Dask for memory efficiency. This is used
inside the <a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.calculate_summaries" title="scistanpy.model.results.hmc.SampleResults.calculate_summaries"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SampleResults.calculate_summaries()</span></code></a> method when
Dask is enabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inference_obj</strong> (<em>az.InferenceData</em>) – ArviZ InferenceData object containing posterior samples</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset containing computed diagnostic metrics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
<p>This function computes comprehensive MCMC diagnostic metrics using Dask
for memory-efficient computation on large datasets. All diagnostics are
computed simultaneously to maximize efficiency.</p>
<p>Computed Diagnostics:</p>
<ul class="simple">
<li><p>Monte Carlo standard errors (mean and sd methods)</p></li>
<li><p>Effective sample sizes (bulk and tail)</p></li>
<li><p>R-hat convergence diagnostic</p></li>
</ul>
<p>The Dask implementation enables:</p>
<ul class="simple">
<li><p>Parallel computation across available cores</p></li>
<li><p>Memory-efficient processing of large datasets</p></li>
<li><p>Automatic load balancing and optimization</p></li>
</ul>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diagnostics</span> <span class="o">=</span> <span class="n">dask_enabled_diagnostics</span><span class="p">(</span><span class="n">inference_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">diagnostics</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s1">&#39;r_hat&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.model.results.hmc.fit_from_csv_noload">
<span class="sig-prename descclassname"><span class="pre">scistanpy.model.results.hmc.</span></span><span class="sig-name descname"><span class="pre">fit_from_csv_noload</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PathLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">CmdStanMCMC</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/results/hmc.html#fit_from_csv_noload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.model.results.hmc.fit_from_csv_noload" title="Link to this definition">¶</a></dt>
<dd><p>Create CmdStanMCMC object from CSV files without loading data into memory.
This function is adapted from <code class="docutils literal notranslate"><span class="pre">cmdstanpy.from_csv</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>os.PathLike</em><em>]</em>) – Path specification for CSV files (single file, list, or glob pattern)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CmdStanMCMC object with metadata but no loaded sample data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>CmdStanMCMC</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If path specification is invalid or no CSV files found</p></li>
<li><p><strong>ValueError</strong> – If CSV files are not valid Stan output</p></li>
</ul>
</dd>
</dl>
<p>This function provides a memory-efficient way to create CmdStanMCMC objects
by parsing only the metadata from CSV files without loading the actual
sample data. This is particularly useful for large datasets where memory
usage is a concern.</p>
<p>Path Specifications:</p>
<ul class="simple">
<li><p><strong>Single file</strong>: Direct path to one CSV file</p></li>
<li><p><strong>File list</strong>: List of paths to multiple CSV files</p></li>
<li><p><strong>Glob pattern</strong>: Wildcard pattern for automatic file discovery</p></li>
<li><p><strong>Directory</strong>: Directory containing CSV files (loads all .csv files)</p></li>
</ul>
<p>The function performs validation to ensure:</p>
<ul class="simple">
<li><p>All specified files exist and are readable</p></li>
<li><p>Files contain valid Stan CSV output</p></li>
<li><p>Sampling method is compatible (only ‘sample’ method supported)</p></li>
<li><p>Configuration is consistent across files</p></li>
</ul>
<p>This approach enables efficient processing workflows where sample data
is converted to more efficient formats (like NetCDF) without requiring
full memory loading of the original CSV files.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load from glob pattern</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span> <span class="o">=</span> <span class="n">fit_from_csv_noload</span><span class="p">(</span><span class="s1">&#39;model_output_*.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load from explicit list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span> <span class="o">=</span> <span class="n">fit_from_csv_noload</span><span class="p">([</span><span class="s1">&#39;chain1.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;chain2.csv&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use for conversion without memory loading</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">netcdf_path</span> <span class="o">=</span> <span class="n">cmdstan_csv_to_netcdf</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">SciStanPy</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">SciStanPy API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../custom_types.html">Custom Types API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../defaults.html">Defaults API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../exceptions.html">Exceptions API Reference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Model SubPackage API Reference</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../components/index.html">Model Components API Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../model.html">Model API Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../nn_module.html">Neural Network Module API Reference</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html">Model Results API Reference</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="mle.html">Maximum Likelihood Estimation Results API Reference</a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="#">Hamiltonian Monte Carlo Results API Reference</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#sample-results-analysis">Sample Results Analysis</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults"><code class="docutils literal notranslate"><span class="pre">SampleResults</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.calculate_diagnostics"><code class="docutils literal notranslate"><span class="pre">SampleResults.calculate_diagnostics()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.calculate_summaries"><code class="docutils literal notranslate"><span class="pre">SampleResults.calculate_summaries()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.diagnose"><code class="docutils literal notranslate"><span class="pre">SampleResults.diagnose()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.evaluate_sample_stats"><code class="docutils literal notranslate"><span class="pre">SampleResults.evaluate_sample_stats()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.evaluate_variable_diagnostic_stats"><code class="docutils literal notranslate"><span class="pre">SampleResults.evaluate_variable_diagnostic_stats()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.from_disk"><code class="docutils literal notranslate"><span class="pre">SampleResults.from_disk()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.identify_failed_diagnostics"><code class="docutils literal notranslate"><span class="pre">SampleResults.identify_failed_diagnostics()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.plot_sample_failure_quantile_traces"><code class="docutils literal notranslate"><span class="pre">SampleResults.plot_sample_failure_quantile_traces()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#scistanpy.model.results.hmc.SampleResults.plot_variable_failure_quantile_traces"><code class="docutils literal notranslate"><span class="pre">SampleResults.plot_variable_failure_quantile_traces()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#variable-failure-analyzer">Variable Failure Analyzer</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#scistanpy.model.results.hmc.VariableAnalyzer"><code class="docutils literal notranslate"><span class="pre">VariableAnalyzer</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#scistanpy.model.results.hmc.VariableAnalyzer.display"><code class="docutils literal notranslate"><span class="pre">VariableAnalyzer.display()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#csv-to-netcdf-conversion">CSV to NetCDF Conversion</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#scistanpy.model.results.hmc.cmdstan_csv_to_netcdf"><code class="docutils literal notranslate"><span class="pre">cmdstan_csv_to_netcdf()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#scistanpy.model.results.hmc.CmdStanMCMCToNetCDFConverter"><code class="docutils literal notranslate"><span class="pre">CmdStanMCMCToNetCDFConverter</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#scistanpy.model.results.hmc.CmdStanMCMCToNetCDFConverter.write_netcdf"><code class="docutils literal notranslate"><span class="pre">CmdStanMCMCToNetCDFConverter.write_netcdf()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#utility-functions">Utility Functions</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#scistanpy.model.results.hmc.dask_enabled_summary_stats"><code class="docutils literal notranslate"><span class="pre">dask_enabled_summary_stats()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#scistanpy.model.results.hmc.dask_enabled_diagnostics"><code class="docutils literal notranslate"><span class="pre">dask_enabled_diagnostics()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#scistanpy.model.results.hmc.fit_from_csv_noload"><code class="docutils literal notranslate"><span class="pre">fit_from_csv_noload()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../stan/index.html">Stan Submodule API Reference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../plotting/index.html">Plotting Subpackage API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations.html">Operations API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../utils.html">Utils API Reference</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">SciStanPy API Reference</a><ul>
  <li><a href="../index.html">Model SubPackage API Reference</a><ul>
  <li><a href="index.html">Model Results API Reference</a><ul>
      <li>Previous: <a href="mle.html" title="previous chapter">Maximum Likelihood Estimation Results API Reference</a></li>
      <li>Next: <a href="../stan/index.html" title="next chapter">Stan Submodule API Reference</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Microsoft Corporation.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.3.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../../_sources/api/model/results/hmc.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>