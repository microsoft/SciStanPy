<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Plotting API Reference &#8212; SciStanPy Alpha documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <script src="../../_static/documentation_options.js?v=6b921976"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Prior Predictive" href="prior_predictive.html" />
    <link rel="prev" title="Plotting API Reference" href="index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="plotting-api-reference">
<h1>Plotting API Reference<a class="headerlink" href="#plotting-api-reference" title="Link to this heading">¶</a></h1>
<p>This reference covers the visualization and plotting functionality in SciStanPy.</p>
<section id="module-scistanpy.plotting.plotting">
<span id="plotting-module"></span><h2>Plotting Module<a class="headerlink" href="#module-scistanpy.plotting.plotting" title="Link to this heading">¶</a></h2>
<p>Core plotting functions for SciStanPy visualization and analysis.</p>
<p>This module implements the primary plotting functionality for SciStanPy,
providing specialized visualization tools for Bayesian analysis, model
diagnostics, and statistical relationships.</p>
<p>The module leverages HoloViews and hvplot for flexible, interactive
visualizations that can be easily customized and extended. All plotting
functions support both standard NumPy arrays and interactive widgets
for dynamic exploration of model results.</p>
<dl class="simple">
<dt>Key Features:</dt><dd><ul class="simple">
<li><p>ECDF and KDE plots for distribution visualization</p></li>
<li><p>Quantile plots with confidence intervals</p></li>
<li><p>Model calibration diagnostics</p></li>
<li><p>Hexagonal binning for large datasets</p></li>
<li><p>Interactive plotting with widget support</p></li>
<li><p>Customizable styling and overlays</p></li>
</ul>
</dd>
</dl>
<p>Functions are organized by visualization type and complexity, from simple
distribution plots to sophisticated multi-panel diagnostic displays.</p>
</section>
<section id="data-preparation-functions">
<h2>Data Preparation Functions<a class="headerlink" href="#data-preparation-functions" title="Link to this heading">¶</a></h2>
<section id="dataframe-construction">
<h3>DataFrame Construction<a class="headerlink" href="#dataframe-construction" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">build_plotting_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'param'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independent_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#build_plotting_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Construct DataFrame optimized for plotting functions.</p>
<p>This function transforms raw sample arrays into structured DataFrames
with appropriate columns and formatting for visualization functions.
It handles various data structures and automatically generates
necessary metadata for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>npt.NDArray</em>) – Raw sample data to structure for plotting</p></li>
<li><p><strong>paramname</strong> (<em>str</em>) – Column name to assign for the parameter values (Default: “param”)</p></li>
<li><p><strong>independent_dim</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Dimension representing independent variable (Default: None)</p></li>
<li><p><strong>independent_labels</strong> (<em>Optional</em><em>[</em><em>npt.NDArray</em><em>]</em>) – Labels for independent variable values (Default: None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Structured DataFrame ready for plotting functions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<dl>
<dt>The function handles:</dt><dd><ul class="simple">
<li><p>Data aggregation according to independent dimension</p></li>
<li><p>Automatic label generation when not provided</p></li>
<li><p>ECDF calculation for cumulative plots</p></li>
<li><p>Trace separation with NaN boundaries for line plots</p></li>
<li><p>Proper sorting for visualization functions</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># 100 traces, 50 time points, 10 params</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">build_plotting_df</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="s1">&#39;measurement&#39;</span><span class="p">,</span> <span class="n">independent_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Example Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scistanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ssp</span>

<span class="c1"># Transform sample arrays into plotting-ready DataFrames</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># 100 traces, 50 time points, 10 params</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">build_plotting_df</span><span class="p">(</span>
    <span class="n">samples</span><span class="p">,</span> <span class="s1">&#39;measurement&#39;</span><span class="p">,</span> <span class="n">independent_dim</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="data-aggregation">
<h3>Data Aggregation<a class="headerlink" href="#data-aggregation" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">aggregate_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#aggregate_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Aggregate multi-dimensional data for plotting purposes.</p>
<p>This function reshapes multi-dimensional arrays according to specified
aggregation rules, preparing data for visualization functions that
expect specific array structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>npt.NDArray</em>) – Input data array to aggregate</p></li>
<li><p><strong>independent_dim</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Dimension to preserve during aggregation.
If None, flattens entire array. (Default: None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aggregated data array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
<dl>
<dt>Aggregation Rules:</dt><dd><ul class="simple">
<li><p>If independent_dim is None: Returns flattened 1D array</p></li>
<li><p>If independent_dim is specified: Returns 2D array with shape
(-1, n_independent) where -1 represents the product of all
other dimensions</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Flatten completely</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flat</span> <span class="o">=</span> <span class="n">aggregate_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># Shape: (150,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Preserve last dimension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">agg</span> <span class="o">=</span> <span class="n">aggregate_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">independent_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Shape: (50, 3)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Example Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Flatten multi-dimensional data for plotting</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">flat</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">aggregate_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># Shape: (150,)</span>

<span class="c1"># Preserve specific dimension</span>
<span class="n">agg</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">aggregate_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">independent_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Shape: (50, 3)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="distribution-visualization">
<h2>Distribution Visualization<a class="headerlink" href="#distribution-visualization" title="Link to this heading">¶</a></h2>
<section id="main-distribution-plotting">
<h3>Main Distribution Plotting<a class="headerlink" href="#main-distribution-plotting" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'param'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independent_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">HVType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">HVType</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#plot_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create comprehensive distribution plots with optional overlays.</p>
<p>This is the main distribution plotting function that automatically
selects appropriate visualization types based on data structure
and provides optional ground truth or reference overlays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>Union</em><em>[</em><em>npt.NDArray</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Sample data from model simulations or posterior draws</p></li>
<li><p><strong>overlay</strong> (<em>Optional</em><em>[</em><em>npt.NDArray</em><em>]</em>) – Optional reference data to overlay on the plot (Default: None)</p></li>
<li><p><strong>paramname</strong> (<em>str</em>) – Name to assign for the parameter being plotted (Default: “param”)</p></li>
<li><p><strong>independent_dim</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Dimension index for independent variable (Default: None)</p></li>
<li><p><strong>independent_labels</strong> (<em>Optional</em><em>[</em><em>npt.NDArray</em><em>]</em>) – Labels for independent variable values (Default: None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot or list of plots showing data distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[HVType, list[HVType]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If overlay dimensions don’t match sample dimensions</p>
</dd>
</dl>
<dl>
<dt>The function automatically:</dt><dd><ul class="simple">
<li><p>Converts PyTorch tensors to NumPy arrays</p></li>
<li><p>Selects appropriate plot type based on data structure</p></li>
<li><p>Overlays reference data with distinct styling</p></li>
<li><p>Handles both single plots and multi-panel layouts</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple distribution plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">plot_distribution</span><span class="p">(</span><span class="n">posterior_samples</span><span class="p">,</span> <span class="n">paramname</span><span class="o">=</span><span class="s1">&#39;mu&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># With ground truth overlay</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">plot_distribution</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="n">true_values</span><span class="p">,</span> <span class="n">paramname</span><span class="o">=</span><span class="s1">&#39;sigma&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Example Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simple distribution plot</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_distribution</span><span class="p">(</span>
    <span class="n">posterior_samples</span><span class="p">,</span> <span class="n">paramname</span><span class="o">=</span><span class="s1">&#39;mu&#39;</span>
<span class="p">)</span>

<span class="c1"># With ground truth overlay</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_distribution</span><span class="p">(</span>
    <span class="n">samples</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="n">true_values</span><span class="p">,</span> <span class="n">paramname</span><span class="o">=</span><span class="s1">&#39;sigma&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="ecdf-and-kde-plots">
<h3>ECDF and KDE Plots<a class="headerlink" href="#ecdf-and-kde-plots" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_ecdf_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotting_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">RGB</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Overlay</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#plot_ecdf_kde"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_ecdf_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotting_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Interactive</span></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Select</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Interactive</span></span></span></dt>
<dd><p>Create empirical CDF and kernel density estimate plots.</p>
<p>This function generates complementary ECDF and KDE visualizations
for univariate data, providing both cumulative and density perspectives
on the data distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plotting_df</strong> (<em>Union</em><em>[</em><em>pd.DataFrame</em><em>, </em><em>hvplot.interactive.Interactive</em><em>]</em>) – DataFrame containing the data to plot</p></li>
<li><p><strong>paramname</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pnw.Select</em><em>]</em>) – Name of the parameter/column to visualize</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing KDE and ECDF plots, or interactive plot</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[list[HVType], hvplot.interactive.Interactive]</p>
</dd>
</dl>
<dl class="simple">
<dt>The function creates:</dt><dd><ul class="simple">
<li><p>KDE plot: Smooth density estimate with automatic bandwidth</p></li>
<li><p>ECDF plot: Step function showing cumulative probabilities</p></li>
</ul>
</dd>
</dl>
<p>Both plots are configured with consistent styling and appropriate
axis labels for scientific presentation.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;param&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plots</span> <span class="o">=</span> <span class="n">plot_ecdf_kde</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;param&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># plots[0] is KDE, plots[1] is ECDF</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Example Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;param&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)})</span>
<span class="n">plots</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_ecdf_kde</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;param&#39;</span><span class="p">)</span>
<span class="c1"># plots[0] is KDE, plots[1] is ECDF</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="multi-group-visualization">
<h3>Multi-Group Visualization<a class="headerlink" href="#multi-group-visualization" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_ecdf_violin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotting_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">RGB</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Overlay</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#plot_ecdf_violin"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_ecdf_violin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotting_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Interactive</span></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Select</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Interactive</span></span></span></dt>
<dd><p>Create ECDF and violin plots for multi-group data comparison.</p>
<p>This function visualizes distributions across multiple groups or
categories, combining empirical CDFs with violin plots to show
both cumulative and density information simultaneously.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plotting_df</strong> (<em>Union</em><em>[</em><em>pd.DataFrame</em><em>, </em><em>hvplot.interactive.Interactive</em><em>]</em>) – DataFrame with grouped data including ‘Independent Label’ column</p></li>
<li><p><strong>paramname</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pnw.Select</em><em>]</em>) – Name of the parameter/column to visualize</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Combined ECDF and violin plot overlay</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[list[HVType], hvplot.interactive.Interactive]</p>
</dd>
</dl>
<dl class="simple">
<dt>The visualization includes:</dt><dd><ul class="simple">
<li><p>Multi-line ECDF plot: One curve per group with color coding</p></li>
<li><p>Violin plot: Density distributions by group with colorbar</p></li>
</ul>
</dd>
</dl>
<p>Groups are automatically colored using the Inferno colormap.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DataFrame with &#39;param&#39; values and &#39;Independent Label&#39; grouping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plots</span> <span class="o">=</span> <span class="n">plot_ecdf_violin</span><span class="p">(</span><span class="n">grouped_df</span><span class="p">,</span> <span class="s1">&#39;param&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Example Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># DataFrame with &#39;param&#39; values and &#39;Independent Label&#39; grouping</span>
<span class="n">plots</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_ecdf_violin</span><span class="p">(</span><span class="n">grouped_df</span><span class="p">,</span> <span class="s1">&#39;param&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="relationship-plots">
<h3>Relationship Plots<a class="headerlink" href="#relationship-plots" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_relationship</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotting_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datashade</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RGB</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Overlay</span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#plot_relationship"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_relationship</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotting_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Interactive</span></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Select</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datashade</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Interactive</span></span></span></dt>
<dd><p>Visualize relationships between parameters and independent variables.</p>
<p>This function creates line plots showing how parameters vary with
respect to independent variables, with optional datashading for
large datasets to improve performance and readability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plotting_df</strong> (<em>Union</em><em>[</em><em>pd.DataFrame</em><em>, </em><em>hvplot.interactive.Interactive</em><em>]</em>) – DataFrame with ‘Independent Label’ and parameter columns</p></li>
<li><p><strong>paramname</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pnw.Select</em><em>]</em>) – Name of the dependent parameter to plot</p></li>
<li><p><strong>datashade</strong> (<em>bool</em>) – Whether to use datashading for large datasets (Default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Line plot showing parameter relationships</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[HVType, hvplot.interactive.Interactive]</p>
</dd>
</dl>
<dl class="simple">
<dt>Datashading options:</dt><dd><ul class="simple">
<li><p>True: Uses count aggregation with Inferno colormap (large data)</p></li>
<li><p>False: Uses dynamic line plotting with lime color (small data)</p></li>
</ul>
</dd>
</dl>
<p>The function automatically optimizes visualization based on data size
and user preferences for performance versus detail.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot parameter evolution over time/conditions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">plot_relationship</span><span class="p">(</span><span class="n">time_series_df</span><span class="p">,</span> <span class="s1">&#39;param&#39;</span><span class="p">,</span> <span class="n">datashade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Example Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot parameter evolution over time/conditions</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_relationship</span><span class="p">(</span>
    <span class="n">time_series_df</span><span class="p">,</span> <span class="s1">&#39;param&#39;</span><span class="p">,</span> <span class="n">datashade</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="model-validation-plots">
<h2>Model Validation Plots<a class="headerlink" href="#model-validation-plots" title="Link to this heading">¶</a></h2>
<section id="calibration-analysis">
<h3>Calibration Analysis<a class="headerlink" href="#calibration-analysis" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_calibration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Overlay</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#plot_calibration"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate calibration plots for model validation.</p>
<p>This function creates empirical cumulative distribution plots of
relative quantiles to assess model calibration. Well-calibrated
models should produce observed values that are uniformly distributed
across quantiles of the reference distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference</strong> (<em>npt.NDArray</em>) – Reference observations for calibration assessment</p></li>
<li><p><strong>observed</strong> (<em>npt.NDArray</em>) – Observed values to assess against reference</p></li>
<li><p><strong>kwargs</strong> – Additional styling options passed to hvplot.Curve</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (calibration plot overlay, deviance statistics)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[hv.Overlay, npt.NDArray[np.floating]]</p>
</dd>
</dl>
<dl>
<dt>The calibration plot shows:</dt><dd><ul class="simple">
<li><p>ECDF curves for each observation set</p></li>
<li><p>Ideal calibration line (diagonal from (0,0) to (1,1))</p></li>
<li><p>Deviation areas highlighting calibration errors</p></li>
</ul>
</dd>
<dt>Deviance Calculation:</dt><dd><p>For each observation, computes the absolute difference in area
between the observed ECDF and the ideal uniform ECDF using
the trapezoidal rule for numerical integration.</p>
</dd>
<dt>Interpretation:</dt><dd><ul class="simple">
<li><p>Points near diagonal: Well-calibrated</p></li>
<li><p>Points above diagonal: Model underconfident OR bad fit</p></li>
<li><p>Points below diagonal: Model overconfident OR bad fit</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ref_data</span> <span class="o">=</span> <span class="n">posterior_predictive_samples</span>  <span class="c1"># Shape: (1000, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs_data</span> <span class="o">=</span> <span class="n">actual_observations</span>          <span class="c1"># Shape: (10, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="p">,</span> <span class="n">deviances</span> <span class="o">=</span> <span class="n">plot_calibration</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">obs_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean deviance: </span><span class="si">{</span><span class="n">deviances</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Example Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assess model calibration</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">posterior_predictive_samples</span>  <span class="c1"># Shape: (1000, 100)</span>
<span class="n">obs_data</span> <span class="o">=</span> <span class="n">actual_observations</span>          <span class="c1"># Shape: (10, 100)</span>
<span class="n">plot</span><span class="p">,</span> <span class="n">deviances</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_calibration</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">obs_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean deviance: </span><span class="si">{</span><span class="n">deviances</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">calculate_relative_quantiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#calculate_relative_quantiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculate quantiles of observed values relative to reference distribution.</p>
<p>For each observed value, this function computes the quantile (percentile)
it would occupy within the corresponding reference distribution. This is
essential for calibration analysis and model validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference</strong> (<em>npt.NDArray</em>) – Reference observations with shape (n_samples, feat1, …, featN).
First dimension is samples, remaining are feature dimensions.</p></li>
<li><p><strong>observed</strong> (<em>npt.NDArray</em>) – Observed values with shape (n_obs, feat1, …, featN).
Feature dimensions must match reference.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantiles of observed values relative to reference</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If arrays have incompatible dimensions</p>
</dd>
</dl>
<p>The calculation determines, for each observed value, what fraction of
reference values in the corresponding position are less than or equal
to the observed value. This produces values between 0 and 1.</p>
<dl>
<dt>Mathematical Definition:</dt><dd><p>For observed value x_ij and reference distribution R_j:
quantile_ij = P(R_j &lt;= x_ij) = (1/n) * sum(R_kj &lt;= x_ij for k=1..n)</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>  <span class="c1"># 1000 samples, 10 features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>   <span class="c1"># 5 observations, 10 features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quantiles</span> <span class="o">=</span> <span class="n">calculate_relative_quantiles</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># quantiles.shape == (5, 10), values between 0 and 1</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Example Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate quantiles for calibration</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>  <span class="c1"># 1000 samples, 10 features</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>   <span class="c1"># 5 observations, 10 features</span>
<span class="n">quantiles</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">calculate_relative_quantiles</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="quantile-plots">
<h3>Quantile Plots<a class="headerlink" href="#quantile-plots" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">quantile_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_median</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'line'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'scatter'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_nan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Overlay</span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#quantile_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">quantile_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_median</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'line'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'scatter'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_nan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Overlay</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Create quantile plots with confidence intervals and optional overlays.</p>
<p>This function generates area plots showing quantile ranges of reference
data along with optional median lines and observed data overlays.
It’s particularly useful for visualizing uncertainty bands around
model predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>npt.NDArray</em>) – X-axis values (independent variable)</p></li>
<li><p><strong>reference</strong> (<em>npt.NDArray</em>) – Reference data with shape (n_samples, n_points)</p></li>
<li><p><strong>quantiles</strong> (<em>npt.ArrayLike</em>) – Quantile values to calculate and plot (0 &lt; q &lt; 1)</p></li>
<li><p><strong>observed</strong> (<em>Optional</em><em>[</em><em>npt.ArrayLike</em><em>]</em>) – Optional observed data to overlay. Must be 1D or 2D with last
dimension matching that of the reference data (Default: None).</p></li>
<li><p><strong>labels</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>npt.ArrayLike</em><em>]</em><em>]</em>) – Optional labels for hover tooltips (Default: None).</p></li>
<li><p><strong>include_median</strong> (<em>bool</em>) – Whether to include median line (Default: True)</p></li>
<li><p><strong>overwrite_input</strong> (<em>bool</em>) – Whether to overwrite reference array during calculations.
This can help save memory by avoiding the creation of intermediate copies.
(Default: False)</p></li>
<li><p><strong>return_quantiles</strong> (<em>bool</em>) – Whether to return calculated quantiles along with plot.
(Default: False)</p></li>
<li><p><strong>observed_type</strong> (<em>Literal</em><em>[</em><em>&quot;line&quot;</em><em>, </em><em>&quot;scatter&quot;</em><em>]</em>) – Type of overlay plot (‘line’ or ‘scatter’) (Default: ‘line’)</p></li>
<li><p><strong>area_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Styling options for quantile areas. See <cite>hv.opts.Area</cite>.</p></li>
<li><p><strong>median_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Styling options for median line. See <cite>hv.opts.Line</cite>.</p></li>
<li><p><strong>observed_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Styling options for observed overlay. See <cite>hv.opts.Curve</cite>
or <cite>hv.opts.Scatter</cite> depending on choice of <cite>observed_type</cite>.</p></li>
<li><p><strong>allow_nan</strong> (<em>bool</em>) – If True, uses <cite>np.nanquantile</cite> for quantile calculation. Otherwise,
uses <cite>np.quantile</cite> (Default: False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantile plot overlay, optionally with calculated quantiles</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[hv.Overlay, tuple[hv.Overlay, npt.NDArray[np.floating]]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If quantiles are not between 0 and 1, or if array dimensions
are invalid</p>
</dd>
</dl>
<dl>
<dt>Features:</dt><dd><ul class="simple">
<li><p>Automatic quantile symmetrization (adds complement quantiles)</p></li>
<li><p>Nested confidence intervals with graduated transparency</p></li>
<li><p>Customizable styling for all plot components</p></li>
<li><p>Optional hover labels for interactive exploration</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">quantile_plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> <span class="n">observed</span><span class="o">=</span><span class="n">obs</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Example Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create uncertainty bands around predictions</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">quantile_plot</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> <span class="n">observed</span><span class="o">=</span><span class="n">obs</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="large-dataset-visualization">
<h2>Large Dataset Visualization<a class="headerlink" href="#large-dataset-visualization" title="Link to this heading">¶</a></h2>
<section id="hexagonal-binning">
<h3>Hexagonal Binning<a class="headerlink" href="#hexagonal-binning" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">hexgrid_with_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">np.floating</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">np.floating</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_windowsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hex_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">hv.Overlay</span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#hexgrid_with_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create hexagonal binning plot with rolling mean overlay.</p>
<p>This function generates a hexagonal heatmap showing data density
combined with a rolling mean trend line, useful for visualizing
large datasets with underlying trends.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>npt.NDArray</em><em>[</em><em>np.floating</em><em>]</em>) – X-axis data values</p></li>
<li><p><strong>y</strong> (<em>npt.NDArray</em><em>[</em><em>np.floating</em><em>]</em>) – Y-axis data values</p></li>
<li><p><strong>mean_windowsize</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Window size for rolling mean calculation.
Defaults to x.size // 100 if not specified.</p></li>
<li><p><strong>hex_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Styling options for hexagonal tiles. See <cite>hv.opts.HexTiles</cite>.</p></li>
<li><p><strong>mean_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Styling options for rolling mean line. See <cite>hv.opts.Line</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Overlay combining hexagonal heatmap and rolling mean</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>hv.Overlay</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If x and y arrays have different shapes or are not 1D</p>
</dd>
</dl>
<dl>
<dt>The hexagonal binning:</dt><dd><ul class="simple">
<li><p>Aggregates points into hexagonal cells</p></li>
<li><p>Colors cells by point density using viridis colormap</p></li>
<li><p>Includes colorbar for density interpretation</p></li>
</ul>
</dd>
<dt>The rolling mean:</dt><dd><ul class="simple">
<li><p>Computed over sorted x values to show trend</p></li>
<li><p>Window size automatically scaled to data size</p></li>
<li><p>Styled for clear visibility over density plot</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Large dataset with trend</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">hexgrid_with_mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">mean_windowsize</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Example Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Large dataset with trend visualization</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">hexgrid_with_mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">mean_windowsize</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="utility-functions">
<h2>Utility Functions<a class="headerlink" href="#utility-functions" title="Link to this heading">¶</a></h2>
<section id="interactive-support">
<h3>Interactive Support<a class="headerlink" href="#interactive-support" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">allow_interactive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotting_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">P</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">P</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#allow_interactive"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Decorator to enable interactive plotting capabilities.</p>
<p>This decorator modifies plotting functions to handle both static
DataFrames and interactive hvplot objects, automatically configuring
the appropriate display options for each case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>plotting_func</strong> (<em>Callable</em><em>[</em><em>P</em><em>, </em><em>T</em><em>]</em>) – The plotting function to make interactive</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Enhanced function with interactive capabilities</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[P, T]</p>
</dd>
</dl>
<dl>
<dt>The decorator handles:</dt><dd><ul class="simple">
<li><p>Static DataFrames: Returns plot directly</p></li>
<li><p>Interactive objects: Configures framewise options</p></li>
<li><p>Plot lists: Combines multiple plots into column layout</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@allow_interactive</span>
<span class="gp">... </span><span class="k">def</span><span class="w"> </span><span class="nf">my_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Works with both static and interactive data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">my_plot</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="s1">&#39;column_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Usage as Decorator:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">allow_interactive</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="plot-function-selection">
<h3>Plot Function Selection<a class="headerlink" href="#plot-function-selection" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">choose_plotting_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">independent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independent_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datashade</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#choose_plotting_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Select appropriate plotting function based on data characteristics.</p>
<p>This function implements intelligent plot type selection based on
the structure of the data and available metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>independent_dim</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Dimension index for independent variable, if any</p></li>
<li><p><strong>independent_labels</strong> (<em>Optional</em><em>[</em><em>npt.NDArray</em><em>]</em>) – Labels for independent variable values</p></li>
<li><p><strong>datashade</strong> (<em>bool</em>) – Whether to enable datashading for large datasets (Default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Appropriate plotting function for the data structure</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
<dl>
<dt>Selection Logic:</dt><dd><ul class="simple">
<li><p>No independent_dim: Returns plot_ecdf_kde (univariate analysis)</p></li>
<li><p>Independent_dim but no labels: Returns plot_ecdf_violin (multi-group)</p></li>
<li><p>Both independent_dim and labels: Returns plot_relationship (dependency)</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plotter</span> <span class="o">=</span> <span class="n">choose_plotting_function</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># ECDF/KDE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotter</span> <span class="o">=</span> <span class="n">choose_plotting_function</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">time_labels</span><span class="p">)</span>  <span class="c1"># Relationship</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Example Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select appropriate plotting function based on data structure</span>
<span class="n">plotter</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">choose_plotting_function</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># ECDF/KDE</span>
<span class="n">plotter</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">choose_plotting_function</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">time_labels</span><span class="p">)</span>  <span class="c1"># Relationship</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="integration-with-scistanpy">
<h2>Integration with SciStanPy<a class="headerlink" href="#integration-with-scistanpy" title="Link to this heading">¶</a></h2>
<p>The plotting module integrates seamlessly with SciStanPy model components:</p>
<p><strong>Backend Compatibility:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Works with both NumPy arrays and PyTorch tensors</span>
<span class="n">pytorch_samples</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_distribution</span><span class="p">(</span><span class="n">pytorch_samples</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Model Integration:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Direct integration with model results</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">likelihood</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>

<span class="c1"># Visualize posterior distributions</span>
<span class="k">for</span> <span class="n">param_name</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_distribution</span><span class="p">(</span>
        <span class="n">results</span><span class="p">[</span><span class="n">param_name</span><span class="p">],</span> <span class="n">paramname</span><span class="o">=</span><span class="n">param_name</span>
    <span class="p">)</span>
</pre></div>
</div>
<p><strong>Interactive Features:</strong></p>
<p>The plotting system supports both static and interactive visualizations:</p>
<ul class="simple">
<li><p><strong>Static plots</strong>: Return HoloViews objects for immediate display</p></li>
<li><p><strong>Interactive plots</strong>: Support widgets and dynamic exploration</p></li>
<li><p><strong>Jupyter integration</strong>: Optimized for notebook environments</p></li>
</ul>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p><strong>Use appropriate plot types</strong> based on data dimensionality</p></li>
<li><p><strong>Leverage interactive features</strong> for exploratory analysis</p></li>
<li><p><strong>Customize styling</strong> using kwargs for publication-quality plots</p></li>
<li><p><strong>Consider data size</strong> when choosing between datashading and standard plots</p></li>
<li><p><strong>Validate models</strong> using calibration and quantile plots</p></li>
<li><p><strong>Combine multiple visualizations</strong> for comprehensive analysis</p></li>
</ol>
<p>This plotting API provides comprehensive visualization tools specifically designed for Bayesian modeling and scientific data analysis workflows.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">SciStanPy</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">SciStanPy API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../custom_types.html">Custom Types API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../defaults.html">Defaults API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exceptions.html">Exceptions API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/index.html">Model API Reference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Plotting API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../operations.html">Operations API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils.html">Utils API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#scistanpy.manual_seed"><code class="docutils literal notranslate"><span class="pre">manual_seed()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#scistanpy.RNG"><code class="docutils literal notranslate"><span class="pre">RNG</span></code></a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">SciStanPy API Reference</a><ul>
  <li><a href="index.html">Plotting API Reference</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Plotting API Reference</a></li>
      <li>Next: <a href="prior_predictive.html" title="next chapter">Prior Predictive</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Bruce Wittmann.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.3.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/api/plotting/plotting.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>