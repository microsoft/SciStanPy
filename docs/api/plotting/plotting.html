<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Plotting API Reference &#8212; SciStanPy Alpha documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <script src="../../_static/documentation_options.js?v=6b921976"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Prior Predictive" href="prior_predictive.html" />
    <link rel="prev" title="Plotting Subpackage API Reference" href="index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-scistanpy.plotting.plotting">
<span id="plotting-api-reference"></span><h1>Plotting API Reference<a class="headerlink" href="#module-scistanpy.plotting.plotting" title="Link to this heading">¶</a></h1>
<p>Core plotting functions for SciStanPy visualization and analysis.</p>
<p>This module implements the primary plotting functionality for SciStanPy,
providing specialized visualization tools for Bayesian analysis, model
diagnostics, and statistical relationships. As with all submodules in the plotting
subpackage, the functions here are intended for internal use to support higher-level
plotting operations and are not typically called directly by end users.</p>
<p>The module leverages HoloViews and hvplot for flexible, interactive
visualizations that can be easily customized and extended. All plotting
functions support both standard NumPy arrays and interactive widgets
for dynamic exploration of model results.</p>
<p>Key Features:</p>
<blockquote>
<div><ul class="simple">
<li><p>ECDF and KDE plots for distribution visualization</p></li>
<li><p>Quantile plots with confidence intervals</p></li>
<li><p>Model calibration diagnostics</p></li>
<li><p>Hexagonal binning for large datasets</p></li>
<li><p>Interactive plotting with widget support</p></li>
<li><p>Customizable styling and overlays</p></li>
</ul>
</div></blockquote>
<p>Functions are organized by visualization type and complexity, from simple
distribution plots to sophisticated multi-panel diagnostic displays.</p>
<section id="dataframe-construction">
<h2>DataFrame Construction<a class="headerlink" href="#dataframe-construction" title="Link to this heading">¶</a></h2>
<p>The below functions are used to construct DataFrames used by plotting functions in this module.</p>
<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.plotting.plotting.aggregate_data">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">aggregate_data</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">independent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#aggregate_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.plotting.plotting.aggregate_data" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate multi-dimensional data for plotting purposes.</p>
<p>This function reshapes multi-dimensional arrays according to specified
aggregation rules, preparing data for visualization functions that
expect specific array structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>npt.NDArray</em>) – Input data array to aggregate</p></li>
<li><p><strong>independent_dim</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Dimension to preserve during aggregation. If None, flattens
entire array. (Default: None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aggregated data array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
<p>Aggregation Rules:</p>
<blockquote>
<div><ul class="simple">
<li><p>If independent_dim is None: Returns flattened 1D array</p></li>
<li><p>If independent_dim is specified: Returns 2D array with shape
(-1, n_independent) where -1 represents the product of all other dimensions</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Flatten completely</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flat</span> <span class="o">=</span> <span class="n">aggregate_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># Shape: (150,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Preserve last dimension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">agg</span> <span class="o">=</span> <span class="n">aggregate_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">independent_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Shape: (50, 3)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.plotting.plotting.build_plotting_df">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">build_plotting_df</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'param'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">independent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">independent_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pd.DataFrame</span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#build_plotting_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.plotting.plotting.build_plotting_df" title="Link to this definition">¶</a></dt>
<dd><p>Construct DataFrame optimized for plotting functions.</p>
<p>This function transforms raw sample arrays into structured DataFrames with appropriate
columns and formatting for visualization functions. It handles various data
structures and automatically generates necessary metadata for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>npt.NDArray</em>) – Raw sample data to structure for plotting</p></li>
<li><p><strong>paramname</strong> (<em>str</em>) – Column name to assign for the parameter values (Default: “param”)</p></li>
<li><p><strong>independent_dim</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Dimension representing independent variable (Default: None)</p></li>
<li><p><strong>independent_labels</strong> (<em>Optional</em><em>[</em><em>npt.NDArray</em><em>]</em>) – Labels for independent variable values (Default: None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Structured DataFrame ready for plotting functions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p>The function handles:</p>
<blockquote>
<div><ul class="simple">
<li><p>Data aggregation according to independent dimension</p></li>
<li><p>Automatic label generation when not provided</p></li>
<li><p>ECDF calculation for cumulative plots</p></li>
<li><p>Trace separation with NaN boundaries for line plots</p></li>
<li><p>Proper sorting for visualization functions</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Samples from a model with 100 traces, 50 time points, and 10 parameters</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># 100 traces, 50 time points, 10 params</span>

<span class="c1"># Build DataFrame for plotting parameter &#39;measurement&#39; with time as</span>
<span class="c1"># independent variable</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">build_plotting_df</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="s1">&#39;measurement&#39;</span><span class="p">,</span> <span class="n">independent_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># df now contains columns for &#39;measurement&#39; and &#39;Independent Label&#39;</span>
<span class="c1"># separated by rows of NaN for trace boundaries, ready for plotting.</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
<section id="distribution-visualization">
<h2>Distribution Visualization<a class="headerlink" href="#distribution-visualization" title="Link to this heading">¶</a></h2>
<p>The below functions are used to visualize distributions, particularly for samples from parameters in Bayesian models.</p>
<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.plotting.plotting.plot_ecdf_kde">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_ecdf_kde</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">plotting_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>,</dd>
<dd><em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">RGB</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Overlay</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#plot_ecdf_kde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.plotting.plotting.plot_ecdf_kde" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_ecdf_kde</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">plotting_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Interactive</span></span></em>,</dd>
<dd><em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Select</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Interactive</span></span></span></dt>
<dd><p>Create empirical CDF and kernel density estimate plots.</p>
<p>This function generates complementary ECDF and KDE visualizations
for univariate data, providing both cumulative and density perspectives
on the data distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plotting_df</strong> (<em>Union</em><em>[</em><em>pd.DataFrame</em><em>, </em><em>hvplot.interactive.Interactive</em><em>]</em>) – DataFrame containing the data to plot</p></li>
<li><p><strong>paramname</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pnw.Select</em><em>]</em>) – Name of the parameter/column to visualize</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing KDE and ECDF plots, or interactive plot</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[list[HVType], hvplot.interactive.Interactive]</p>
</dd>
</dl>
<p>The function creates:</p>
<blockquote>
<div><ul class="simple">
<li><p>KDE plot: Smooth density estimate with automatic bandwidth</p></li>
<li><p>ECDF plot: Step function showing cumulative probabilities</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;param&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plots</span> <span class="o">=</span> <span class="n">plot_ecdf_kde</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;param&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># plots[0] is KDE, plots[1] is ECDF</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.plotting.plotting.plot_ecdf_violin">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_ecdf_violin</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">plotting_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>,</dd>
<dd><em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">RGB</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Overlay</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#plot_ecdf_violin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.plotting.plotting.plot_ecdf_violin" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_ecdf_violin</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">plotting_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Interactive</span></span></em>,</dd>
<dd><em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Select</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Interactive</span></span></span></dt>
<dd><p>Create ECDF and violin plots for multi-group data comparison.</p>
<p>This function visualizes distributions across multiple groups or
categories, combining empirical CDFs with violin plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plotting_df</strong> (<em>Union</em><em>[</em><em>pd.DataFrame</em><em>, </em><em>hvplot.interactive.Interactive</em><em>]</em>) – DataFrame with grouped data including ‘Independent Label’
and ‘Cumulative Probability’ columns.</p></li>
<li><p><strong>paramname</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pnw.Select</em><em>]</em>) – Name of the parameter/column to visualize</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Combined ECDF and violin plot overlay</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[list[HVType], hvplot.interactive.Interactive]</p>
</dd>
</dl>
<p>The visualization includes:</p>
<blockquote>
<div><ul class="simple">
<li><p>Multi-line ECDF plot: One curve per group with color coding</p></li>
<li><p>Violin plot: Density distributions by group with colorbar</p></li>
</ul>
</div></blockquote>
<p>Groups are automatically colored using the Inferno colormap.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DataFrame with &#39;param&#39; values and &#39;Independent Label&#39; grouping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plots</span> <span class="o">=</span> <span class="n">plot_ecdf_violin</span><span class="p">(</span><span class="n">grouped_df</span><span class="p">,</span> <span class="s1">&#39;param&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.plotting.plotting.plot_relationship">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_relationship</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">plotting_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>,</dd>
<dd><em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">datashade</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RGB</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Overlay</span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#plot_relationship"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.plotting.plotting.plot_relationship" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_relationship</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">plotting_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Interactive</span></span></em>,</dd>
<dd><em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Select</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">datashade</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Interactive</span></span></span></dt>
<dd><p>Visualize relationships between parameters and independent variables.</p>
<p>This function creates line plots showing how parameters vary with
respect to independent variables, with optional datashading for
large datasets to improve performance and readability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plotting_df</strong> (<em>Union</em><em>[</em><em>pd.DataFrame</em><em>, </em><em>hvplot.interactive.Interactive</em><em>]</em>) – DataFrame with ‘Independent Label’ and parameter columns.
Different groups are separated by NaN rows.</p></li>
<li><p><strong>paramname</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pnw.Select</em><em>]</em>) – Name of the dependent parameter to plot</p></li>
<li><p><strong>datashade</strong> (<em>bool</em>) – Whether to use datashading for large datasets (Default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Line plot showing parameter relationships</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[HVType, hvplot.interactive.Interactive]</p>
</dd>
</dl>
<p>Datashading options:</p>
<blockquote>
<div><ul class="simple">
<li><p>True: Uses count aggregation with Inferno colormap (large data)</p></li>
<li><p>False: Uses dynamic line plotting with lime color (small data)</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot parameter evolution over time/conditions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">plot_relationship</span><span class="p">(</span><span class="n">time_series_df</span><span class="p">,</span> <span class="s1">&#39;param&#39;</span><span class="p">,</span> <span class="n">datashade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.plotting.plotting.choose_plotting_function">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">choose_plotting_function</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">independent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">independent_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">datashade</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#choose_plotting_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.plotting.plotting.choose_plotting_function" title="Link to this definition">¶</a></dt>
<dd><p>A utility function that selects an appropriate plotting function
(<a class="reference internal" href="#scistanpy.plotting.plotting.plot_ecdf_kde" title="scistanpy.plotting.plotting.plot_ecdf_kde"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_ecdf_kde()</span></code></a>,
<a class="reference internal" href="#scistanpy.plotting.plotting.plot_ecdf_violin" title="scistanpy.plotting.plotting.plot_ecdf_violin"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_ecdf_violin()</span></code></a>, or
<a class="reference internal" href="#scistanpy.plotting.plotting.plot_relationship" title="scistanpy.plotting.plotting.plot_relationship"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_relationship()</span></code></a>) based on
data characteristics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>independent_dim</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Dimension index for independent variable, if any</p></li>
<li><p><strong>independent_labels</strong> (<em>Optional</em><em>[</em><em>npt.NDArray</em><em>]</em>) – Labels for independent variable values</p></li>
<li><p><strong>datashade</strong> (<em>bool</em>) – Whether to enable datashading for large datasets (Default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Appropriate plotting function for the data structure</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
<p>Selection Logic:</p>
<blockquote>
<div><ul class="simple">
<li><p>No independent_dim: Returns <code class="docutils literal notranslate"><span class="pre">plot_ecdf_kde</span></code> (univariate analysis)</p></li>
<li><p>Independent_dim but no labels: Returns <code class="docutils literal notranslate"><span class="pre">plot_ecdf_violin</span></code> (multi-group)</p></li>
<li><p>Both independent_dim and labels: Returns <code class="docutils literal notranslate"><span class="pre">plot_relationship</span></code> (dependency)</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plotter</span> <span class="o">=</span> <span class="n">choose_plotting_function</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># ECDF/KDE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotter</span> <span class="o">=</span> <span class="n">choose_plotting_function</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>     <span class="c1"># ECDF/Violin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotter</span> <span class="o">=</span> <span class="n">choose_plotting_function</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">time_labels</span><span class="p">)</span>  <span class="c1"># Relationship</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.plotting.plotting.plot_distribution">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_distribution</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">paramname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'param'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">independent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">independent_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">HVType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">HVType</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#plot_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.plotting.plotting.plot_distribution" title="Link to this definition">¶</a></dt>
<dd><p>The main entrypoint for creating distribution plots.</p>
<p>This function automatically selects appropriate visualization types based on
data structure and allows for optional ground truth or reference overlays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>Union</em><em>[</em><em>npt.NDArray</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Sample data from model simulations or posterior draws</p></li>
<li><p><strong>overlay</strong> (<em>Optional</em><em>[</em><em>npt.NDArray</em><em>]</em>) – Optional reference data to overlay on the plot (Default: None)</p></li>
<li><p><strong>paramname</strong> (<em>str</em>) – Name to assign for the parameter being plotted (Default: “param”)</p></li>
<li><p><strong>independent_dim</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Dimension index for independent variable (Default: None)</p></li>
<li><p><strong>independent_labels</strong> (<em>Optional</em><em>[</em><em>npt.NDArray</em><em>]</em>) – Labels for independent variable values (Default: None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot or list of plots showing data distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[HVType, list[HVType]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If overlay dimensions don’t match sample dimensions</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple distribution plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">plot_distribution</span><span class="p">(</span><span class="n">posterior_samples</span><span class="p">,</span> <span class="n">paramname</span><span class="o">=</span><span class="s1">&#39;mu&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># With ground truth overlay</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">plot_distribution</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="n">true_values</span><span class="p">,</span> <span class="n">paramname</span><span class="o">=</span><span class="s1">&#39;sigma&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Distribution plot with independent variable (e.g., time series)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">plot_distribution</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">samples</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">paramname</span><span class="o">=</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">independent_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">independent_labels</span><span class="o">=</span><span class="n">time_points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
<section id="model-fit-analysis">
<h2>Model Fit Analysis<a class="headerlink" href="#model-fit-analysis" title="Link to this heading">¶</a></h2>
<p>The below functions are used to analyze model fit and calibration. They are used under the hood by SciStanPy’s <a class="reference internal" href="../model/results/index.html"><span class="doc">results</span></a> objects.</p>
<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.plotting.plotting.calculate_relative_quantiles">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">calculate_relative_quantiles</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">observed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#calculate_relative_quantiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.plotting.plotting.calculate_relative_quantiles" title="Link to this definition">¶</a></dt>
<dd><p>Calculate quantiles of observed values relative to reference distribution.</p>
<p>For each observed value, this function computes the quantile it would occupy
within the corresponding reference distribution. This is essential for calibration
analysis and model validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference</strong> (<em>npt.NDArray</em>) – Reference observations with shape (n_samples, feat1, …, featN).
First dimension is samples, remaining are feature dimensions.</p></li>
<li><p><strong>observed</strong> (<em>npt.NDArray</em>) – Observed values with shape (n_obs, feat1, …, featN).
Feature dimensions must match reference.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantiles of observed values relative to reference. Has the same
shape as <code class="docutils literal notranslate"><span class="pre">observed</span></code>, with values between 0 and 1 indicating quantile positions
of each observed value within the reference distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If arrays have incompatible dimensions</p>
</dd>
</dl>
<p>The calculation determines, for each observed value, what fraction of
reference values in the corresponding position are less than or equal
to the observed value. This produces values between 0 and 1.</p>
<p><strong>Mathematical Definition:</strong>
For a single observed value <span class="math notranslate nohighlight">\(x\)</span> and reference distribution
<span class="math notranslate nohighlight">\(R \in \mathbb{R}^N\)</span>,:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\textrm{quantile} = P(R_i &lt;= x) = \frac{1}{N} \sum^N_{i=1}
\begin{cases}
    1 &amp; \text{if } R_i \leq x \\
    0 &amp; \text{if } R_i \gt x \\
\end{cases}\end{split}\]</div>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>  <span class="c1"># 1000 samples, 10 features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>   <span class="c1"># 5 observations, 10 features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quantiles</span> <span class="o">=</span> <span class="n">calculate_relative_quantiles</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># quantiles.shape == (5, 10), values between 0 and 1</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.plotting.plotting.plot_calibration">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_calibration</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">observed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Overlay</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#plot_calibration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.plotting.plotting.plot_calibration" title="Link to this definition">¶</a></dt>
<dd><p>Generate calibration plots for model validation.</p>
<p>This function creates empirical cumulative distribution plots of
relative quantiles to assess model calibration. Well-calibrated
models should produce observed values that are uniformly distributed
across quantiles of the reference distribution. See
<a class="reference internal" href="#scistanpy.plotting.plotting.calculate_relative_quantiles" title="scistanpy.plotting.plotting.calculate_relative_quantiles"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_relative_quantiles()</span></code></a> for quantile
calculation details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference</strong> (<em>npt.NDArray</em>) – Reference observations for calibration assessment</p></li>
<li><p><strong>observed</strong> (<em>npt.NDArray</em>) – Observed values to assess against reference</p></li>
<li><p><strong>kwargs</strong> – Additional styling options passed to <cite>hvplot.Curve</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (calibration plot overlay, deviance statistics)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[hv.Overlay, npt.NDArray[np.floating]]</p>
</dd>
</dl>
<p>The calibration plot shows:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>ECDF curves for each observation. Note that the curve represents observations</dt><dd><p>for the full set of parameters, not individual parameters.</p>
</dd>
</dl>
</li>
<li><p>Ideal calibration line (diagonal from (0,0) to (1,1))</p></li>
<li><p>Area of the deviation from ideal, which is the absolute difference in
area between the observed ECDF and the ideal uniform ECDF using the trapezoidal
rule for numerical integration. The lower the deviance, the better the
calibration.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Interpretation:</dt><dd><ul class="simple">
<li><p>Points near diagonal: Well-calibrated</p></li>
<li><p>Narrow (overrepresentation of mid quartiles) but symmetric ECDF curve:
Underdispersed model (model is too confident).</p></li>
<li><p>Wide (overrepresentation of extreme quartiles) but symmetric ECDF curve:
Overdispersed model (model is not confident enough).</p></li>
<li><p>Asymmetric ECDF curve: Systematic bias in model predictions.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have highly constrained variables, this plot may be misleading at
the extremes. For example, if a variable is constrained to be <span class="math notranslate nohighlight">\(\ge0\)</span>
and the reference distribution has all values at zero, then any observed
value will be in the 100th percentile, even if that observation is also
zero. This will present as a strong overrepresentation of extreme quantiles,
but is in fact a perfectly calibrated outcome.</p>
</div>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ref_data</span> <span class="o">=</span> <span class="n">posterior_predictive_samples</span>  <span class="c1"># Shape: (1000, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs_data</span> <span class="o">=</span> <span class="n">actual_observations</span>          <span class="c1"># Shape: (10, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="p">,</span> <span class="n">deviances</span> <span class="o">=</span> <span class="n">plot_calibration</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">obs_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean deviance: </span><span class="si">{</span><span class="n">deviances</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.plotting.plotting.quantile_plot">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">quantile_plot</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">observed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">include_median</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">overwrite_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">return_quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">observed_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'line'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'scatter'</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">area_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">median_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">observed_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">allow_nan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Overlay</span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#quantile_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.plotting.plotting.quantile_plot" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">quantile_plot</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">observed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">include_median</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">overwrite_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">return_quantiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">observed_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'line'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'scatter'</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">area_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">median_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">observed_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">allow_nan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Overlay</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Create quantile plots with confidence intervals and optional overlays.</p>
<p>This function generates area plots showing quantile ranges of reference
data along with optional median lines and observed data overlays.
It’s particularly useful for visualizing uncertainty bands around
model predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>npt.NDArray</em>) – X-axis values (independent variable)</p></li>
<li><p><strong>reference</strong> (<em>npt.NDArray</em>) – Reference data with shape (n_samples, n_points)</p></li>
<li><p><strong>quantiles</strong> (<em>npt.ArrayLike</em>) – Quantile values to calculate and plot (0 &lt; q &lt; 1)</p></li>
<li><p><strong>observed</strong> (<em>Optional</em><em>[</em><em>npt.ArrayLike</em><em>]</em>) – Optional observed data to overlay. Must be 1D or 2D with last
dimension matching that of the reference data (Default: None).</p></li>
<li><p><strong>labels</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>npt.ArrayLike</em><em>]</em><em>]</em>) – Optional labels for hover tooltips (Default: None).</p></li>
<li><p><strong>include_median</strong> (<em>bool</em>) – Whether to include median line (Default: True)</p></li>
<li><p><strong>overwrite_input</strong> (<em>bool</em>) – Whether to overwrite reference array during calculations.
This can help save memory by avoiding the creation of intermediate copies.
(Default: False)</p></li>
<li><p><strong>return_quantiles</strong> (<em>bool</em>) – Whether to return calculated quantiles along with plot.
(Default: False)</p></li>
<li><p><strong>observed_type</strong> (<em>Literal</em><em>[</em><em>&quot;line&quot;</em><em>, </em><em>&quot;scatter&quot;</em><em>]</em>) – Type of overlay plot (‘line’ or ‘scatter’) (Default: ‘line’)</p></li>
<li><p><strong>area_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Styling options for quantile areas. See <cite>hv.opts.Area</cite>.</p></li>
<li><p><strong>median_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Styling options for median line. See <cite>hv.opts.Line</cite>.</p></li>
<li><p><strong>observed_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Styling options for observed overlay. See <cite>hv.opts.Curve</cite>
or <cite>hv.opts.Scatter</cite> depending on choice of <cite>observed_type</cite>.</p></li>
<li><p><strong>allow_nan</strong> (<em>bool</em>) – If True, uses <cite>np.nanquantile</cite> for quantile calculation. Otherwise,
uses <cite>np.quantile</cite> (Default: False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantile plot overlay, optionally with calculated quantiles</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[hv.Overlay, tuple[hv.Overlay, npt.NDArray[np.floating]]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If quantiles are not between 0 and 1, or if array dimensions
are invalid</p>
</dd>
</dl>
<p>Features:</p>
<blockquote>
<div><ul class="simple">
<li><p>Automatic quantile symmetrization (adds complement quantiles)</p></li>
<li><p>Nested confidence intervals with graduated transparency</p></li>
<li><p>Customizable styling for all plot components</p></li>
<li><p>Optional hover labels for interactive exploration</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">quantile_plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> <span class="n">observed</span><span class="o">=</span><span class="n">obs</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<section id="utility-functions">
<h3>Utility Functions<a class="headerlink" href="#utility-functions" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.plotting.plotting.hexgrid_with_mean">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">hexgrid_with_mean</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">np.floating</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">np.floating</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mean_windowsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">hex_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mean_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">hv.Overlay</span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#hexgrid_with_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.plotting.plotting.hexgrid_with_mean" title="Link to this definition">¶</a></dt>
<dd><p>Create hexagonal binning plot with rolling mean overlay.</p>
<p>This function generates a hexagonal heatmap showing data density
combined with a rolling mean trend line, useful for visualizing
large datasets with underlying trends.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>npt.NDArray</em><em>[</em><em>np.floating</em><em>]</em>) – X-axis data values</p></li>
<li><p><strong>y</strong> (<em>npt.NDArray</em><em>[</em><em>np.floating</em><em>]</em>) – Y-axis data values</p></li>
<li><p><strong>mean_windowsize</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Window size for rolling mean calculation.
Defaults to x.size // 100 if not specified.</p></li>
<li><p><strong>hex_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Styling options for hexagonal tiles. See <cite>hv.opts.HexTiles</cite>.</p></li>
<li><p><strong>mean_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Styling options for rolling mean line. See <cite>hv.opts.Line</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Overlay combining hexagonal heatmap and rolling mean</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>hv.Overlay</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If x and y arrays have different shapes or are not 1D</p>
</dd>
</dl>
<p>The hexagonal binning:</p>
<blockquote>
<div><ul class="simple">
<li><p>Aggregates points into hexagonal cells</p></li>
<li><p>Colors cells by point density using viridis colormap</p></li>
<li><p>Includes colorbar for density interpretation</p></li>
</ul>
</div></blockquote>
<p>The rolling mean:</p>
<blockquote>
<div><ul class="simple">
<li><p>Computed over sorted x values to show trend</p></li>
<li><p>Window size automatically scaled to data size</p></li>
<li><p>Styled for clear visibility over density plot</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Large dataset with trend</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">hexgrid_with_mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">mean_windowsize</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scistanpy.plotting.plotting.allow_interactive">
<span class="sig-prename descclassname"><span class="pre">scistanpy.plotting.plotting.</span></span><span class="sig-name descname"><span class="pre">allow_interactive</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">plotting_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">P</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">P</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/scistanpy/plotting/plotting.html#allow_interactive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scistanpy.plotting.plotting.allow_interactive" title="Link to this definition">¶</a></dt>
<dd><p>Decorator to enable both static and interactive plotting capabilities with
plotting functions.</p>
<p>This decorator modifies plotting functions to handle both static
DataFrames and interactive hvplot objects, automatically configuring
the appropriate display options for each case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>plotting_func</strong> (<em>Callable</em><em>[</em><em>P</em><em>, </em><em>T</em><em>]</em>) – The plotting function to make interactive</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Enhanced function with interactive capabilities</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[P, T]</p>
</dd>
</dl>
<dl>
<dt>The decorator handles:</dt><dd><ul class="simple">
<li><p>Static DataFrames: Returns plot directly</p></li>
<li><p>Interactive objects: Configures framewise options</p></li>
<li><p>Plot lists: Combines multiple plots into column layout</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@allow_interactive</span>
<span class="gp">... </span><span class="k">def</span><span class="w"> </span><span class="nf">my_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Works with both static and interactive data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">my_plot</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="s1">&#39;column_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">SciStanPy</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">SciStanPy API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../custom_types.html">Custom Types API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../defaults.html">Defaults API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exceptions.html">Exceptions API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/index.html">Model SubPackage API Reference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Plotting Subpackage API Reference</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Plotting API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dataframe-construction">DataFrame Construction</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#scistanpy.plotting.plotting.aggregate_data"><code class="docutils literal notranslate"><span class="pre">aggregate_data()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#scistanpy.plotting.plotting.build_plotting_df"><code class="docutils literal notranslate"><span class="pre">build_plotting_df()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#distribution-visualization">Distribution Visualization</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#scistanpy.plotting.plotting.plot_ecdf_kde"><code class="docutils literal notranslate"><span class="pre">plot_ecdf_kde()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#scistanpy.plotting.plotting.plot_ecdf_violin"><code class="docutils literal notranslate"><span class="pre">plot_ecdf_violin()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#scistanpy.plotting.plotting.plot_relationship"><code class="docutils literal notranslate"><span class="pre">plot_relationship()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#scistanpy.plotting.plotting.choose_plotting_function"><code class="docutils literal notranslate"><span class="pre">choose_plotting_function()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#scistanpy.plotting.plotting.plot_distribution"><code class="docutils literal notranslate"><span class="pre">plot_distribution()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#model-fit-analysis">Model Fit Analysis</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#scistanpy.plotting.plotting.calculate_relative_quantiles"><code class="docutils literal notranslate"><span class="pre">calculate_relative_quantiles()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#scistanpy.plotting.plotting.plot_calibration"><code class="docutils literal notranslate"><span class="pre">plot_calibration()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#scistanpy.plotting.plotting.quantile_plot"><code class="docutils literal notranslate"><span class="pre">quantile_plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#utility-functions">Utility Functions</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#scistanpy.plotting.plotting.hexgrid_with_mean"><code class="docutils literal notranslate"><span class="pre">hexgrid_with_mean()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#scistanpy.plotting.plotting.allow_interactive"><code class="docutils literal notranslate"><span class="pre">allow_interactive()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="prior_predictive.html">Prior Predictive</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../operations.html">Operations API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils.html">Utils API Reference</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">SciStanPy API Reference</a><ul>
  <li><a href="index.html">Plotting Subpackage API Reference</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Plotting Subpackage API Reference</a></li>
      <li>Next: <a href="prior_predictive.html" title="next chapter">Prior Predictive</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Microsoft Corporation.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.3.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/api/plotting/plotting.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>