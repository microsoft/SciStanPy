description: Runs HMC for the FLIPv3 landscapes.

target:
  service: sing
  workspace_name: bjwamltws
  name: msrresrchvc

environment:
  image: scistanpy:0.0.9
  registry: bjwamltcr.azurecr.io

data:
  remote_dir: data/dms_stan/flip3_data/

code:
  local_dir: $CONFIG_DIR

search:
  # max_trials: 750
  # parallel_trials: 100
  # job_template:
  #   name: "{experiment_name:s}_{dset_ind:s}_{rate_dist:s}_{growth_func:s}"
  #   sku: 8C60
  #   preemptible: False
  #   command:
  #     - bash run_hmc_job.sh {dset_ind} {rate_dist} {growth_func}
  #   submit_args:
  #     max_run_duration_seconds: 1209600
  #     env:
  #       _AZUREML_SINGULARITY_JOB_UAI: /subscriptions/84a94086-6c26-4611-8249-b3549944c86c/resourcegroups/bjwamlt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/bjwamltuami
  #       AMLT_DIRSYNC_FREQ: 600
  #   identity: managed
  # type: hyperdrive
  # sampling: grid
  # params:
  #   - name: dset_ind
  #     values: choice("10", "11", "12", "14", "15")
  #   - name: rate_dist
  #     values: choice("gamma", "exponential", "lomax")
  #   - name: growth_func
  #     values: choice("exponential", "logistic")
  # max_trials: 750
  # parallel_trials: 100
  # job_template:
  #   name: "{experiment_name:s}_{dset_ind:s}_{rate_dist:s}_{growth_func:s}"
  #   sku: 8C15
  #   preemptible: False
  #   command:
  #     - bash run_hmc_job.sh {dset_ind} {rate_dist} {growth_func}
  #   submit_args:
  #     max_run_duration_seconds: 1209600
  #     env:
  #       _AZUREML_SINGULARITY_JOB_UAI: /subscriptions/84a94086-6c26-4611-8249-b3549944c86c/resourcegroups/bjwamlt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/bjwamltuami
  #       AMLT_DIRSYNC_FREQ: 600
  #   identity: managed
  # type: hyperdrive
  # sampling: grid
  # params:
  #   - name: dset_ind
  #     values: choice("1", "2", "3", "4", "5", "6", "7", "8", "9", "13")
  #   - name: rate_dist
  #     values: choice("gamma", "exponential", "lomax")
  #   - name: growth_func
  #     values: choice("exponential", "sigmoid")
  max_trials: 750
  parallel_trials: 100
  job_template:
    name: "{experiment_name:s}_{dset_ind:s}"
    sku: 8C15
    preemptible: False
    command:
      - bash run_hmc_job-specific.sh {dset_ind}
    submit_args:
      max_run_duration_seconds: 1209600
      env:
        _AZUREML_SINGULARITY_JOB_UAI: /subscriptions/84a94086-6c26-4611-8249-b3549944c86c/resourcegroups/bjwamlt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/bjwamltuami
        AMLT_DIRSYNC_FREQ: 600
    identity: managed
  type: hyperdrive
  sampling: grid
  params:
    - name: dset_ind
      values: choice("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", "54")