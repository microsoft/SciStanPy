description: Runs HMC for the FLIPv3 landscapes.

target:
  service: sing
  workspace_name: bjwamltws
  name: msrresrchvc

environment:
  image: dms_stan:0.0.3
  registry: bjwamltcr.azurecr.io

data:
  remote_dir: data/dms_stan/flip3_data/

code:
  local_dir: $CONFIG_DIR

search:
  max_trials: 750
  parallel_trials: 375
  job_template:
    name: "{experiment_name:s}_{job_ind:s}_{rate_dist:s}_{growth_func:s}"
    sku: 8C7
    preemptible: False
    command:
      - bash run_hmc_job.sh {job_ind} {rate_dist} {growth_func}
    submit_args:
      max_run_duration_seconds: 1209600
      env:
        _AZUREML_SINGULARITY_JOB_UAI: /subscriptions/84a94086-6c26-4611-8249-b3549944c86c/resourcegroups/bjwamlt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/bjwamltuami
        AMLT_DIRSYNC_FREQ: 600
    identity: managed
  type: hyperdrive
  sampling: grid
  params:
    - name: job_ind
      values: choice("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15")
    - name: rate_dist
      values: choice("exponential", "gamma", "lomax")
    - name: growth_func
      values: choice("exponential", "logistic")