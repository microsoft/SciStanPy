<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Model API Reference &#8212; SciStanPy Alpha documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../_static/documentation_options.js?v=6b921976"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Model Components API Reference" href="components/index.html" />
    <link rel="prev" title="Exceptions API Reference" href="../exceptions.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="model-api-reference">
<h1>Model API Reference<a class="headerlink" href="#model-api-reference" title="Link to this heading">¶</a></h1>
<p>This reference covers the Model implementation found in <cite>scistanpy.model.model</cite> and the model-related submodules used to build and run probabilistic models in SciStanPy.</p>
<p>The model submodule provides the primary interface for constructing models from composable components (parameters, constants, and transformations) and for running inference using the supported backends.</p>
<section id="model-submodule-overview">
<h2>Model Submodule Overview<a class="headerlink" href="#model-submodule-overview" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="components/index.html">Model Components API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="components/index.html#model-components-submodule-overview">Model Components Submodule Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="components/abstract_model_component.html">Abstract Model Component API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="components/abstract_model_component.html#abstract-model-component-module">Abstract Model Component Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/abstract_model_component.html#core-abstract-classes">Core Abstract Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/abstract_model_component.html#component-relationships">Component Relationships</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/abstract_model_component.html#shape-and-broadcasting-system">Shape and Broadcasting System</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/abstract_model_component.html#stan-integration-framework">Stan Integration Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/abstract_model_component.html#error-handling-and-validation">Error Handling and Validation</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/abstract_model_component.html#tree-traversal-and-analysis">Tree Traversal and Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/abstract_model_component.html#advanced-usage-patterns">Advanced Usage Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/abstract_model_component.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/abstract_model_component.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="components/constants.html">Constants API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="components/constants.html#constants-module">Constants Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/constants.html#constant-class">Constant Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/constants.html#constant-properties-and-methods">Constant Properties and Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/constants.html#usage-patterns">Usage Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/constants.html#validation-and-error-handling">Validation and Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/constants.html#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/constants.html#memory-and-performance-considerations">Memory and Performance Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/constants.html#error-handling-and-validation">Error Handling and Validation</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/constants.html#interactive-model-building">Interactive Model Building</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/constants.html#id1">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="components/custom_distributions/index.html">Custom Distributions API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="components/custom_distributions/index.html#custom-distributions-submodule-overview">Custom Distributions Submodule Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/custom_distributions/index.html#custom-distributions-framework">Custom Distributions Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/custom_distributions/index.html#distribution-categories">Distribution Categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/custom_distributions/index.html#key-features">Key Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/custom_distributions/index.html#available-custom-distributions">Available Custom Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/custom_distributions/index.html#scientific-applications">Scientific Applications</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/custom_distributions/index.html#implementation-details">Implementation Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/custom_distributions/index.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/custom_distributions/index.html#integration-patterns">Integration Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/custom_distributions/index.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="components/parameters.html">Parameters API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="components/parameters.html#parameters-module">Parameters Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/parameters.html#core-parameter-infrastructure">Core Parameter Infrastructure</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/parameters.html#base-parameter-classes">Base Parameter Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/parameters.html#continuous-distributions">Continuous Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/parameters.html#simplex-distributions">Simplex Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/parameters.html#discrete-distributions">Discrete Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/parameters.html#multinomial-distributions">Multinomial Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/parameters.html#advanced-parameter-features">Advanced Parameter Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/parameters.html#parameter-constraints-and-bounds">Parameter Constraints and Bounds</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/parameters.html#model-building-patterns">Model Building Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/parameters.html#performance-optimization-tips">Performance Optimization Tips</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/parameters.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="components/transformations/index.html">Transformations API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="components/transformations/index.html#transformations-submodule-overview">Transformations Submodule Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/transformations/index.html#transformations-module">Transformations Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/transformations/index.html#transformed-parameters">Transformed Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/transformations/index.html#mathematical-transformations">Mathematical Transformations</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/transformations/index.html#transformation-types">Transformation Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="components/transformations/index.html#stan-code-generation">Stan Code Generation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="components/index.html#component-architecture">Component Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="components/index.html#component-hierarchy">Component Hierarchy</a></li>
<li class="toctree-l2"><a class="reference internal" href="components/index.html#key-design-principles">Key Design Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="components/index.html#component-types">Component Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="components/index.html#component-relationships">Component Relationships</a></li>
<li class="toctree-l2"><a class="reference internal" href="components/index.html#stan-code-generation">Stan Code Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="components/index.html#advanced-component-features">Advanced Component Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="components/index.html#component-validation">Component Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="components/index.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="components/index.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Model API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="model.html#model-module">Model Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#core-model-class">Core Model Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#model-utilities">Model Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#model-properties-and-methods">Model Properties and Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#model-introspection">Model Introspection</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#advanced-features">Advanced Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="nn_module.html">Neural Network Module API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="nn_module.html#neural-network-module">Neural Network Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn_module.html#core-pytorch-integration">Core PyTorch Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn_module.html#validation-functions">Validation Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn_module.html#training-and-optimization">Training and Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn_module.html#parameter-and-distribution-export">Parameter and Distribution Export</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn_module.html#device-management">Device Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn_module.html#integration-patterns">Integration Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn_module.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn_module.html#error-handling-and-debugging">Error Handling and Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn_module.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="results/index.html">Model Results API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="results/index.html#results-submodule-overview">Results Submodule Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="results/mle.html">Maximum Likelihood Estimation Results API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="results/mle.html#mle-results-module">MLE Results Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/mle.html#core-mle-analysis-classes">Core MLE Analysis Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/mle.html#diagnostic-capabilities">Diagnostic Capabilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/mle.html#utility-functions">Utility Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/mle.html#advanced-analysis-workflows">Advanced Analysis Workflows</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/mle.html#integration-with-arviz-ecosystem">Integration with ArviZ Ecosystem</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/mle.html#interactive-dashboard-features">Interactive Dashboard Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/mle.html#memory-management">Memory Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/mle.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="results/hmc.html">Hamiltonian Monte Carlo Results API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="results/hmc.html#hmc-results-module">HMC Results Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/hmc.html#core-hmc-analysis-classes">Core HMC Analysis Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/hmc.html#efficient-data-processing">Efficient Data Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/hmc.html#comprehensive-diagnostic-framework">Comprehensive Diagnostic Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/hmc.html#advanced-visualization-tools">Advanced Visualization Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/hmc.html#memory-efficient-processing">Memory-Efficient Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/hmc.html#scientific-workflow-integration">Scientific Workflow Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/hmc.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/hmc.html#integration-with-external-tools">Integration with External Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="results/hmc.html#best-practices">Best Practices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="results/index.html#results-module">Results Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="results/index.html#core-analysis-frameworks">Core Analysis Frameworks</a></li>
<li class="toctree-l2"><a class="reference internal" href="results/index.html#unified-analysis-interface">Unified Analysis Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="results/index.html#key-features">Key Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="results/index.html#analysis-workflow-patterns">Analysis Workflow Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="results/index.html#standard-mle-analysis-pipeline">Standard MLE Analysis Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="results/index.html#standard-mcmc-analysis-pipeline">Standard MCMC Analysis Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="results/index.html#comparative-analysis">Comparative Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="results/index.html#data-management-and-persistence">Data Management and Persistence</a><ul>
<li class="toctree-l3"><a class="reference internal" href="results/index.html#efficient-storage-solutions">Efficient Storage Solutions</a></li>
<li class="toctree-l3"><a class="reference internal" href="results/index.html#cross-platform-compatibility">Cross-Platform Compatibility</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="results/index.html#advanced-analysis-patterns">Advanced Analysis Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="results/index.html#model-selection-and-comparison">Model Selection and Comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="results/index.html#uncertainty-quantification-studies">Uncertainty Quantification Studies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="results/index.html#integration-with-scientific-workflows">Integration with Scientific Workflows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="results/index.html#automated-reporting">Automated Reporting</a></li>
<li class="toctree-l3"><a class="reference internal" href="results/index.html#batch-processing">Batch Processing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="results/index.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stan/index.html">Stan Integration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="stan/index.html#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stan/stan_functions.html">Stan Functions Library Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_functions.html#stan-functions-overview">Stan Functions Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_functions.html#function-library-organization">Function Library Organization</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_functions.html#multinomial-function-library">Multinomial Function Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_functions.html#exp-exponential-distribution">Exp-Exponential Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_functions.html#exp-dirichlet-distribution">Exp-Dirichlet Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_functions.html#exp-lomax-distribution">Exp-Lomax Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_functions.html#sequence-convolution-functions">Sequence Convolution Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_functions.html#function-integration-process">Function Integration Process</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_functions.html#numerical-stability-features">Numerical Stability Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_functions.html#custom-function-development">Custom Function Development</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_functions.html#performance-considerations">Performance Considerations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stan/stan_model.html">Stan Model API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_model.html#stan-model-module">Stan Model Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_model.html#stan-code-organization-classes">Stan Code Organization Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_model.html#enhanced-stan-model-class">Enhanced Stan Model Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_model.html#automatic-data-gathering">Automatic Data Gathering</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_model.html#stan-code-generation-process">Stan Code Generation Process</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_model.html#stan-function-libraries">Stan Function Libraries</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_model.html#performance-optimizations">Performance Optimizations</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_model.html#integration-with-cmdstanpy">Integration with CmdStanPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_model.html#error-handling-and-debugging">Error Handling and Debugging</a></li>
<li class="toctree-l4"><a class="reference internal" href="stan/stan_model.html#best-practices">Best Practices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stan/index.html#top-level-module">Top-level module</a></li>
<li class="toctree-l2"><a class="reference internal" href="stan/index.html#implementation-notes">Implementation notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="stan/index.html#minimal-usage-examples">Minimal usage examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="stan/index.html#further-reading">Further reading</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="core-module-and-class">
<h2>Core Module and Class<a class="headerlink" href="#core-module-and-class" title="Link to this heading">¶</a></h2>
<p>The implementation of the Model class lives in the module
<cite>scistanpy.model.model</cite>.</p>
<p>Core Model class for SciStanPy Bayesian modeling framework.</p>
<p>This module contains the fundamental Model class that serves as the primary
interface for building, compiling, and executing Bayesian models in SciStanPy.
The Model class orchestrates the composition of model components (parameters,
constants, transformations) and provides methods for sampling, compilation,
and analysis.</p>
<p>The Model class uses a metaclass pattern to automatically register model
components defined as instance attributes, enabling intuitive model construction
through simple attribute assignment. It supports multiple backends including
Stan for MCMC sampling and PyTorch for maximum likelihood estimation.</p>
<dl class="simple">
<dt>Key Features:</dt><dd><ul class="simple">
<li><p>Automatic component registration and validation</p></li>
<li><p>Multiple sampling backends (Stan MCMC, PyTorch MLE)</p></li>
<li><p>Prior and posterior predictive checking</p></li>
<li><p>Efficient compilation with caching</p></li>
<li><p>Comprehensive model introspection and diagnostics</p></li>
<li><p>xarray integration for structured data handling</p></li>
</ul>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.model.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Primary interface for Bayesian model construction and analysis in SciStanPy.</p>
<p>The Model class provides a declarative interface for building Bayesian models
by composing parameters, constants, and transformations. It automatically
handles component registration, validation, and provides methods for sampling,
compilation, and analysis across multiple backends.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Positional arguments (unused, for subclass compatibility)</p></li>
<li><p><strong>default_data</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>npt.NDArray</em><em>]</em><em>]</em>) – Default observed data for model observables. When provided,
any instance method requiring data will use these if not otherwise provided.
Defaults to None.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments (unused, for subclass compatibility)</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>_default_data</strong> – Stored default data for observables</p></li>
<li><p><strong>_named_model_components</strong> – Tuple of components that have explicit names</p></li>
<li><p><strong>_model_varname_to_object</strong> – Mapping from variable names to components</p></li>
<li><p><strong>_init_complete</strong> – Flag indicating initialization completion</p></li>
</ul>
</dd>
</dl>
<p>The class uses a metaclass pattern that automatically registers model
components defined as instance attributes. Components are validated
for naming conventions and automatically assigned model variable names.</p>
<dl>
<dt>Model Construction:</dt><dd><p>Models are built by subclassing Model and defining components as
instance attributes in the __init__ method. The metaclass automatically
discovers and registers these components.</p>
</dd>
<dt>Supported Operations:</dt><dd><ul class="simple">
<li><p>Prior and posterior sampling</p></li>
<li><p>Maximum likelihood estimation using PyTorch</p></li>
<li><p>MCMC sampling using Stan</p></li>
<li><p>Model compilation and caching</p></li>
<li><p>Prior predictive checking with interactive visualization</p></li>
<li><p>Model simulation and validation</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">HalfNormal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prior_samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mle_result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mle</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<p>This should be overridden by the subclass.</p>
<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_model_components</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">AbstractModelComponent</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all model components including unnamed intermediate components.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of all components sorted by variable name</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[abstract_model_component.AbstractModelComponent, …]</p>
</dd>
</dl>
<p>This includes both explicitly named components and any intermediate
components created during dependency resolution, providing complete
visibility into the model’s computational graph.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_model_components_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">AbstractModelComponent</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all model components as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping variable names to all components</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, abstract_model_component.AbstractModelComponent]</p>
</dd>
</dl>
<p>This comprehensive mapping includes both named and intermediate
components, enabling full programmatic access to the model structure.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">constant_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Constant</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get named constants as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping names to constant components</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, constants_module.Constant]</p>
</dd>
</dl>
<p>Provides convenient access to model constants for hyperparameter
inspection and sensitivity analysis workflows.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">constants</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Constant</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all named constants in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of constant components</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[constants_module.Constant, …]</p>
</dd>
</dl>
<p>Constants represent fixed values and hyperparameter specifications
that do not change during inference or optimization procedures.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd><p>Get the default observed data for model observables.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping observable names to their default data</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, npt.NDArray] | None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If default data has not been set</p>
</dd>
</dl>
<p>Default data is used automatically by methods like mle() and mcmc()
when no explicit data is provided, streamlining common workflows.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">named_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_xarray</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.draw"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">named_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_xarray</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">AbstractModelComponent</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">named_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_xarray</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">named_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_xarray</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span></dt>
<dd><p>Draw samples from the model’s prior distribution.</p>
<p>This method generates samples from all observable parameters in the
model by traversing the dependency graph and sampling from each
component’s distribution in topological order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>custom_types.Integer</em>) – Number of samples to draw from each observable</p></li>
<li><p><strong>named_only</strong> (<em>bool</em>) – Whether to return only named components. Defaults to True.</p></li>
<li><p><strong>as_xarray</strong> (<em>bool</em>) – Whether to return results as xarray Dataset. Defaults to False.</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Random seed for reproducible sampling. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled values in requested format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[dict[str, npt.NDArray], dict[AbstractModelComponent, npt.NDArray], xr.Dataset]</p>
</dd>
</dl>
<p>The method automatically handles:
- Dependency resolution between model components
- Consistent random number generation with optional seeding
- Efficient sampling by reusing intermediate results
- Format conversion based on return type preferences</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw 1000 samples as dictionary</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw 1000 samples as an xarray Dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">as_xarray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_dimname_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.get_dimname_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate mapping from dimension specifications to dimension names.</p>
<p>This method creates a dictionary that maps dimension level and size
tuples to appropriate dimension names for xarray dataset construction.
It ensures dimension names don’t conflict with model variable names.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping (level, size) tuples to dimension names</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[tuple[custom_types.Integer, custom_types.Integer], str]</p>
</dd>
</dl>
<p>The mapping is used to create consistent dimension naming across
all xarray datasets generated from model samples, ensuring proper
coordinate alignment and data structure.</p>
<p>Only dimensions with size &gt; 1 are assigned names, as singleton
dimensions are typically squeezed during xarray construction.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_default_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em></dt>
<dd><p>Check whether the model has default data configured.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if default data is set, False otherwise</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
<p>This property is useful for conditional logic that depends on
whether default data is available for automatic use in methods.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hyperparameter_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get hyperparameters as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping names to hyperparameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, parameters_module.Parameter]</p>
</dd>
</dl>
<p>Provides convenient access to the model’s hyperparameters by name
for prior specification and sensitivity analysis.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hyperparameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get hyperparameters (parameters with only constant parents).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of parameters that depend only on constants</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[parameters_module.Parameter, …]</p>
</dd>
</dl>
<p>Hyperparameters are the highest-level parameters in the model
hierarchy, typically representing prior distribution parameters
that are not derived from other random variables.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_compile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stanc_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpp_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">sample_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">hmc_results.SampleResults</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.mcmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_compile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stanc_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpp_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">sample_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span></dt>
<dd><p>Perform Hamiltonia Monte Carlo sampling using Stan backend.</p>
<p>This method compiles the model to Stan and executes Hamiltonian
Monte Carlo sampling to generate posterior samples. It supports
both immediate execution and delayed runs for batch processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Directory for compilation and output files. Defaults to None,
in which case all raw outputs will be saved to a temporary directory and
be accessible only for the lifetime of this Python process.</p></li>
<li><p><strong>force_compile</strong> (<em>bool</em>) – Whether to force recompilation of Stan model. Defaults
to False.</p></li>
<li><p><strong>stanc_options</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Options for Stan compiler. Defaults to None (uses
DEFAULT_STANC_OPTIONS).</p></li>
<li><p><strong>cpp_options</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Options for C++ compilation. Defaults to None (uses
DEFAULT_CPP_OPTIONS).</p></li>
<li><p><strong>user_header</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Custom C++ header code. Defaults to None.</p></li>
<li><p><strong>model_name</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Name for compiled model. Defaults to ‘model’.</p></li>
<li><p><strong>inits</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Initialization strategy. See <cite>stan_model.StanModel</cite>
for options. Defaults to None.</p></li>
<li><p><strong>data</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>npt.NDArray</em><em>]</em><em>]</em>) – Observed data for observables. Uses default_data defined during
initialization if not provided.</p></li>
<li><p><strong>delay_run</strong> (<em>Union</em><em>[</em><em>bool</em><em>, </em><em>str</em><em>]</em>) – Whether to delay execution. If <cite>True</cite>, a pickle file that
can be used for delayed execution will be saved to <cite>output_dir</cite>. A string
can also be provided to save the pickle file to an alternate location.
Defaults to False (meaning immediate execution).</p></li>
<li><p><strong>sample_kwargs</strong> – Additional arguments passed to Stan sampling. See
the <cite>cmdstanpy.CmdStanModel.sample</cite> for options.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MCMC results if delay_run=False, None if delayed</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[hmc_results.SampleResults, None]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If delay_run is True but output_dir is None</p>
</dd>
</dl>
<p>Delayed Execution:
When delay_run=True, the method saves sampling configuration to a
pickle file instead of executing immediately. This enables batch
processing and distributed computing workflows.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Immediate MCMC sampling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">iter_sampling</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Delayed execution for batch processing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">delay_run</span><span class="o">=</span><span class="s1">&#39;batch_job.pkl&#39;</span><span class="p">,</span> <span class="n">chains</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">iter_sampling</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">npt.NDArray</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixed_precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">mle_module.MLE</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.mle"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute maximum likelihood estimates of model parameters.</p>
<p>This method fits a PyTorch model to observed data by minimizing
the negative log-likelihood, providing point estimates of all
model parameters along with optimization diagnostics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>custom_types.Integer</em>) – Maximum number of training epochs. Note that one step is one
epoch as the model must be evaluated over all observable data to calculate
loss. Defaults to 100000.</p></li>
<li><p><strong>early_stop</strong> (<em>custom_types.Integer</em>) – Epochs without improvement before stopping. Defaults to 10.</p></li>
<li><p><strong>lr</strong> (<em>custom_types.Float</em>) – Learning rate for optimization. Defaults to 0.001.</p></li>
<li><p><strong>data</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Union</em><em>[</em><em>torch.Tensor</em><em>, </em><em>npt.NDArray</em><em>]</em><em>]</em><em>]</em>) – Observed data for observables. Uses default_data provided at
initialization if not provided.</p></li>
<li><p><strong>device</strong> (<em>Union</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>str</em><em>]</em>) – Computation device (‘cpu’, ‘cuda’, or device index). Defaults to ‘cpu’.</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Random seed for reproducible optimization. Defaults to None.</p></li>
<li><p><strong>mixed_precision</strong> (<em>bool</em>) – Whether to use mixed precision training. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MLE results with parameter estimates and diagnostics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>mle_module.MLE</p>
</dd>
</dl>
<p>The optimization process:</p>
<ul class="simple">
<li><p>Converts model to PyTorch and moves to specified device</p></li>
<li><p>Trains for <cite>epochs</cite> number of epochs or until there has been no improvement
for <cite>early_stop</cite> number epochs.</p></li>
<li><p>Tracks loss trajectory for convergence assessment</p></li>
<li><p>Returns parameter estimates and fitted distributions</p></li>
</ul>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Basic MLE with default settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mle_result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">observed_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># GPU-accelerated with custom settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mle_result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">named_model_components</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">AbstractModelComponent</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all named model components.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of named components</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[abstract_model_component.AbstractModelComponent, …]</p>
</dd>
</dl>
<p>Named components are those explicitly assigned as instance attributes
during model construction, as opposed to intermediate components
created automatically during dependency resolution.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">named_model_components_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">AbstractModelComponent</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get named model components as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping variable names to named components</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, abstract_model_component.AbstractModelComponent]</p>
</dd>
</dl>
<p>This provides convenient access to named components by their
string names for programmatic model inspection and manipulation.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observable_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get observable parameters as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping names to observable parameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, parameters_module.Parameter]</p>
</dd>
</dl>
<p>Enables convenient access to observable parameters for data
specification and model validation workflows.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observables</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all observable parameters in the model (observables are always named).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of parameters marked as observable</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[parameters_module.Parameter, …]</p>
</dd>
</dl>
<p>Observable parameters represent the data-generating components
of the model - the variables for which observed data will be
provided during inference procedures.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parameter_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get non-observable parameters as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping names to non-observable parameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, parameters_module.Parameter]</p>
</dd>
</dl>
<p>Provides convenient named access to the model’s latent parameters
for inspection and programmatic manipulation.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all non-observable parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of parameter components that are not observables</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[parameters_module.Parameter, …]</p>
</dd>
</dl>
<p>These are the latent variables and hyperparameters that will be
inferred during MCMC sampling or optimized during MLE fitting.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">prior_predictive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Row</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.prior_predictive"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create interactive prior predictive check visualization.</p>
<p>This method generates an interactive dashboard for exploring the
model’s prior predictive distribution. Users can adjust model
hyperparameters via sliders and immediately see how changes
affect prior predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>copy_model</strong> (<em>bool</em>) – Whether to copy model to avoid modifying original. Defaults
to False, meaning the calling model is updated in place by changing
slider values and clicking “update model”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Panel dashboard with interactive prior predictive visualization</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pn.Row</p>
</dd>
</dl>
<p>The dashboard includes:
- Sliders for all adjustable model hyperparameters
- Multiple visualization modes (ECDF, KDE, violin, relationship plots)
- Real-time updates as parameters are modified
- Options for different grouping and display configurations</p>
<p>This is useful for:
- Prior specification and calibration
- Understanding model behavior before data fitting
- Identifying unrealistic prior assumptions</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create interactive dashboard</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dashboard</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">prior_predictive</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dashboard</span><span class="o">.</span><span class="n">servable</span><span class="p">()</span>  <span class="c1"># For web deployment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Or display in Jupyter notebook</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dashboard</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">simulate_mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delay_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">npt.NDArray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'hmc_results.SampleResults'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.simulate_mcmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">simulate_mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delay_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span></dt>
<dd><p>Simulate data from model prior and perform Hamiltonian Monte Carlo sampling.</p>
<p>This method generates synthetic data from the model’s prior
distribution and then performs full Bayesian inference via MCMC.
It’s extremely helpful for model validation and posterior recovery testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delay_run</strong> (<em>bool</em>) – Whether to delay MCMC execution. Defaults to False.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments passed to mcmc() method</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (simulated_data, mcmc_results) if delay_run=False,
None if delay_run=True</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[tuple[dict[str, npt.NDArray], hmc_results.SampleResults], None]</p>
</dd>
</dl>
<p>The method automatically updates the model name to indicate
simulation when using the default name, helping distinguish
simulated from real data analyses.</p>
<p>This is crucial for:
- Validating MCMC implementation correctness
- Testing posterior recovery in known-truth scenarios
- Assessing sampler efficiency and convergence
- Debugging model specification issues</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate and sample with immediate execution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_data</span><span class="p">,</span> <span class="n">mcmc_results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">simulate_mcmc</span><span class="p">(</span><span class="n">chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">iter_sampling</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">simulate_mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MLE</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.simulate_mle"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Simulate data from model prior and fit via maximum likelihood.</p>
<p>This method performs a complete simulation study by first generating
synthetic data from the model’s prior distribution, then fitting
the model to this simulated data using maximum likelihood estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Keyword arguments passed to mle() method (except ‘data’)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (simulated_data, mle_results)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[dict[str, npt.NDArray], mle_module.MLE]</p>
</dd>
</dl>
<p>This is particularly useful for:
- Model validation and debugging
- Assessing parameter identifiability (e.g. by running multiple simulations)
- Verifying implementation correctness</p>
<p>The simulated data is automatically passed to the MLE fitting
procedure, overriding any data specification in kwargs.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate and fit with custom settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_data</span><span class="p">,</span> <span class="n">mle_fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">simulate_mle</span><span class="p">(</span><span class="n">epochs</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">to_pytorch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">nn_module.PyTorchModel</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.to_pytorch"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compile the model to a trainable PyTorch module.</p>
<p>This method converts the SciStanPy model into a PyTorch module that
can be optimized using standard PyTorch training procedures for
maximum likelihood estimation or variational inference. The inputs to this
module (i.e., the inputs to its <cite>forward</cite> method) are all observed data;
the output is the likelihood of that data given the current model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Random seed for reproducible compilation. Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Compiled PyTorch model ready for training</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn_module.PyTorchModel</p>
</dd>
</dl>
<p>The compiled model preserves the probabilistic structure while
enabling gradient-based optimization of model parameters. It’s
particularly useful for maximum likelihood estimation and can
leverage GPU acceleration for large models.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">to_stan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">StanModel</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.to_stan"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compile the model to Stan code for MCMC sampling.</p>
<p>This method automatically generates Stan probabilistic programming
language code from the SciStanPy model specification and compiles
it for Hamilitonian Monte-Carlo sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Additional compilation options passed to StanModel</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Compiled Stan model ready for MCMC sampling</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>stan_model.StanModel</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transformed_parameter_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TransformedParameter</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get named transformed parameters as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping names to transformed parameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, transformed_parameters_module.TransformedParameter]</p>
</dd>
</dl>
<p>Enables convenient access to transformed parameters for model
inspection and derived quantity analysis.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transformed_parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">TransformedParameter</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all named transformed parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of transformed parameter components</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[transformed_parameters_module.TransformedParameter, …]</p>
</dd>
</dl>
<p>Transformed parameters are deterministic functions of other model
components, representing computed quantities like sums, products,
or other mathematical transformations.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.model.model.</span></span><span class="sig-name descname"><span class="pre">model_comps_to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_comps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">AbstractModelComponent</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">AbstractModelComponent</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#model_comps_to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Convert an iterable of model components to a dictionary keyed by variable names.</p>
<p>This utility function creates a dictionary mapping from model variable names
to their corresponding component objects, facilitating easy lookup and
access to model components by name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_comps</strong> (<em>Iterable</em><em>[</em><em>abstract_model_component.AbstractModelComponent</em><em>]</em>) – Iterable of model components to convert</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping variable names to components</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[str, abstract_model_component.AbstractModelComponent]</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="n">param1</span><span class="p">,</span> <span class="n">param2</span><span class="p">,</span> <span class="n">observable1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">comp_dict</span> <span class="o">=</span> <span class="n">model_comps_to_dict</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access by name: comp_dict[&#39;param1&#39;]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">scistanpy.model.model.</span></span><span class="sig-name descname"><span class="pre">run_delayed_mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">hmc_results.SampleResults</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#run_delayed_mcmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Execute a delayed MCMC run from a pickled configuration file.</p>
<p>This function loads and executes MCMC sampling that was previously
configured with <cite>Model.mcmc(delay_run=True)</cite>. It’s useful for
running computationally intensive sampling jobs in batch systems
or separate processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> (<em>str</em>) – Path to the pickled MCMC configuration file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MCMC sampling results with posterior draws and diagnostics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>hmc_results.SampleResults</p>
</dd>
</dl>
<p>The function automatically enables console output to provide progress
feedback during the potentially long-running sampling process.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># First, create delayed run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">delay_run</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">iter_sampling</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Later, execute the run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">run_delayed_mcmc</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">stan_executable_path</span><span class="si">}</span><span class="s2">-delay.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.model.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Primary interface for Bayesian model construction and analysis in SciStanPy.</p>
<p>The Model class provides a declarative interface for building Bayesian models
by composing parameters, constants, and transformations. It automatically
handles component registration, validation, and provides methods for sampling,
compilation, and analysis across multiple backends.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Positional arguments (unused, for subclass compatibility)</p></li>
<li><p><strong>default_data</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>npt.NDArray</em><em>]</em><em>]</em>) – Default observed data for model observables. When provided,
any instance method requiring data will use these if not otherwise provided.
Defaults to None.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments (unused, for subclass compatibility)</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>_default_data</strong> – Stored default data for observables</p></li>
<li><p><strong>_named_model_components</strong> – Tuple of components that have explicit names</p></li>
<li><p><strong>_model_varname_to_object</strong> – Mapping from variable names to components</p></li>
<li><p><strong>_init_complete</strong> – Flag indicating initialization completion</p></li>
</ul>
</dd>
</dl>
<p>The class uses a metaclass pattern that automatically registers model
components defined as instance attributes. Components are validated
for naming conventions and automatically assigned model variable names.</p>
<dl>
<dt>Model Construction:</dt><dd><p>Models are built by subclassing Model and defining components as
instance attributes in the __init__ method. The metaclass automatically
discovers and registers these components.</p>
</dd>
<dt>Supported Operations:</dt><dd><ul class="simple">
<li><p>Prior and posterior sampling</p></li>
<li><p>Maximum likelihood estimation using PyTorch</p></li>
<li><p>MCMC sampling using Stan</p></li>
<li><p>Model compilation and caching</p></li>
<li><p>Prior predictive checking with interactive visualization</p></li>
<li><p>Model simulation and validation</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">HalfNormal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prior_samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mle_result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mle</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<p>This should be overridden by the subclass.</p>
<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_model_components</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">AbstractModelComponent</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all model components including unnamed intermediate components.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of all components sorted by variable name</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[abstract_model_component.AbstractModelComponent, …]</p>
</dd>
</dl>
<p>This includes both explicitly named components and any intermediate
components created during dependency resolution, providing complete
visibility into the model’s computational graph.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_model_components_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">AbstractModelComponent</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all model components as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping variable names to all components</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, abstract_model_component.AbstractModelComponent]</p>
</dd>
</dl>
<p>This comprehensive mapping includes both named and intermediate
components, enabling full programmatic access to the model structure.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">constant_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Constant</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get named constants as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping names to constant components</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, constants_module.Constant]</p>
</dd>
</dl>
<p>Provides convenient access to model constants for hyperparameter
inspection and sensitivity analysis workflows.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">constants</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Constant</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all named constants in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of constant components</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[constants_module.Constant, …]</p>
</dd>
</dl>
<p>Constants represent fixed values and hyperparameter specifications
that do not change during inference or optimization procedures.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd><p>Get the default observed data for model observables.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping observable names to their default data</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, npt.NDArray] | None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If default data has not been set</p>
</dd>
</dl>
<p>Default data is used automatically by methods like mle() and mcmc()
when no explicit data is provided, streamlining common workflows.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">named_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_xarray</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.draw"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">named_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_xarray</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">AbstractModelComponent</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">named_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_xarray</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">named_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_xarray</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span></dt>
<dd><p>Draw samples from the model’s prior distribution.</p>
<p>This method generates samples from all observable parameters in the
model by traversing the dependency graph and sampling from each
component’s distribution in topological order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>custom_types.Integer</em>) – Number of samples to draw from each observable</p></li>
<li><p><strong>named_only</strong> (<em>bool</em>) – Whether to return only named components. Defaults to True.</p></li>
<li><p><strong>as_xarray</strong> (<em>bool</em>) – Whether to return results as xarray Dataset. Defaults to False.</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Random seed for reproducible sampling. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled values in requested format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[dict[str, npt.NDArray], dict[AbstractModelComponent, npt.NDArray], xr.Dataset]</p>
</dd>
</dl>
<p>The method automatically handles:
- Dependency resolution between model components
- Consistent random number generation with optional seeding
- Efficient sampling by reusing intermediate results
- Format conversion based on return type preferences</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw 1000 samples as dictionary</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Draw 1000 samples as an xarray Dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">as_xarray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_dimname_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.get_dimname_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate mapping from dimension specifications to dimension names.</p>
<p>This method creates a dictionary that maps dimension level and size
tuples to appropriate dimension names for xarray dataset construction.
It ensures dimension names don’t conflict with model variable names.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping (level, size) tuples to dimension names</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[tuple[custom_types.Integer, custom_types.Integer], str]</p>
</dd>
</dl>
<p>The mapping is used to create consistent dimension naming across
all xarray datasets generated from model samples, ensuring proper
coordinate alignment and data structure.</p>
<p>Only dimensions with size &gt; 1 are assigned names, as singleton
dimensions are typically squeezed during xarray construction.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_default_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em></dt>
<dd><p>Check whether the model has default data configured.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if default data is set, False otherwise</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
<p>This property is useful for conditional logic that depends on
whether default data is available for automatic use in methods.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hyperparameter_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get hyperparameters as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping names to hyperparameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, parameters_module.Parameter]</p>
</dd>
</dl>
<p>Provides convenient access to the model’s hyperparameters by name
for prior specification and sensitivity analysis.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hyperparameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get hyperparameters (parameters with only constant parents).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of parameters that depend only on constants</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[parameters_module.Parameter, …]</p>
</dd>
</dl>
<p>Hyperparameters are the highest-level parameters in the model
hierarchy, typically representing prior distribution parameters
that are not derived from other random variables.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_compile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stanc_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpp_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">sample_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">hmc_results.SampleResults</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.mcmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_compile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stanc_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpp_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">sample_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span></dt>
<dd><p>Perform Hamiltonia Monte Carlo sampling using Stan backend.</p>
<p>This method compiles the model to Stan and executes Hamiltonian
Monte Carlo sampling to generate posterior samples. It supports
both immediate execution and delayed runs for batch processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Directory for compilation and output files. Defaults to None,
in which case all raw outputs will be saved to a temporary directory and
be accessible only for the lifetime of this Python process.</p></li>
<li><p><strong>force_compile</strong> (<em>bool</em>) – Whether to force recompilation of Stan model. Defaults
to False.</p></li>
<li><p><strong>stanc_options</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Options for Stan compiler. Defaults to None (uses
DEFAULT_STANC_OPTIONS).</p></li>
<li><p><strong>cpp_options</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Options for C++ compilation. Defaults to None (uses
DEFAULT_CPP_OPTIONS).</p></li>
<li><p><strong>user_header</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Custom C++ header code. Defaults to None.</p></li>
<li><p><strong>model_name</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Name for compiled model. Defaults to ‘model’.</p></li>
<li><p><strong>inits</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Initialization strategy. See <cite>stan_model.StanModel</cite>
for options. Defaults to None.</p></li>
<li><p><strong>data</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>npt.NDArray</em><em>]</em><em>]</em>) – Observed data for observables. Uses default_data defined during
initialization if not provided.</p></li>
<li><p><strong>delay_run</strong> (<em>Union</em><em>[</em><em>bool</em><em>, </em><em>str</em><em>]</em>) – Whether to delay execution. If <cite>True</cite>, a pickle file that
can be used for delayed execution will be saved to <cite>output_dir</cite>. A string
can also be provided to save the pickle file to an alternate location.
Defaults to False (meaning immediate execution).</p></li>
<li><p><strong>sample_kwargs</strong> – Additional arguments passed to Stan sampling. See
the <cite>cmdstanpy.CmdStanModel.sample</cite> for options.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MCMC results if delay_run=False, None if delayed</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[hmc_results.SampleResults, None]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If delay_run is True but output_dir is None</p>
</dd>
</dl>
<p>Delayed Execution:
When delay_run=True, the method saves sampling configuration to a
pickle file instead of executing immediately. This enables batch
processing and distributed computing workflows.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Immediate MCMC sampling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">iter_sampling</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Delayed execution for batch processing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">delay_run</span><span class="o">=</span><span class="s1">&#39;batch_job.pkl&#39;</span><span class="p">,</span> <span class="n">chains</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">iter_sampling</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">npt.NDArray</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixed_precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">mle_module.MLE</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.mle"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute maximum likelihood estimates of model parameters.</p>
<p>This method fits a PyTorch model to observed data by minimizing
the negative log-likelihood, providing point estimates of all
model parameters along with optimization diagnostics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>custom_types.Integer</em>) – Maximum number of training epochs. Note that one step is one
epoch as the model must be evaluated over all observable data to calculate
loss. Defaults to 100000.</p></li>
<li><p><strong>early_stop</strong> (<em>custom_types.Integer</em>) – Epochs without improvement before stopping. Defaults to 10.</p></li>
<li><p><strong>lr</strong> (<em>custom_types.Float</em>) – Learning rate for optimization. Defaults to 0.001.</p></li>
<li><p><strong>data</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Union</em><em>[</em><em>torch.Tensor</em><em>, </em><em>npt.NDArray</em><em>]</em><em>]</em><em>]</em>) – Observed data for observables. Uses default_data provided at
initialization if not provided.</p></li>
<li><p><strong>device</strong> (<em>Union</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>str</em><em>]</em>) – Computation device (‘cpu’, ‘cuda’, or device index). Defaults to ‘cpu’.</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Random seed for reproducible optimization. Defaults to None.</p></li>
<li><p><strong>mixed_precision</strong> (<em>bool</em>) – Whether to use mixed precision training. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MLE results with parameter estimates and diagnostics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>mle_module.MLE</p>
</dd>
</dl>
<p>The optimization process:</p>
<ul class="simple">
<li><p>Converts model to PyTorch and moves to specified device</p></li>
<li><p>Trains for <cite>epochs</cite> number of epochs or until there has been no improvement
for <cite>early_stop</cite> number epochs.</p></li>
<li><p>Tracks loss trajectory for convergence assessment</p></li>
<li><p>Returns parameter estimates and fitted distributions</p></li>
</ul>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Basic MLE with default settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mle_result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">observed_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># GPU-accelerated with custom settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mle_result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">named_model_components</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">AbstractModelComponent</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all named model components.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of named components</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[abstract_model_component.AbstractModelComponent, …]</p>
</dd>
</dl>
<p>Named components are those explicitly assigned as instance attributes
during model construction, as opposed to intermediate components
created automatically during dependency resolution.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">named_model_components_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">AbstractModelComponent</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get named model components as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping variable names to named components</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, abstract_model_component.AbstractModelComponent]</p>
</dd>
</dl>
<p>This provides convenient access to named components by their
string names for programmatic model inspection and manipulation.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observable_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get observable parameters as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping names to observable parameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, parameters_module.Parameter]</p>
</dd>
</dl>
<p>Enables convenient access to observable parameters for data
specification and model validation workflows.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observables</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all observable parameters in the model (observables are always named).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of parameters marked as observable</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[parameters_module.Parameter, …]</p>
</dd>
</dl>
<p>Observable parameters represent the data-generating components
of the model - the variables for which observed data will be
provided during inference procedures.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parameter_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get non-observable parameters as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping names to non-observable parameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, parameters_module.Parameter]</p>
</dd>
</dl>
<p>Provides convenient named access to the model’s latent parameters
for inspection and programmatic manipulation.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all non-observable parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of parameter components that are not observables</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[parameters_module.Parameter, …]</p>
</dd>
</dl>
<p>These are the latent variables and hyperparameters that will be
inferred during MCMC sampling or optimized during MLE fitting.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">prior_predictive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Row</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.prior_predictive"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create interactive prior predictive check visualization.</p>
<p>This method generates an interactive dashboard for exploring the
model’s prior predictive distribution. Users can adjust model
hyperparameters via sliders and immediately see how changes
affect prior predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>copy_model</strong> (<em>bool</em>) – Whether to copy model to avoid modifying original. Defaults
to False, meaning the calling model is updated in place by changing
slider values and clicking “update model”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Panel dashboard with interactive prior predictive visualization</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pn.Row</p>
</dd>
</dl>
<p>The dashboard includes:
- Sliders for all adjustable model hyperparameters
- Multiple visualization modes (ECDF, KDE, violin, relationship plots)
- Real-time updates as parameters are modified
- Options for different grouping and display configurations</p>
<p>This is useful for:
- Prior specification and calibration
- Understanding model behavior before data fitting
- Identifying unrealistic prior assumptions</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create interactive dashboard</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dashboard</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">prior_predictive</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dashboard</span><span class="o">.</span><span class="n">servable</span><span class="p">()</span>  <span class="c1"># For web deployment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Or display in Jupyter notebook</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dashboard</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">simulate_mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delay_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">npt.NDArray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'hmc_results.SampleResults'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.simulate_mcmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">simulate_mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delay_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span></dt>
<dd><p>Simulate data from model prior and perform Hamiltonian Monte Carlo sampling.</p>
<p>This method generates synthetic data from the model’s prior
distribution and then performs full Bayesian inference via MCMC.
It’s extremely helpful for model validation and posterior recovery testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delay_run</strong> (<em>bool</em>) – Whether to delay MCMC execution. Defaults to False.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments passed to mcmc() method</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (simulated_data, mcmc_results) if delay_run=False,
None if delay_run=True</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[tuple[dict[str, npt.NDArray], hmc_results.SampleResults], None]</p>
</dd>
</dl>
<p>The method automatically updates the model name to indicate
simulation when using the default name, helping distinguish
simulated from real data analyses.</p>
<p>This is crucial for:
- Validating MCMC implementation correctness
- Testing posterior recovery in known-truth scenarios
- Assessing sampler efficiency and convergence
- Debugging model specification issues</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate and sample with immediate execution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_data</span><span class="p">,</span> <span class="n">mcmc_results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">simulate_mcmc</span><span class="p">(</span><span class="n">chains</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">iter_sampling</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">simulate_mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MLE</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.simulate_mle"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Simulate data from model prior and fit via maximum likelihood.</p>
<p>This method performs a complete simulation study by first generating
synthetic data from the model’s prior distribution, then fitting
the model to this simulated data using maximum likelihood estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Keyword arguments passed to mle() method (except ‘data’)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (simulated_data, mle_results)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[dict[str, npt.NDArray], mle_module.MLE]</p>
</dd>
</dl>
<p>This is particularly useful for:
- Model validation and debugging
- Assessing parameter identifiability (e.g. by running multiple simulations)
- Verifying implementation correctness</p>
<p>The simulated data is automatically passed to the MLE fitting
procedure, overriding any data specification in kwargs.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate and fit with custom settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_data</span><span class="p">,</span> <span class="n">mle_fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">simulate_mle</span><span class="p">(</span><span class="n">epochs</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">to_pytorch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">nn_module.PyTorchModel</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.to_pytorch"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compile the model to a trainable PyTorch module.</p>
<p>This method converts the SciStanPy model into a PyTorch module that
can be optimized using standard PyTorch training procedures for
maximum likelihood estimation or variational inference. The inputs to this
module (i.e., the inputs to its <cite>forward</cite> method) are all observed data;
the output is the likelihood of that data given the current model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>custom_types.Integer</em><em>]</em>) – Random seed for reproducible compilation. Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Compiled PyTorch model ready for training</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn_module.PyTorchModel</p>
</dd>
</dl>
<p>The compiled model preserves the probabilistic structure while
enabling gradient-based optimization of model parameters. It’s
particularly useful for maximum likelihood estimation and can
leverage GPU acceleration for large models.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">to_stan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">StanModel</span></span></span><a class="reference internal" href="../../../_modules/scistanpy/model/model.html#Model.to_stan"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compile the model to Stan code for MCMC sampling.</p>
<p>This method automatically generates Stan probabilistic programming
language code from the SciStanPy model specification and compiles
it for Hamilitonian Monte-Carlo sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Additional compilation options passed to StanModel</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Compiled Stan model ready for MCMC sampling</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>stan_model.StanModel</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transformed_parameter_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TransformedParameter</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get named transformed parameters as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping names to transformed parameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, transformed_parameters_module.TransformedParameter]</p>
</dd>
</dl>
<p>Enables convenient access to transformed parameters for model
inspection and derived quantity analysis.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transformed_parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">TransformedParameter</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd><p>Get all named transformed parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of transformed parameter components</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[transformed_parameters_module.TransformedParameter, …]</p>
</dd>
</dl>
<p>Transformed parameters are deterministic functions of other model
components, representing computed quantities like sums, products,
or other mathematical transformations.</p>
</dd></dl>

</dd></dl>

</section>
<section id="how-models-are-constructed">
<h2>How Models are Constructed<a class="headerlink" href="#how-models-are-constructed" title="Link to this heading">¶</a></h2>
<p>The Model class is designed to be subclassed. Model components (for example parameters and constants) are declared as instance attributes in __init__ and are discovered and registered automatically by the class machinery. This makes model definitions concise and declarative.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scistanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ssp</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SimpleModel</span><span class="p">(</span><span class="n">ssp</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># register a prior parameter and an observable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">HalfNormal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="key-behaviors-and-api-surface">
<h2>Key Behaviors and API Surface<a class="headerlink" href="#key-behaviors-and-api-surface" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Automatic component registration: attributes that are <cite>AbstractModelComponent</cite> instances are assigned model variable names and collected during initialization.</p></li>
<li><p>Introspection properties: the Model exposes typed properties such as <cite>parameters</cite>, <cite>parameter_dict</cite>, <cite>transformed_parameters</cite>, <cite>observables</cite>, <cite>constant_dict</cite>, and helpers like <cite>named_model_components_dict</cite> for programmatic inspection.</p></li>
<li><p>Default data: models may carry <cite>default_data</cite> which is used by inference methods when explicit data is not provided.</p></li>
<li><p>Core methods:
- draw(n, …): sample from priors for model components and return samples (supports returning xarray when requested).
- to_pytorch(seed=None): convert the model to a PyTorch-backed <cite>nn_module.PyTorchModel</cite> for optimization or variational methods.
- to_stan(…): compile or produce a <cite>stan_model.StanModel</cite> representation of the SciStanPy model.
- mle(…): run maximum-likelihood (or optimization) using the PyTorch backend; returns an <cite>mle_module.MLE</cite> result object.
- mcmc(…): generate Stan code, compile (with caching) and run MCMC sampling via the Stan backend; accepts options for compilation and sampling and returns a Stan-backed results object.</p></li>
</ul>
</section>
<section id="notes-on-backends">
<h2>Notes on Backends<a class="headerlink" href="#notes-on-backends" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>PyTorch is used for optimization / MLE and for converting models to a differentiable form via <cite>to_pytorch</cite>.</p></li>
<li><p>Stan is used for MCMC sampling; the <cite>mcmc</cite> method produces Stan code from the model, compiles it (with configurable options), and runs sampling.</p></li>
</ul>
</section>
<section id="documentation-pages">
<h2>Documentation Pages<a class="headerlink" href="#documentation-pages" title="Link to this heading">¶</a></h2>
<p>See the subpages linked in the toctree for detailed information about model components, the PyTorch interface (<cite>nn_module</cite>), and Stan integration (the <cite>stan</cite> submodule).</p>
</section>
<section id="guidance">
<h2>Guidance<a class="headerlink" href="#guidance" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Build models incrementally and validate with prior draws before running expensive samplers.</p></li>
<li><p>Use <cite>mle</cite> to obtain point estimates that can be used as sensible initializations for Stan in <cite>mcmc</cite> (for example by transforming MLE results into Stan inits when appropriate).</p></li>
<li><p>Prefer explicit <cite>data</cite> arguments to <cite>mle</cite> / <cite>mcmc</cite> for reproducibility; <cite>default_data</cite> is a convenience but may hide sources of variation.</p></li>
</ul>
<p>This page intentionally limits claims to behaviors implemented in the <cite>scistanpy.model.model</cite> implementation and refers readers to the component and backend pages for the complete API details.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">SciStanPy</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">SciStanPy API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#scope">Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#top-level-package">Top-Level Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#module-overview">Module Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#quick-navigation">Quick Navigation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../custom_types.html">Custom Types API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../defaults.html">Defaults API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exceptions.html">Exceptions API Reference</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Model API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plotting/index.html">Plotting API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operations.html">Operations API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils.html">Utils API Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#usage-notes">Usage Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#stability">Stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#missing-something">Missing Something?</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">SciStanPy API Reference</a><ul>
      <li>Previous: <a href="../exceptions.html" title="previous chapter">Exceptions API Reference</a></li>
      <li>Next: <a href="components/index.html" title="next chapter">Model Components API Reference</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Bruce Wittmann.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.3.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../../_sources/docs/api/model/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>