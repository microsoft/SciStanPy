<!DOCTYPE html>

<html lang="en" data-content_root="../../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Transformations API Reference &#8212; SciStanPy Alpha documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../../../_static/documentation_options.js?v=6b921976"></script>
    <script src="../../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="CDFs API Reference" href="cdfs.html" />
    <link rel="prev" title="Parameters API Reference" href="../parameters.html" />
   
  <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="transformations-api-reference">
<h1>Transformations API Reference<a class="headerlink" href="#transformations-api-reference" title="Link to this heading">¶</a></h1>
<p>This reference covers the mathematical transformations and operator overloading framework in SciStanPy.</p>
<p>The transformations submodule provides the foundation for mathematical operations on model components, enabling complex model construction through operator overloading and automatic dependency tracking.</p>
<section id="transformations-submodule-overview">
<h2>Transformations Submodule Overview<a class="headerlink" href="#transformations-submodule-overview" title="Link to this heading">¶</a></h2>
<p>The transformations submodule consists of several key components:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="cdfs.html">CDFs API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="transformed_data.html">Transformed Data API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="transformed_parameters.html">Transformed Parameters API Reference</a></li>
</ul>
</div>
</section>
<section id="transformations-module">
<h2>Transformations Module<a class="headerlink" href="#transformations-module" title="Link to this heading">¶</a></h2>
<p>Transformation components for mathematical operations on SciStanPy model parameters.</p>
<p>This submodule provides a comprehensive framework for mathematical transformations
that can be applied to model parameters in SciStanPy. These transformations enable
the construction of complex probabilistic models through composition of simple
mathematical operations while maintaining automatic differentiation capabilities
and Stan code generation.</p>
<p>The transformation system is organized into several key areas:</p>
<dl class="simple">
<dt>Core Transformation Infrastructure:</dt><dd><ul class="simple">
<li><p><strong>transformed_parameters</strong>: Base classes and concrete mathematical operations</p></li>
<li><p><strong>transformed_data</strong>: Components for Stan’s transformed data block</p></li>
<li><p><strong>cdfs</strong>: Cumulative distribution function transformations</p></li>
</ul>
</dd>
<dt>Key Features:</dt><dd><ul class="simple">
<li><p><strong>Multi-Backend Support</strong>: Operation across NumPy, PyTorch, and Stan</p></li>
<li><p><strong>Automatic Differentiation</strong>: Maintains gradient flow for optimization</p></li>
<li><p><strong>Stan Code Generation</strong>: Automatic translation to Stan programming language</p></li>
<li><p><strong>Operator Overloading</strong>: Natural mathematical syntax through Python operators</p></li>
<li><p><strong>Shape Broadcasting</strong>: Automatic handling of multi-dimensional operations</p></li>
<li><p><strong>Type Safety</strong>: Comprehensive validation and error checking</p></li>
</ul>
</dd>
</dl>
<p>Transformation Categories:</p>
<dl class="simple">
<dt><strong>Arithmetic Operations</strong>: Basic mathematical operations between parameters</dt><dd><ul class="simple">
<li><p>Addition, subtraction, multiplication, division</p></li>
<li><p>Exponentiation and negation</p></li>
<li><p>Automatic operator overloading support</p></li>
</ul>
</dd>
<dt><strong>Mathematical Functions</strong>: Standard mathematical transformations</dt><dd><ul class="simple">
<li><p>Logarithms, exponentials, absolute values</p></li>
<li><p>Sigmoid and logistic functions</p></li>
<li><p>Trigonometric operations (where applicable)</p></li>
</ul>
</dd>
<dt><strong>Statistical Operations</strong>: Operations common in statistical modeling</dt><dd><ul class="simple">
<li><p>Normalization (standard and log-space)</p></li>
<li><p>Reductions (sum, log-sum-exp)</p></li>
<li><p>Probability transformations</p></li>
</ul>
</dd>
<dt><strong>Growth Models</strong>: Specialized transformations for temporal modeling</dt><dd><ul class="simple">
<li><p>Exponential growth (standard and log-scale)</p></li>
<li><p>Sigmoid growth with multiple parameterizations</p></li>
<li><p>Binary time-point specialized versions</p></li>
</ul>
</dd>
<dt><strong>Array Operations</strong>: Advanced array manipulation capabilities</dt><dd><ul class="simple">
<li><p>NumPy-compatible indexing and slicing</p></li>
<li><p>Sequence convolution for pattern recognition</p></li>
<li><p>Multi-dimensional array transformations</p></li>
</ul>
</dd>
<dt><strong>Probability Functions</strong>: CDF and related probability computations</dt><dd><ul class="simple">
<li><p>Standard and log-space CDFs</p></li>
<li><p>Survival functions and complementary CDFs</p></li>
<li><p>Numerical stability for extreme values</p></li>
</ul>
</dd>
</dl>
<p>Usage Patterns:</p>
<dl>
<dt><strong>Operator Overloading</strong> (Primary method):</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">param1</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param2</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combined</span> <span class="o">=</span> <span class="n">param1</span> <span class="o">+</span> <span class="n">param2</span>  <span class="c1"># Creates AddParameter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">param1</span>        <span class="c1"># Creates MultiplyParameter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transformed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">param1</span><span class="p">)</span>  <span class="c1"># Creates ExpParameter</span>
</pre></div>
</div>
</dd>
<dt><strong>Direct Instantiation</strong> (Advanced usage):</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scistanpy.model.components.transformations.transformed_parameters</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogParameter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_param</span> <span class="o">=</span> <span class="n">LogParameter</span><span class="p">(</span><span class="n">positive_param</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt><strong>CDF Access</strong> (Automatic through Parameter classes):</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">normal_param</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdf_values</span> <span class="o">=</span> <span class="n">normal_param</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data_points</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">survival_probs</span> <span class="o">=</span> <span class="n">normal_param</span><span class="o">.</span><span class="n">ccdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_points</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt><strong>Growth Modeling</strong>:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time_points</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_value</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">growth_rate</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">population</span> <span class="o">=</span> <span class="n">ExponentialGrowth</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">time_points</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="n">initial_value</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">growth_rate</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>Integration with SciStanPy:</p>
<p>The transformation system integrates deeply with SciStanPy’s model architecture:
- Automatic shape inference and broadcasting
- Parent-child relationship tracking
- Stan code generation for all transformation types
- PyTorch tensor support for gradient-based optimization
- Comprehensive error checking and validation</p>
<p>Performance Considerations:</p>
<dl class="simple">
<dt><strong>Transformed Data</strong>: Components that execute once during Stan initialization</dt><dd><ul class="simple">
<li><p>Pre-computed expensive operations</p></li>
<li><p>Constant coefficient calculations</p></li>
<li><p>Performance optimization for repeated computations</p></li>
</ul>
</dd>
<dt><strong>Transformed Parameters</strong>: Components that execute during sampling</dt><dd><ul class="simple">
<li><p>Dynamic transformations applied each iteration</p></li>
<li><p>Maintains parameter relationships</p></li>
<li><p>Supports complex mathematical expressions</p></li>
</ul>
</dd>
</dl>
<p>The transformation framework enables users to build sophisticated probabilistic
models using intuitive mathematical syntax while automatically handling the
complexities of multi-backend code generation and numerical stability.</p>
</section>
<section id="transformed-parameters">
<h2>Transformed Parameters<a class="headerlink" href="#transformed-parameters" title="Link to this heading">¶</a></h2>
<p>Parameter transformation components for SciStanPy models.</p>
<p>This module provides a comprehensive library of mathematical transformations that
can be applied to model parameters. These transformations enable complex model
construction through composition of simple mathematical operations while maintaining
automatic differentiation capabilities and Stan code generation.</p>
<p>The transformation system supports:</p>
<dl class="simple">
<dt>Transformation Categories:</dt><dd><ul class="simple">
<li><p><strong>Arithmetic Operations</strong>: Addition, subtraction, multiplication, division, powers</p></li>
<li><p><strong>Mathematical Functions</strong>: Logarithms, exponentials, absolute values, sigmoids</p></li>
<li><p><strong>Statistical Operations</strong>: Normalization, log-sum-exp, reductions</p></li>
<li><p><strong>Growth Models</strong>: Exponential and sigmoid growth parameterizations</p></li>
<li><p><strong>Array Operations</strong>: Indexing, slicing, convolution</p></li>
</ul>
</dd>
<dt>Key Features:</dt><dd><ul class="simple">
<li><p><strong>Multi-Backend Support</strong>: Works with NumPy, PyTorch, and Stan</p></li>
<li><p><strong>Automatic Differentiation</strong>: Maintains gradient flow for PyTorch optimization</p></li>
<li><p><strong>Stan Code Generation</strong>: Automatic translation to Stan programming language</p></li>
<li><p><strong>Operator Overloading</strong>: Natural mathematical syntax through Python operators</p></li>
<li><p><strong>Shape Broadcasting</strong>: Automatic handling of multi-dimensional operations</p></li>
<li><p><strong>Type Safety</strong>: Comprehensive validation and error checking</p></li>
</ul>
</dd>
<dt>Transformation Architecture:</dt><dd><p>The module provides several base classes that establish the transformation framework:
- <strong>TransformableParameter</strong>: Mixin enabling operator overloading
- <strong>Transformation</strong>: Base class for all transformation types
- <strong>TransformedParameter</strong>: Foundation for parameter transformations
- <strong>BinaryTransformedParameter</strong>: Two-operand mathematical operations
- <strong>UnaryTransformedParameter</strong>: Single-operand mathematical operations</p>
</dd>
<dt>Advanced Transformations:</dt><dd><p>Beyond basic arithmetic, the module includes specialized transformations for:
- Growth modeling (exponential, sigmoid) with multiple parameterizations
- Sequence processing (convolution operations)
- Array manipulation (indexing with NumPy-compatible syntax)
- Numerical stability (log-space operations, stable sigmoid)
- Statistical operations (normalization, reductions)</p>
</dd>
</dl>
<p>Note that these will not typically be instantiated directly. Instead, use Python’s
inbuilt operators between other model components or else use SciStanPy’s <cite>operations</cite>
submodule.</p>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">AbsParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#AbsParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UnaryTransformedParameter</span></code></p>
<p>Absolute value transformation for parameters.</p>
<p>Implements element-wise absolute value: result = |dist1|</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>LOWER_BOUND</strong> – Absolute values are always non-negative (0.0)</p>
</dd>
</dl>
<p>Mathematical Properties:
- Non-negative output: |a| ≥ 0
- Idempotent for non-negative inputs: ||a|| = |a|
- Triangle inequality: |a + b| ≤ |a| + |b|</p>
<p>This transformation ensures non-negative values and is commonly used
for magnitudes, distances, and ensuring positive parameters.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">LOWER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">custom_types.Float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#AbsParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute element-wise absolute value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> – Input parameter</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Absolute value of input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#AbsParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan absolute value function call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted parameter string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan abs() function call</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">AddParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#AddParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryTransformedParameter</span></code></p>
<p>Addition transformation for two parameters.</p>
<p>Implements element-wise addition of two parameters: result = dist1 + dist2</p>
<p>Mathematical Properties:
- Commutative: a + b = b + a
- Associative: (a + b) + c = a + (b + c)
- Identity element: 0</p>
<p>This transformation preserves the shape through broadcasting and is commonly
used for combining effects, offsets, and linear combinations of parameters.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">STAN_OPERATOR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'+'</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#AddParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Perform element-wise addition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist1</strong> – First addend</p></li>
<li><p><strong>dist2</strong> – Second addend</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sum of the two inputs</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">BinaryExponentialGrowth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#BinaryExponentialGrowth"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ExpParameter</span></code></p>
<p>Binary exponential growth for two time points.</p>
<p>Special case of exponential growth for modeling with only two time points,
assuming t₀ = 0 and t₁ = 1. This reduces to: x = A * exp(r)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>custom_types.CombinableParameterType</em>) – Amplitude parameter (value at t=0)</p></li>
<li><p><strong>r</strong> (<em>custom_types.CombinableParameterType</em>) – Growth rate parameter</p></li>
<li><p><strong>kwargs</strong> – Additional arguments passed to parent class</p></li>
</ul>
</dd>
</dl>
<p>Mathematical Properties:
- Simplified exponential model for binary time points
- A represents initial value
- exp(r) represents fold-change from t=0 to t=1
- r is log-fold-change</p>
<p>This transformation is useful for:
- Before/after comparisons
- Treatment effect modeling
- Two-timepoint studies
- Fold-change analysis</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">baseline</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_fold_change</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">final_value</span> <span class="o">=</span> <span class="n">BinaryExponentialGrowth</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="n">baseline</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">log_fold_change</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>Initialize binary exponential growth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> – Amplitude parameter</p></li>
<li><p><strong>r</strong> – Rate parameter</p></li>
<li><p><strong>kwargs</strong> – Additional arguments</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#BinaryExponentialGrowth.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Compute binary exponential growth: A * exp(r).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> – Amplitude values</p></li>
<li><p><strong>r</strong> – Rate values</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A * exp(r)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#BinaryExponentialGrowth.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan code for binary exponential growth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>str</em>) – Formatted amplitude parameter</p></li>
<li><p><strong>r</strong> (<em>str</em>) – Formatted rate parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan code for A .* exp(r)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">BinaryLogExponentialGrowth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#BinaryLogExponentialGrowth"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformedParameter</span></code></p>
<p>Binary log-exponential growth for two time points.</p>
<p>Special case of log-exponential growth for two time points,
reducing to: log(x) = log_A + r</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_A</strong> (<em>custom_types.CombinableParameterType</em>) – Log-amplitude parameter (log of initial value)</p></li>
<li><p><strong>r</strong> (<em>custom_types.CombinableParameterType</em>) – Growth rate parameter</p></li>
<li><p><strong>kwargs</strong> – Additional arguments passed to parent class</p></li>
</ul>
</dd>
</dl>
<p>Mathematical Properties:
- Simple additive model in log-space
- r represents log-fold-change
- Guaranteed positive output when exponentiated
- Linear relationship in log-scale</p>
<p>This transformation is ideal for:
- Binary treatment effects in log-space
- Fold-change modeling
- Two-timepoint growth analysis
- Log-scale before/after comparisons</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">log_baseline</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">4.6</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># log(100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_fold_change</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_final</span> <span class="o">=</span> <span class="n">BinaryLogExponentialGrowth</span><span class="p">(</span><span class="n">log_A</span><span class="o">=</span><span class="n">log_baseline</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">log_fold_change</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>Initialize binary log-exponential growth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_A</strong> – Log-amplitude parameter</p></li>
<li><p><strong>r</strong> – Rate parameter</p></li>
<li><p><strong>kwargs</strong> – Additional arguments</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#BinaryLogExponentialGrowth.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Compute binary log-exponential growth: log_A + r.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_A</strong> – Log-amplitude values</p></li>
<li><p><strong>r</strong> – Rate values</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>log_A + r</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#BinaryLogExponentialGrowth.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan code for binary log-exponential growth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_A</strong> (<em>str</em>) – Formatted log-amplitude parameter</p></li>
<li><p><strong>r</strong> (<em>str</em>) – Formatted rate parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan code for log_A + r</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">BinaryTransformedParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#BinaryTransformedParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformedParameter</span></code></p>
<p>Base class for transformations involving exactly two parameters.</p>
<p>This class provides a specialized interface for binary mathematical operations
such as addition, subtraction, multiplication, and division. It enforces the
two-parameter constraint and provides appropriate method signatures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist1</strong> (<em>custom_types.CombinableParameterType</em>) – First parameter for the operation</p></li>
<li><p><strong>dist2</strong> (<em>custom_types.CombinableParameterType</em>) – Second parameter for the operation</p></li>
<li><p><strong>kwargs</strong> – Additional arguments passed to parent class</p></li>
</ul>
</dd>
</dl>
<p>Binary operations are the foundation for arithmetic expressions and provide
the building blocks for more complex mathematical relationships between
parameters.</p>
<p>Subclasses must implement run_np_torch_op with the (dist1, dist2) signature
and can optionally override write_stan_operation for custom Stan formatting.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#BinaryTransformedParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Execute binary operation on two inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist1</strong> – First operand</p></li>
<li><p><strong>dist2</strong> – Second operand</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of binary operation</p>
</dd>
</dl>
<p>This method implements the core binary mathematical operation
for both NumPy and PyTorch backends.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#BinaryTransformedParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan code for binary operations using STAN_OPERATOR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist1</strong> (<em>str</em>) – Formatted string for first parameter</p></li>
<li><p><strong>dist2</strong> (<em>str</em>) – Formatted string for second parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan code with infix operator</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p>Generates Stan code in the format “dist1 OPERATOR dist2” for
standard binary operations.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">ConvolveSequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordinals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#ConvolveSequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformedParameter</span></code></p>
<p>Sequence convolution transformation using weight matrices.</p>
<p>Performs convolution operation on ordinally-encoded sequences using provided
weight matrices. This is commonly used for sequence modeling and pattern
recognition in biological sequences or text data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<em>custom_types.CombinableParameterType</em>) – Weight matrix for convolution (at least 2D)</p></li>
<li><p><strong>ordinals</strong> (<em>custom_types.CombinableParameterType</em>) – Ordinally-encoded sequence array (at least 1D)</p></li>
<li><p><strong>kwargs</strong> – Additional arguments passed to parent class</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>SHAPE_CHECK</strong> – Disabled for complex shape operations (False)</p></li>
<li><p><strong>FORCE_LOOP_RESET</strong> – Forces loop reset in Stan code (True)</p></li>
<li><p><strong>FORCE_PARENT_NAME</strong> – Forces parent naming in Stan code (True)</p></li>
</ul>
</dd>
</dl>
<p>Shape Requirements:
- Weights: (…, kernel_size, alphabet_size)
- Ordinals: (…, sequence_length)
- Output: (…, sequence_length - kernel_size + 1)</p>
<p>The transformation applies convolution by:
1. Sliding a kernel of size kernel_size over the sequence
2. Using ordinal values to index into the weight matrix
3. Summing weighted values for each position</p>
<p>This is commonly used for:
- DNA/RNA sequence analysis
- Protein sequence modeling
- Text processing with character-level models
- Pattern recognition in discrete sequences</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DNA sequence convolution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">motif_length</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1"># 4 nucleotides</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dna_sequence</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="n">encoded_dna</span><span class="p">)</span>  <span class="c1"># 0,1,2,3 for A,C,G,T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">motif_scores</span> <span class="o">=</span> <span class="n">ConvolveSequence</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">ordinals</span><span class="o">=</span><span class="n">dna_sequence</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>Initialize sequence convolution with shape validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> – Weight matrix (kernel_size × alphabet_size in last 2 dims)</p></li>
<li><p><strong>ordinals</strong> – Ordinal sequence array</p></li>
<li><p><strong>kwargs</strong> – Additional arguments</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If weights is not at least 2D</p></li>
<li><p><strong>ValueError</strong> – If ordinals is not at least 1D</p></li>
<li><p><strong>ValueError</strong> – If shapes are incompatible for broadcasting</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">FORCE_LOOP_RESET</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">FORCE_PARENT_NAME</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">SHAPE_CHECK</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_index_offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">AbstractModelComponent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_adjustment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#ConvolveSequence.get_index_offset"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculate index offset with special handling for weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – Component or parameter name to query</p></li>
<li><p><strong>offset_adjustment</strong> – Base offset adjustment</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Index offset (adjusted +1 for weights parameter)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p>The weights parameter requires special offset handling because
its last two dimensions are used directly in the convolution
rather than being broadcast.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_right_side</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_opts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_adjustment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#ConvolveSequence.get_right_side"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate right-side code with proper dimension handling.</p>
<p>Sets default end_dims to exclude the last weight dimension (-2),
ensuring both kernel_size and alphabet_size dimensions are preserved.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_supporting_functions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#ConvolveSequence.get_supporting_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return required Stan function includes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List including pssm.stanfunctions for convolution support</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordinals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#ConvolveSequence.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Performs the convolution</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordinals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#ConvolveSequence.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan convolution function call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<em>str</em>) – Formatted weights parameter name</p></li>
<li><p><strong>ordinals</strong> (<em>str</em>) – Formatted ordinals parameter name</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan function call for sequence convolution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">DivideParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#DivideParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryTransformedParameter</span></code></p>
<p>Element-wise division transformation for two parameters.</p>
<p>Implements element-wise division of two parameters: result = dist1 / dist2</p>
<p>Mathematical Properties:
- Non-commutative: a / b ≠ b / a (generally)
- Non-associative: (a / b) / c ≠ a / (b / c) (generally)
- Identity element: 1 (for right operand)</p>
<p>This transformation is used for ratios, rates, normalized quantities,
and relative measures. Care must be taken to avoid division by zero.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">STAN_OPERATOR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'./'</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#DivideParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Perform element-wise division.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist1</strong> – Dividend</p></li>
<li><p><strong>dist2</strong> – Divisor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Quotient of the two inputs</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">ExpParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#ExpParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UnaryTransformedParameter</span></code></p>
<p>Exponential transformation for parameters.</p>
<p>Implements element-wise exponential function: result = exp(dist1)</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>LOWER_BOUND</strong> – Exponential values are always positive (0.0)</p>
</dd>
</dl>
<p>Mathematical Properties:
- Domain: (-∞, ∞)
- Range: (0, ∞)
- Exponential laws: exp(a+b) = exp(a)*exp(b), exp(a*b) ≠ exp(a)*exp(b)
- Inverse: ln(exp(a)) = a</p>
<p>This transformation is used for ensuring positive values, exponential
growth models, and converting from log-scale to natural scale.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">LOWER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">custom_types.Float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#ExpParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Execute unary operation on single input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> – Input operand</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of unary operation</p>
</dd>
</dl>
<p>This method implements the core unary mathematical operation
for both NumPy and PyTorch backends.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#ExpParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan exponential function call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted parameter string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan exp() function call</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">ExponentialGrowth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#ExponentialGrowth"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ExpParameter</span></code></p>
<p>A transformed parameter that models exponential growth. Specifically, parameters
<cite>t</cite>, <cite>A</cite>, and <cite>r</cite> are used to calculate the exponential growth model as follows:</p>
<p>$$
x = Atextrm{e}^{rt)
$$</p>
<p>Initialize exponential growth model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – Time parameter</p></li>
<li><p><strong>A</strong> – Amplitude parameter</p></li>
<li><p><strong>r</strong> – Rate parameter</p></li>
<li><p><strong>kwargs</strong> – Additional arguments</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#ExponentialGrowth.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Compute exponential growth: A * exp(r * t).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – Time values</p></li>
<li><p><strong>A</strong> – Amplitude values</p></li>
<li><p><strong>r</strong> – Rate values</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Exponential growth values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#ExponentialGrowth.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan exponential function call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted parameter string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan exp() function call</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">IndexParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.IndexType</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#IndexParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformedParameter</span></code></p>
<p>Array indexing transformation with NumPy-compatible semantics.</p>
<p>Creates indexed subsets of parameters using slicing, scalar indexing,
and array indexing. Follows NumPy indexing conventions rather than
Stan conventions for consistency with Python data manipulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist</strong> (<em>custom_types.CombinableParameterType</em>) – Parameter to index</p></li>
<li><p><strong>indices</strong> (<em>custom_types.IndexType</em>) – Indexing specifications (slices, integers, arrays)</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>SHAPE_CHECK</strong> – Disabled for complex indexing operations (False)</p></li>
<li><p><strong>FORCE_PARENT_NAME</strong> – Forces parent naming in Stan code (True)</p></li>
</ul>
</dd>
</dl>
<p>Supported Index Types:
- <strong>slice</strong>: Standard Python slicing with start:stop (step=1 only)
- <strong>int</strong>: Single element selection
- <strong>np.ndarray</strong>: Advanced indexing with integer arrays. 1D only. Follows numpy convention.
- <strong>Ellipsis</strong>: Automatic dimension filling
- <strong>None</strong>: New axis insertion</p>
<p>Important Differences from Stan:
- Uses 0-based indexing (Python convention)
- Advanced indexing follows NumPy broadcasting rules
- Negative indices are supported and converted appropriately</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Slice first 5 rows</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset</span> <span class="o">=</span> <span class="n">IndexParameter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Select specific elements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">selected</span> <span class="o">=</span> <span class="n">IndexParameter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>  <span class="c1"># NumPy-style</span>
</pre></div>
</div>
</dd>
</dl>
<p>Initialize indexing transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist</strong> – Parameter to index</p></li>
<li><p><strong>indices</strong> – Indexing specifications</p></li>
</ul>
</dd>
</dl>
<p>The initialization processes all index types, converts negative
indices to positive, validates array dimensions, and creates
appropriate constant parameters for array indices.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">FORCE_PARENT_NAME</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">SHAPE_CHECK</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">force_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em></dt>
<dd><p>Force explicit naming for indexed parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Always True</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
<p>Indexed parameters must be explicitly named in Stan code to
enable proper variable reference and assignment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_assign_depth</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">custom_types.Integer</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#IndexParameter.get_assign_depth"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculate the assignment depth for Stan loop structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Loop nesting level for this component’s assignment</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
<p>This method determines the appropriate loop nesting level for
defining this component in Stan code. The depth is calculated as:
- Number of dimensions minus one (last dimension is vectorized)
- Minus trailing singleton dimensions (except the last)
- Clipped to a minimum of zero</p>
<p>Assignment depth affects:
- Loop structure in generated Stan code
- Index variable management
- Vectorization opportunities</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_right_side</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_opts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_adjustment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#IndexParameter.get_right_side"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan indexing code.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Stan indexing expression</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
<p>Gets the name of the variable that is being indexed, then passes it to
the <cite>write_stan_operation</cite> method to get the full Stan code for the transformation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_transformation_assignment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_opts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#IndexParameter.get_transformation_assignment"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate transformation assignment without index options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index_opts</strong> – Index options (ignored for direct assignment)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan assignment statement</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p>Indexing parameters are assigned directly without loop indexing
since they represent specific element selection rather than
computed transformations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">neg_to_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_ind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">custom_types.Integer</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#IndexParameter.neg_to_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">neg_to_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_ind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">int64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.Integer</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">int64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Convert negative indices to positive indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_ind</strong> – Negative index or array of indices</p></li>
<li><p><strong>dim</strong> – Dimension size for conversion</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Positive indices</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If indices are out of bounds</p>
</dd>
</dl>
<p>Handles both scalar and array indices, performing bounds checking
and conversion from Python’s negative indexing convention.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#IndexParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Execute the mathematical operation using NumPy or PyTorch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>draws</strong> (<em>Union</em><em>[</em><em>torch.Tensor</em><em>, </em><em>custom_types.SampleType</em><em>]</em>) – Input values for the operation</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the mathematical operation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[torch.Tensor, npt.NDArray]</p>
</dd>
</dl>
<p>This abstract method defines the core computational logic for the
transformation. It must handle both NumPy and PyTorch inputs
appropriately to maintain backend compatibility.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#IndexParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate complete Stan indexing expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist</strong> (<em>str</em>) – Variable name to index</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan indexing expression with bracket notation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p>Handles complex indexing patterns including:
- Multiple array indices (creates separate bracket groups)
- Mixed slicing and array indexing
- Proper 1-based index conversion for Stan
- Colon notation for full dimension slicing</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">Log1pExpParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#Log1pExpParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UnaryTransformedParameter</span></code></p>
<p>Log(1 + exp(x)) transformation with numerical stability.</p>
<p>Computes log(1 + exp(x)) using numerically stable implementations that
avoid overflow for large positive values and underflow for large negative values.</p>
<p>Mathematical Properties:
- Domain: (-∞, ∞)
- Range: [0, ∞)
- Smooth approximation to max(0, x)
- Also known as “softplus” function</p>
<p>This transformation is essential for:
- Numerical stability in probabilistic models
- Log-space computations avoiding direct exponentiation</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">log_odds</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_prob</span> <span class="o">=</span> <span class="n">Log1pExpParameter</span><span class="p">(</span><span class="n">log_odds</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#Log1pExpParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute log(1 + exp(x)) with numerical stability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> – Input parameter</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>log(1 + exp(dist1))</p>
</dd>
</dl>
<p>Uses logaddexp(0, x) for numerical stability, which handles
both overflow (large positive x) and underflow (large negative x).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#Log1pExpParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan log1p_exp function call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted parameter string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan log1p_exp function call</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">LogExponentialGrowth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogExponentialGrowth"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformedParameter</span></code></p>
<p>Log-scale exponential growth model transformation.</p>
<p>Implements the logarithm of exponential growth: log(x) = log_A + r * t</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>custom_types.CombinableParameterType</em>) – Time parameter</p></li>
<li><p><strong>log_A</strong> (<em>custom_types.CombinableParameterType</em>) – Log-amplitude parameter (log of initial value)</p></li>
<li><p><strong>r</strong> (<em>custom_types.CombinableParameterType</em>) – Growth rate parameter</p></li>
<li><p><strong>kwargs</strong> – Additional arguments passed to parent class</p></li>
</ul>
</dd>
</dl>
<p>Mathematical Properties:
- Linear in log-space: log(x) = log_A + r * t
- Guaranteed positive output: x = exp(log_A + r * t) &gt; 0
- Growth rate r directly additive in log-space
- Natural for multiplicative processes</p>
<p>This transformation is particularly useful for:
- Population modeling where values must be positive
- Multiplicative growth processes
- Log-scale regression models
- Ensuring positive-valued outcomes</p>
<p>The log-scale parameterization avoids issues with negative values
and provides numerical stability for extreme growth rates.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time_points</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_initial_pop</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">4.6</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># log(100) ≈ 4.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">growth_rate</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_population</span> <span class="o">=</span> <span class="n">LogExponentialGrowth</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">time_points</span><span class="p">,</span> <span class="n">log_A</span><span class="o">=</span><span class="n">log_initial_pop</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                        <span class="n">r</span><span class="o">=</span><span class="n">growth_rate</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>Initialize log-exponential growth model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – Time parameter</p></li>
<li><p><strong>log_A</strong> – Log-amplitude parameter</p></li>
<li><p><strong>r</strong> – Rate parameter</p></li>
<li><p><strong>kwargs</strong> – Additional arguments</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogExponentialGrowth.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Compute log-exponential growth: log_A + r * t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – Time values</p></li>
<li><p><strong>log_A</strong> – Log-amplitude values</p></li>
<li><p><strong>r</strong> – Rate values</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Log-exponential growth values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogExponentialGrowth.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan code for the transformation operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>to_format</strong> (<em>str</em>) – Formatted parameter strings</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan code for the operation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If STAN_OPERATOR is not defined for simple operations</p>
</dd>
</dl>
<p>This method must be implemented to provide appropriate Stan code
for the mathematical operation represented by this transformation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">LogParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UnaryTransformedParameter</span></code></p>
<p>Natural logarithm transformation for parameters.</p>
<p>Implements element-wise natural logarithm: result = ln(dist1)</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>POSITIVE_PARAMS</strong> – Input must be positive ({“dist1”})</p>
</dd>
</dl>
<p>Mathematical Properties:
- Domain: (0, ∞)
- Range: (-∞, ∞)
- Logarithm laws: ln(ab) = ln(a) + ln(b), ln(a^b) = b*ln(a)
- Inverse: exp(ln(a)) = a for a &gt; 0</p>
<p>This transformation is fundamental for log-scale modeling, multiplicative
effects on additive scales, and ensuring positive-valued parameters.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">POSITIVE_PARAMS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'dist1'}</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute element-wise natural logarithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> – Input parameter (must be positive)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Natural logarithm of input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan logarithm function call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted parameter string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan log() function call</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">LogSigmoidGrowth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogSigmoidGrowth"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LogSigmoidParameter</span></code></p>
<p>Log-scale sigmoid growth model transformation.</p>
<p>Implements the logarithm of sigmoid growth: log(x) = log_A + log_sigmoid(r*(t - c))
This provides numerical stability and ensures positive values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>custom_types.CombinableParameterType</em>) – Time parameter</p></li>
<li><p><strong>log_A</strong> (<em>custom_types.CombinableParameterType</em>) – Log-amplitude parameter (log of carrying capacity)</p></li>
<li><p><strong>r</strong> (<em>custom_types.CombinableParameterType</em>) – Growth rate parameter</p></li>
<li><p><strong>c</strong> (<em>custom_types.CombinableParameterType</em>) – Inflection point parameter</p></li>
<li><p><strong>kwargs</strong> – Additional arguments passed to parent class</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>LOWER_BOUND</strong> – No lower bound (None)</p></li>
<li><p><strong>UPPER_BOUND</strong> – No upper bound (None)</p></li>
</ul>
</dd>
</dl>
<p>This parameterization is ideal for:
- Extreme parameter regimes
- Log-scale statistical modeling
- When initial conditions are naturally in log-space
- Maximum numerical precision requirements</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time_points</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_carrying_capacity</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">6.9</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># log(1000)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">growth_rate</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inflection_time</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_population</span> <span class="o">=</span> <span class="n">LogSigmoidGrowth</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">time_points</span><span class="p">,</span> <span class="n">log_A</span><span class="o">=</span><span class="n">log_carrying_capacity</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                    <span class="n">r</span><span class="o">=</span><span class="n">growth_rate</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">inflection_time</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>Initialize log-sigmoid growth model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – Time parameter</p></li>
<li><p><strong>log_A</strong> – Log-amplitude parameter</p></li>
<li><p><strong>r</strong> – Rate parameter</p></li>
<li><p><strong>c</strong> – Inflection point parameter</p></li>
<li><p><strong>kwargs</strong> – Additional arguments</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">LOWER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">UPPER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogSigmoidGrowth.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Compute log-sigmoid growth: log_A + log_sigmoid(r * (t - c)).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – Time values</p></li>
<li><p><strong>log_A</strong> – Log-amplitude values</p></li>
<li><p><strong>r</strong> – Rate values</p></li>
<li><p><strong>c</strong> – Inflection point values</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Log-sigmoid growth values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogSigmoidGrowth.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan code for unary operations using STAN_OPERATOR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted string for the parameter</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan code with prefix operator</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p>Generates Stan code in the format “OPERATOR dist1” for
standard unary operations.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">LogSigmoidGrowthInitParametrization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogSigmoidGrowthInitParametrization"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformedParameter</span></code></p>
<p>Log-scale sigmoid growth with initial value parameterization.</p>
<p>Log-space version of sigmoid growth parameterized by initial values,
providing numerical stability and guaranteed positive outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>custom_types.CombinableParameterType</em>) – Time parameter</p></li>
<li><p><strong>log_x0</strong> (<em>custom_types.CombinableParameterType</em>) – Log of initial abundance parameter</p></li>
<li><p><strong>r</strong> (<em>custom_types.CombinableParameterType</em>) – Growth rate parameter</p></li>
<li><p><strong>c</strong> (<em>custom_types.CombinableParameterType</em>) – Offset parameter</p></li>
<li><p><strong>kwargs</strong> – Additional arguments passed to parent class</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>LOWER_BOUND</strong> – No lower bound (None)</p></li>
<li><p><strong>UPPER_BOUND</strong> – No upper bound (None)</p></li>
</ul>
</dd>
</dl>
<p>Mathematical Properties:
- Fully operates in log-space for numerical stability
- Parameterized by log of initial conditions
- Uses log-add-exp computations throughout
- Maintains sigmoid growth dynamics</p>
<p>This parameterization is ideal for:
- Extreme parameter regimes
- Log-scale statistical modeling
- When initial conditions are naturally in log-space
- Maximum numerical precision requirements</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time_points</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_initial</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">4.6</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># log(100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">growth_rate</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_abundance</span> <span class="o">=</span> <span class="n">LogSigmoidGrowthInitParametrization</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">time_points</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">log_x0</span><span class="o">=</span><span class="n">log_initial</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">growth_rate</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>Initialize log-sigmoid growth with initial value parameterization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – Time parameter</p></li>
<li><p><strong>log_x0</strong> – Log of initial abundance parameter</p></li>
<li><p><strong>r</strong> – Growth rate parameter</p></li>
<li><p><strong>c</strong> – Offset parameter</p></li>
<li><p><strong>kwargs</strong> – Additional arguments</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">LOWER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">UPPER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogSigmoidGrowthInitParametrization.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Compute log-sigmoid growth with initial parameterization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – Time values</p></li>
<li><p><strong>log_x0</strong> – Log initial abundance values</p></li>
<li><p><strong>r</strong> – Rate values</p></li>
<li><p><strong>c</strong> – Offset values</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Log-sigmoid growth values</p>
</dd>
</dl>
<p>Computes: log_x0 + log(1+exp(r*c)) - log(1+exp(r*(c-t)))
using numerically stable log-add-exp operations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogSigmoidGrowthInitParametrization.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculate using Stan’s log1p_exp function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">LogSigmoidParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogSigmoidParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UnaryTransformedParameter</span></code></p>
<p>Defines a parameter that is the log of the sigmoid of another.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">UPPER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">custom_types.Float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogSigmoidParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Execute unary operation on single input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> – Input operand</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of unary operation</p>
</dd>
</dl>
<p>This method implements the core unary mathematical operation
for both NumPy and PyTorch backends.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogSigmoidParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan code for unary operations using STAN_OPERATOR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted string for the parameter</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan code with prefix operator</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p>Generates Stan code in the format “OPERATOR dist1” for
standard unary operations.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">LogSumExpParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogSumExpParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Reduction</span></code></p>
<p>Log-sum-exp reduction transformation.</p>
<p>Computes the logarithm of the sum of exponentials along the last dimension,
providing a numerically stable way to compute log(Σᵢ exp(xᵢ)).</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TORCH_FUNC</strong> – torch.logsumexp</p></li>
<li><p><strong>NP_FUNC</strong> – scipy.special.logsumexp</p></li>
</ul>
</dd>
</dl>
<p>Mathematical Properties:
- Operation: log(Σᵢ exp(xᵢ))
- Numerically stable for extreme values
- Maintains precision in log-space
- Essential for probabilistic computations</p>
<p>This transformation is fundamental for:
- Normalizing log-probabilities
- Computing partition functions
- Stable softmax computations
- Log-space mixture models</p>
<p>The log-sum-exp function is the smooth maximum approximation and
appears frequently in machine learning and statistics.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">log_weights</span> <span class="o">=</span> <span class="n">LogParameter</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_partition</span> <span class="o">=</span> <span class="n">LogSumExpParameter</span><span class="p">(</span><span class="n">log_weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalized_log_weights</span> <span class="o">=</span> <span class="n">log_weights</span> <span class="o">-</span> <span class="n">log_partition</span>
</pre></div>
</div>
</dd>
</dl>
<p>Initialize reduction with automatic shape calculation. Reduction is always
over the last dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist1</strong> (<em>custom_types.CombinableParameterType</em>) – Parameter to reduce</p></li>
<li><p><strong>keepdims</strong> (<em>bool</em>) – Whether to keep reduced dimension. Defaults to False.</p></li>
<li><p><strong>kwargs</strong> – Additional arguments for parent initialization</p></li>
</ul>
</dd>
</dl>
<p>The initialization automatically calculates the output shape by
removing the last dimension (or keeping it as size 1 if keepdims=True).</p>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">NP_FUNC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Compute the log of the sum of exponentials of input elements.</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h3>
<dl>
<dt>a<span class="classifier">array_like</span></dt><dd><p>Input array.</p>
</dd>
<dt>axis<span class="classifier">None or int or tuple of ints, optional</span></dt><dd><p>Axis or axes over which the sum is taken. By default <cite>axis</cite> is None,
and all elements are summed.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.11.0.</span></p>
</div>
</dd>
<dt>b<span class="classifier">array-like, optional</span></dt><dd><p>Scaling factor for exp(<cite>a</cite>) must be of the same shape as <cite>a</cite> or
broadcastable to <cite>a</cite>. These values may be negative in order to
implement subtraction.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.12.0.</span></p>
</div>
</dd>
<dt>keepdims<span class="classifier">bool, optional</span></dt><dd><p>If this is set to True, the axes which are reduced are left in the
result as dimensions with size one. With this option, the result
will broadcast correctly against the original array.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.15.0.</span></p>
</div>
</dd>
<dt>return_sign<span class="classifier">bool, optional</span></dt><dd><p>If this is set to True, the result will be a pair containing sign
information; if False, results that are negative will be returned
as NaN. Default is False (no sign information).</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.16.0.</span></p>
</div>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>res<span class="classifier">ndarray</span></dt><dd><p>The result, <code class="docutils literal notranslate"><span class="pre">np.log(np.sum(np.exp(a)))</span></code> calculated in a numerically
more stable way. If <cite>b</cite> is given then <code class="docutils literal notranslate"><span class="pre">np.log(np.sum(b*np.exp(a)))</span></code>
is returned. If <code class="docutils literal notranslate"><span class="pre">return_sign</span></code> is True, <code class="docutils literal notranslate"><span class="pre">res</span></code> contains the log of
the absolute value of the argument.</p>
</dd>
<dt>sgn<span class="classifier">ndarray</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">return_sign</span></code> is True, this will be an array of floating-point
numbers matching res containing +1, 0, -1 (for real-valued inputs)
or a complex phase (for complex inputs). This gives the sign of the
argument of the logarithm in <code class="docutils literal notranslate"><span class="pre">res</span></code>.
If <code class="docutils literal notranslate"><span class="pre">return_sign</span></code> is False, only one result is returned.</p>
</dd>
</dl>
</section>
<section id="see-also">
<h3>See Also<a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt><code class="xref py py-data docutils literal notranslate"><span class="pre">numpy.logaddexp</span></code></dt><dd></dd>
<dt><code class="xref py py-data docutils literal notranslate"><span class="pre">numpy.logaddexp2</span></code></dt><dd></dd>
</dl>
</section>
<section id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Link to this heading">¶</a></h3>
<p>NumPy has a logaddexp function which is very similar to <cite>logsumexp</cite>, but
only handles two arguments. <cite>logaddexp.reduce</cite> is similar to this
function, but may be less stable.</p>
<p>The logarithm is a multivalued function: for each <span class="math notranslate nohighlight">\(x\)</span> there is an
infinite number of <span class="math notranslate nohighlight">\(z\)</span> such that <span class="math notranslate nohighlight">\(exp(z) = x\)</span>. The convention
is to return the <span class="math notranslate nohighlight">\(z\)</span> whose imaginary part lies in <span class="math notranslate nohighlight">\((-pi, pi]\)</span>.</p>
<p><cite>logsumexp</cite> has experimental support for Python Array API Standard compatible
backends in addition to NumPy. Please consider testing these features
by setting an environment variable <code class="docutils literal notranslate"><span class="pre">SCIPY_ARRAY_API=1</span></code> and providing
CuPy, PyTorch, JAX, or Dask arrays as array arguments. The following
combinations of backend and device (or other capability) are supported.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Library</p></th>
<th class="head"><p>CPU</p></th>
<th class="head"><p>GPU</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NumPy</p></td>
<td><p>✅</p></td>
<td><p>n/a</p></td>
</tr>
<tr class="row-odd"><td><p>CuPy</p></td>
<td><p>n/a</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-even"><td><p>PyTorch</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p>JAX</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-even"><td><p>Dask</p></td>
<td><p>✅</p></td>
<td><p>n/a</p></td>
</tr>
</tbody>
</table>
<p>See <span class="xref std std-ref">dev-arrayapi</span> for more information.</p>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">logsumexp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logsumexp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">9.4586297444267107</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
<span class="go">9.4586297444267107</span>
</pre></div>
</div>
<p>With weights</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logsumexp</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
<span class="go">9.9170178533034665</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
<span class="go">9.9170178533034647</span>
</pre></div>
</div>
<p>Returning a sign flag</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logsumexp</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">b</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">return_sign</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(1.5413248546129181, -1.0)</span>
</pre></div>
</div>
<p>Notice that <cite>logsumexp</cite> does not directly support masked arrays. To use it
on a masked array, convert the mask into zero weights:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span>
<span class="gp">... </span>                 <span class="n">mask</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">a</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logsumexp</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1.6094379124341005, 1.6094379124341005</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#LogSumExpParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan log_sum_exp function call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted parameter string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan log_sum_exp function call</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">MultiplyParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#MultiplyParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryTransformedParameter</span></code></p>
<p>Element-wise multiplication transformation for two parameters.</p>
<p>Implements element-wise multiplication of two parameters: result = dist1 * dist2</p>
<p>Mathematical Properties:
- Commutative: a * b = b * a
- Associative: (a * b) * c = a * (b * c)
- Identity element: 1</p>
<p>This transformation is fundamental for scaling, interaction effects, and
product relationships between parameters.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">STAN_OPERATOR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'.*'</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#MultiplyParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Perform element-wise multiplication.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist1</strong> – First factor</p></li>
<li><p><strong>dist2</strong> – Second factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Product of the two inputs</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">NegateParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#NegateParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UnaryTransformedParameter</span></code></p>
<p>Unary negation transformation for parameters.</p>
<p>Implements element-wise negation of a parameter: result = -dist1</p>
<p>Mathematical Properties:
- Involutory: -(-a) = a
- Distributive over addition: -(a + b) = -a + -b
- Anti-distributive over multiplication: -(a * b) = (-a) * b = a * (-b)</p>
<p>This transformation is used for sign changes, directional effects,
and creating opposite relationships.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">STAN_OPERATOR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'-'</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#NegateParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Perform element-wise negation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> – Input parameter</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Negated input</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">NormalizeLogParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#NormalizeLogParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UnaryTransformedParameter</span></code></p>
<p>Log-space normalization transformation for log-probability vectors over the
last dimension of the input.</p>
<p>Implements normalization in log-space where log-probabilities are adjusted
so that their exponentiated values sum to 1. This is equivalent to
subtracting the log-sum-exp from each element.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>UPPER_BOUND</strong> – Log-probabilities are bounded above by 0.0</p>
</dd>
</dl>
<p>Mathematical Properties:
- Domain: (-∞, ∞)^n
- Range: Log-simplex {x : Σexp(xᵢ) = 1}
- Operation: xᵢ’ = xᵢ - log(Σⱼ exp(xⱼ))
- Numerically stable for extreme log-probabilities</p>
<p>This transformation is crucial for:
- Normalizing log-probabilities without exponentiation
- Stable computation with very small probabilities
- Log-space categorical distributions
- Attention mechanisms in log-space</p>
<p>The log-sum-exp operation provides numerical stability by avoiding
overflow/underflow issues common with direct exponentiation. As with the <cite>NormalizeParameter</cite>,
this is performed over the last dimension only.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">UPPER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">custom_types.Float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#NormalizeLogParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute log-space normalization using log-sum-exp.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> – Input log-probabilities</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized log-probabilities</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#NormalizeLogParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan log-space normalization code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted parameter string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan code using log_sum_exp function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">NormalizeParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#NormalizeParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UnaryTransformedParameter</span></code></p>
<p>Normalization transformation that scales values to sum to 1 in the last dimension
of the input.</p>
<p>Implements element-wise normalization where each vector is divided by its sum,
creating probability vectors or normalized weights that sum to unity.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>LOWER_BOUND</strong> – Normalized values are non-negative (0.0)</p></li>
<li><p><strong>UPPER_BOUND</strong> – Normalized values are bounded above by 1.0</p></li>
</ul>
</dd>
</dl>
<p>Mathematical Properties:
- Domain: [0, ∞)^n (non-negative input required)
- Range: Probability simplex {x : Σxᵢ = 1, xᵢ ≥ 0}
- Operation: xᵢ’ = xᵢ / Σⱼ xⱼ
- Preserves ratios between elements</p>
<p>This transformation is essential for:
- Converting counts to proportions
- Creating probability vectors from non-negative weights
- Normalizing attention weights or mixture components
- Ensuring categorical probabilities sum to one</p>
<p>The normalization is applied along the last dimension only, making it suitable
for batch processing of multiple probability vectors.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">LOWER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">custom_types.Float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">UPPER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">custom_types.Float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#NormalizeParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute normalization by dividing by sum along last dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> – Input parameter (must be non-negative)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized values that sum to 1 along last dimension</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#NormalizeParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan normalization code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted parameter string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan code dividing by sum</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">PowerParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#PowerParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryTransformedParameter</span></code></p>
<p>Element-wise exponentiation transformation for two parameters.</p>
<p>Implements element-wise exponentiation: result = dist1 ^ dist2</p>
<p>Mathematical Properties:
- Non-commutative: a^b ≠ b^a (generally)
- Non-associative: (a^b)^c ≠ a^(b^c) (generally)
- Identity element: 1 (for exponent), any base^1 = base</p>
<p>This transformation is used for power relationships, polynomial terms,
and exponential scaling effects.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">STAN_OPERATOR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'.^'</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#PowerParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Perform element-wise exponentiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist1</strong> – Base</p></li>
<li><p><strong>dist2</strong> – Exponent</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dist1 raised to the power of dist2</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">Reduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#Reduction"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UnaryTransformedParameter</span></code></p>
<p>Base class for operations that reduce dimensionality.</p>
<p>This abstract base class provides infrastructure for transformations that
reduce the size of the last dimension through operations like sum, mean,
or log-sum-exp. It handles shape management and provides specialized
indexing behavior for reductions.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SHAPE_CHECK</strong> – Disabled for reductions (False)</p></li>
<li><p><strong>TORCH_FUNC</strong> – PyTorch function for the reduction operation</p></li>
<li><p><strong>NP_FUNC</strong> – NumPy function for the reduction operation</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>dist1</strong> (<em>custom_types.CombinableParameterType</em>) – Parameter to reduce</p></li>
<li><p><strong>keepdims</strong> (<em>bool</em>) – Whether to keep the reduced dimension as size 1. Defaults to False.</p></li>
<li><p><strong>kwargs</strong> – Additional arguments passed to parent class</p></li>
</ul>
</dd>
</dl>
<p>Key Features:
- Automatic shape calculation for reduced dimensions
- Specialized index offset handling (always returns 0)
- Increased assignment depth for proper Stan loop structure
- Support for keepdims option to preserve dimensionality</p>
<p>Subclasses must define TORCH_FUNC and NP_FUNC class variables that
point to the appropriate reduction functions in each library.</p>
<dl class="simple">
<dt>Example:</dt><dd><p>Subclasses like SumParameter and LogSumExpParameter inherit from
this base class and define their specific reduction operations.</p>
</dd>
</dl>
<p>Initialize reduction with automatic shape calculation. Reduction is always
over the last dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist1</strong> (<em>custom_types.CombinableParameterType</em>) – Parameter to reduce</p></li>
<li><p><strong>keepdims</strong> (<em>bool</em>) – Whether to keep reduced dimension. Defaults to False.</p></li>
<li><p><strong>kwargs</strong> – Additional arguments for parent initialization</p></li>
</ul>
</dd>
</dl>
<p>The initialization automatically calculates the output shape by
removing the last dimension (or keeping it as size 1 if keepdims=True).</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">NP_FUNC</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">npt.NDArray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">npt.NDArray</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">SHAPE_CHECK</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">TORCH_FUNC</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">npt.NDArray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">npt.NDArray</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_assign_depth</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#Reduction.get_assign_depth"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return assignment depth one level higher than normal.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Assignment depth + 1</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
<p>Reductions require one additional level of loop nesting to properly
iterate over the dimension being reduced.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_index_offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">AbstractModelComponent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_adjustment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#Reduction.get_index_offset"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return zero offset for all reduction operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – Component or parameter name (ignored)</p></li>
<li><p><strong>offset_adjustment</strong> – Offset adjustment (ignored)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p>Reductions always return zero offset because they operate on the
last dimension and don’t require complex indexing adjustments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#Reduction.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Execute reduction operation with backend-appropriate function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist1</strong> – Input parameter to reduce</p></li>
<li><p><strong>keepdim</strong> (<em>Optional</em><em>[</em><em>bool</em><em>]</em>) – Whether to keep dimensions (static method only)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reduced parameter values</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If keepdim is provided for instance method calls</p>
</dd>
</dl>
<p>The method automatically selects between PyTorch and NumPy reduction
functions and applies them along the last dimension.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">SigmoidGrowth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#SigmoidGrowth"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SigmoidParameter</span></code></p>
<p>Sigmoid growth model transformation.</p>
<p>Implements sigmoid growth: x = A / (1 + exp(-r*(t - c)))
This models S-shaped growth curves with carrying capacity A.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>custom_types.CombinableParameterType</em>) – Time parameter</p></li>
<li><p><strong>A</strong> (<em>custom_types.CombinableParameterType</em>) – Amplitude parameter (carrying capacity)</p></li>
<li><p><strong>r</strong> (<em>custom_types.CombinableParameterType</em>) – Growth rate parameter</p></li>
<li><p><strong>c</strong> (<em>custom_types.CombinableParameterType</em>) – Inflection point parameter (time of fastest growth)</p></li>
<li><p><strong>kwargs</strong> – Additional arguments passed to parent class</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>LOWER_BOUND</strong> – Values are bounded below by 0.0</p></li>
<li><p><strong>UPPER_BOUND</strong> – No upper bound (None) as A can be any positive value</p></li>
</ul>
</dd>
</dl>
<p>Mathematical Properties:
- S-shaped growth curve
- A represents carrying capacity (maximum value)
- c represents inflection point (time of fastest growth)
- r controls steepness of growth
- Approaches 0 as t → -∞ and A as t → +∞</p>
<p>This transformation is essential for:
- Population growth with carrying capacity
- Any growth process with saturation</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time_points</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">carrying_capacity</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">growth_rate</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inflection_time</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">population</span> <span class="o">=</span> <span class="n">SigmoidGrowth</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">time_points</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="n">carrying_capacity</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">r</span><span class="o">=</span><span class="n">growth_rate</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">inflection_time</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>Initialize sigmoid growth model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – Time parameter</p></li>
<li><p><strong>A</strong> – Amplitude/carrying capacity parameter</p></li>
<li><p><strong>r</strong> – Rate parameter</p></li>
<li><p><strong>c</strong> – Inflection point parameter</p></li>
<li><p><strong>kwargs</strong> – Additional arguments</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">LOWER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">custom_types.Float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">UPPER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#SigmoidGrowth.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Compute sigmoid growth: A * sigmoid(r * (t - c)).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – Time values</p></li>
<li><p><strong>A</strong> – Amplitude values</p></li>
<li><p><strong>r</strong> – Rate values</p></li>
<li><p><strong>c</strong> – Inflection point values</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sigmoid growth values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#SigmoidGrowth.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan inverse logit function call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted parameter string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan inv_logit() function call</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">SigmoidGrowthInitParametrization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#SigmoidGrowthInitParametrization"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformedParameter</span></code></p>
<p>Sigmoid growth with initial value parameterization.</p>
<p>Alternative parameterization of sigmoid growth in terms of initial abundances
rather than carrying capacity. Uses numerically stable log-add-exp computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>custom_types.CombinableParameterType</em>) – Time parameter</p></li>
<li><p><strong>x0</strong> (<em>custom_types.CombinableParameterType</em>) – Initial abundance parameter</p></li>
<li><p><strong>r</strong> (<em>custom_types.CombinableParameterType</em>) – Growth rate parameter</p></li>
<li><p><strong>c</strong> (<em>custom_types.CombinableParameterType</em>) – Offset parameter (related to carrying capacity)</p></li>
<li><p><strong>kwargs</strong> – Additional arguments passed to parent class</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>LOWER_BOUND</strong> – Values are bounded below by 0.0</p></li>
<li><p><strong>UPPER_BOUND</strong> – No upper bound (None)</p></li>
</ul>
</dd>
</dl>
<p>Mathematical Properties:
- Parameterizes sigmoid growth by initial value x0
- Uses log-add-exp trick for numerical stability
- Avoids direct computation of large exponentials
- Maintains sigmoid growth dynamics</p>
<p>This parameterization is useful when:
- Initial conditions are better known than carrying capacity
- Numerical stability is crucial
- Working with extreme parameter values
- Modeling relative growth from baseline</p>
<p>The transformation uses the identity:
x(t) = x0 * exp(log(1+exp(r*c)) - log(1+exp(r*(c-t))))</p>
<p>Initialize sigmoid growth with initial value parameterization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – Time parameter</p></li>
<li><p><strong>x0</strong> – Initial abundance parameter</p></li>
<li><p><strong>r</strong> – Growth rate parameter</p></li>
<li><p><strong>c</strong> – Offset parameter</p></li>
<li><p><strong>kwargs</strong> – Additional arguments</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">LOWER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">custom_types.Float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">UPPER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#SigmoidGrowthInitParametrization.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Compute sigmoid growth with initial parameterization using log-add-exp.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – Time values</p></li>
<li><p><strong>x0</strong> – Initial abundance values</p></li>
<li><p><strong>r</strong> – Rate values</p></li>
<li><p><strong>c</strong> – Offset values</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sigmoid growth values</p>
</dd>
</dl>
<p>Uses log-add-exp for numerical stability in computing:
x0 * exp(log(1+exp(r*c)) - log(1+exp(r*(c-t))))</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#SigmoidGrowthInitParametrization.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculate using Stan’s log1p_exp function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">SigmoidParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#SigmoidParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UnaryTransformedParameter</span></code></p>
<p>Sigmoid (logistic) transformation for parameters.</p>
<p>Implements the sigmoid function: result = 1 / (1 + exp(-dist1))</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>LOWER_BOUND</strong> – Sigmoid values are bounded below by 0.0</p></li>
<li><p><strong>UPPER_BOUND</strong> – Sigmoid values are bounded above by 1.0</p></li>
</ul>
</dd>
</dl>
<p>Mathematical Properties:
- Domain: (-∞, ∞)
- Range: (0, 1)
- S-shaped curve with inflection point at x=0, y=0.5
- Inverse: logit function ln(p/(1-p))</p>
<p>The sigmoid function is essential for:
- Converting unbounded values to probabilities
- Logistic regression and classification
- Smooth transitions between bounds
- Activation functions in neural networks</p>
<p>This implementation uses numerically stable computation methods to
avoid overflow/underflow issues.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">LOWER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">custom_types.Float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">UPPER_BOUND</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">custom_types.Float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#SigmoidParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compute sigmoid function with numerical stability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> – Input parameter (logits)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sigmoid-transformed values in (0, 1)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[torch.Tensor, np.ndarray]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – If input type is not supported</p>
</dd>
</dl>
<p>Uses numerically stable implementations:
- PyTorch: Built-in torch.sigmoid function
- NumPy: Custom stable implementation from utils</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#SigmoidParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan inverse logit function call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted parameter string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan inv_logit() function call</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">SubtractParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#SubtractParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryTransformedParameter</span></code></p>
<p>Subtraction transformation for two parameters.</p>
<p>Implements element-wise subtraction of two parameters: result = dist1 - dist2</p>
<p>Mathematical Properties:
- Non-commutative: a - b ≠ b - a (generally)
- Non-associative: (a - b) - c ≠ a - (b - c) (generally)
- Identity element: 0 (for right operand)</p>
<p>This transformation is commonly used for computing differences, residuals,
and relative measures between parameters.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">STAN_OPERATOR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'-'</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#SubtractParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Perform element-wise subtraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist1</strong> – Minuend</p></li>
<li><p><strong>dist2</strong> – Subtrahend</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Difference of the two inputs</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">SumParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#SumParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Reduction</span></code></p>
<p>Sum reduction transformation.</p>
<p>Computes the sum of values along the last dimension: Σᵢ xᵢ</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TORCH_FUNC</strong> – torch.sum</p></li>
<li><p><strong>NP_FUNC</strong> – numpy.sum</p></li>
</ul>
</dd>
</dl>
<p>Mathematical Properties:
- Operation: Σᵢ xᵢ
- Linear operation
- Preserves units and scale
- Fundamental aggregation operation</p>
<p>This transformation is used for:
- Computing totals and aggregates
- Reducing dimensionality through summation
- Calculating marginal quantities
- Creating scalar summaries from vectors</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">category_counts</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">(</span><span class="n">lambda_</span><span class="o">=</span><span class="n">rates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total_count</span> <span class="o">=</span> <span class="n">SumParameter</span><span class="p">(</span><span class="n">category_counts</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>Initialize reduction with automatic shape calculation. Reduction is always
over the last dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist1</strong> (<em>custom_types.CombinableParameterType</em>) – Parameter to reduce</p></li>
<li><p><strong>keepdims</strong> (<em>bool</em>) – Whether to keep reduced dimension. Defaults to False.</p></li>
<li><p><strong>kwargs</strong> – Additional arguments for parent initialization</p></li>
</ul>
</dd>
</dl>
<p>The initialization automatically calculates the output shape by
removing the last dimension (or keeping it as size 1 if keepdims=True).</p>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">NP_FUNC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims=&lt;no</span> <span class="pre">value&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial=&lt;no</span> <span class="pre">value&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where=&lt;no</span> <span class="pre">value&gt;</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Sum of array elements over a given axis.</p>
<section id="id1">
<h3>Parameters<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<dl>
<dt>a<span class="classifier">array_like</span></dt><dd><p>Elements to sum.</p>
</dd>
<dt>axis<span class="classifier">None or int or tuple of ints, optional</span></dt><dd><p>Axis or axes along which a sum is performed.  The default,
axis=None, will sum all of the elements of the input array.  If
axis is negative it counts from the last to the first axis. If
axis is a tuple of ints, a sum is performed on all of the axes
specified in the tuple instead of a single axis or all the axes as
before.</p>
</dd>
<dt>dtype<span class="classifier">dtype, optional</span></dt><dd><p>The type of the returned array and of the accumulator in which the
elements are summed.  The dtype of <cite>a</cite> is used by default unless <cite>a</cite>
has an integer dtype of less precision than the default platform
integer.  In that case, if <cite>a</cite> is signed then the platform integer
is used while if <cite>a</cite> is unsigned then an unsigned integer of the
same precision as the platform integer is used.</p>
</dd>
<dt>out<span class="classifier">ndarray, optional</span></dt><dd><p>Alternative output array in which to place the result. It must have
the same shape as the expected output, but the type of the output
values will be cast if necessary.</p>
</dd>
<dt>keepdims<span class="classifier">bool, optional</span></dt><dd><p>If this is set to True, the axes which are reduced are left
in the result as dimensions with size one. With this option,
the result will broadcast correctly against the input array.</p>
<p>If the default value is passed, then <cite>keepdims</cite> will not be
passed through to the <cite>sum</cite> method of sub-classes of
<cite>ndarray</cite>, however any non-default value will be.  If the
sub-class’ method does not implement <cite>keepdims</cite> any
exceptions will be raised.</p>
</dd>
<dt>initial<span class="classifier">scalar, optional</span></dt><dd><p>Starting value for the sum. See <cite>~numpy.ufunc.reduce</cite> for details.</p>
</dd>
<dt>where<span class="classifier">array_like of bool, optional</span></dt><dd><p>Elements to include in the sum. See <cite>~numpy.ufunc.reduce</cite> for details.</p>
</dd>
</dl>
</section>
<section id="id2">
<h3>Returns<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>sum_along_axis<span class="classifier">ndarray</span></dt><dd><p>An array with the same shape as <cite>a</cite>, with the specified
axis removed.   If <cite>a</cite> is a 0-d array, or if <cite>axis</cite> is None, a scalar
is returned.  If an output array is specified, a reference to
<cite>out</cite> is returned.</p>
</dd>
</dl>
</section>
<section id="id3">
<h3>See Also<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>ndarray.sum : Equivalent method.
add: <code class="docutils literal notranslate"><span class="pre">numpy.add.reduce</span></code> equivalent function.
cumsum : Cumulative sum of array elements.
trapezoid : Integration of array values using composite trapezoidal rule.</p>
<p>mean, average</p>
</section>
<section id="id4">
<h3>Notes<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>Arithmetic is modular when using integer types, and no error is
raised on overflow.</p>
<p>The sum of an empty array is the neutral element 0:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([])</span>
<span class="go">0.0</span>
</pre></div>
</div>
<p>For floating point numbers the numerical precision of sum (and
<code class="docutils literal notranslate"><span class="pre">np.add.reduce</span></code>) is in general limited by directly adding each number
individually to the result causing rounding errors in every step.
However, often numpy will use a  numerically better approach (partial
pairwise summation) leading to improved precision in many use-cases.
This improved precision is always provided when no <code class="docutils literal notranslate"><span class="pre">axis</span></code> is given.
When <code class="docutils literal notranslate"><span class="pre">axis</span></code> is given, it will depend on which axis is summed.
Technically, to provide the best speed possible, the improved precision
is only used when the summation is along the fast axis in memory.
Note that the exact precision may vary depending on other parameters.
In contrast to NumPy, Python’s <code class="docutils literal notranslate"><span class="pre">math.fsum</span></code> function uses a slower but
more precise approach to summation.
Especially when summing a large number of lower precision floating point
numbers, such as <code class="docutils literal notranslate"><span class="pre">float32</span></code>, numerical errors can become significant.
In such cases it can be advisable to use <cite>dtype=”float64”</cite> to use a higher
precision for the output.</p>
</section>
<section id="id5">
<h3>Examples<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="go">np.int32(1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([0, 6])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([1, 5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span> <span class="n">where</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([1., 5.])</span>
</pre></div>
</div>
<p>If the accumulator is too small, overflow occurs:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
<span class="go">np.int8(-128)</span>
</pre></div>
</div>
<p>You can also start the sum with a value other than zero:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="mi">10</span><span class="p">],</span> <span class="n">initial</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">15</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#SumParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan sum function call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted parameter string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan sum function call</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">TransformableParameter</span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#TransformableParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Mixin class enabling mathematical operator overloading for parameters.</p>
<p>This mixin class provides Python operator overloading capabilities that allow
parameters to be combined using natural mathematical syntax. Each operator
creates an appropriate TransformedParameter instance that represents the
mathematical operation.</p>
<p>The mixin supports all standard arithmetic operators:
- Addition (+), subtraction (-)
- Multiplication (*), division (/)
- Exponentiation (**)
- Unary negation (-)</p>
<p>Each operation supports both left and right operand positioning, enabling
flexible mathematical expressions with mixed parameter and constant types.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">param1</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param2</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># All of these create TransformedParameter instances</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sum_param</span> <span class="o">=</span> <span class="n">param1</span> <span class="o">+</span> <span class="n">param2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled_param</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">param1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratio_param</span> <span class="o">=</span> <span class="n">param1</span> <span class="o">/</span> <span class="n">param2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">power_param</span> <span class="o">=</span> <span class="n">param1</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">negated_param</span> <span class="o">=</span> <span class="o">-</span><span class="n">param1</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">Transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="s"><span class="pre">'custom_types.Integer'</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#Transformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractModelComponent</span></code></p>
<p>Base class for all parameter transformations in SciStanPy.</p>
<p>This abstract base class provides the foundational infrastructure for
creating transformations that can be used in both the transformed parameters
and transformed data blocks of Stan models. It handles the common aspects
of transformation operations including shape validation and Stan code generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>SHAPE_CHECK</strong> – Whether to perform automatic shape checking. Defaults to True.</p>
</dd>
</dl>
<p>Key Responsibilities:
- Coordinate transformation assignment code generation
- Manage shape validation for transformation outputs
- Provide abstract interface for Stan operation writing
- Handle index options and assignment formatting</p>
<p>The class provides methods for generating Stan code assignments and manages
the interaction between transformation inputs and outputs. Subclasses must
implement the write_stan_operation method to define their specific
mathematical operations.</p>
<p>Shape handling can be disabled for transformations that perform reductions
or other operations that fundamentally change dimensionality.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">SHAPE_CHECK</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_right_side</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_opts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_adjustment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#Transformation.get_right_side"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate right-hand side of transformation assignment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index_opts</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em><em>]</em>) – Index options for multi-dimensional operations</p></li>
<li><p><strong>start_dims</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>custom_types.Integer</em><em>]</em><em>]</em>) – First indexable dimension of parent parameters. Defaults to None.</p></li>
<li><p><strong>end_dims</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>custom_types.Integer</em><em>]</em><em>]</em>) – Last indexable dimension of parent parameters. Defaults to None.</p></li>
<li><p><strong>offset_adjustment</strong> (<em>int</em>) – Index offset adjustment. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan code for the right-hand side of the assignment</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p>This method coordinates the formatting of parent parameters and applies
the transformation operation. It automatically adds parentheses around
operations when the transformation is not named.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">to_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#Transformation.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">TransformedParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'custom_types.Integer'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="s"><span class="pre">'custom_types.Integer'</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#TransformedParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Transformation</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformableParameter</span></code></p>
<p>Base class for transformed parameters that can be used in parameter blocks.</p>
<p>This class provides the foundation for parameters that result from mathematical
operations on other parameters. It handles both the computational aspects
(sampling, PyTorch operations) and code generation aspects (Stan assignments).</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>STAN_OPERATOR</strong> – Stan operator string for simple operations</p>
</dd>
</dl>
<p>Transformed parameters support:
- Sampling through parent parameter sampling and operation application
- PyTorch operations with automatic differentiation
- Stan code generation for transformed parameters block
- Further transformation through operator overloading</p>
<p>The class provides the infrastructure for creating complex mathematical
expressions while maintaining compatibility with all SciStanPy backends.</p>
<p>Subclasses must implement:
- run_np_torch_op: The core mathematical operation
- write_stan_operation: Stan code generation for the operation</p>
<dl class="simple">
<dt>Example Usage:</dt><dd><p>TransformedParameter subclasses are typically created through operator
overloading or the <cite>operations</cite> submodule rather than direct instantiation,
but can be used directly for custom operations.</p>
</dd>
</dl>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">STAN_OPERATOR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_transformation_assignment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_opts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assignment_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_side_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span></dt>
<dd><p>Generate complete transformation assignment code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index_opts</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em><em>]</em>) – Index variable names for multi-dimensional operations</p></li>
<li><p><strong>assignment_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>]</em>) – Keyword arguments for assignment formatting. Defaults to None.</p></li>
<li><p><strong>right_side_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>]</em>) – Keyword arguments for right-side formatting. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Complete Stan assignment statement</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p>This method combines the left-hand side variable name with the right-hand
side operation to create a complete Stan assignment statement suitable
for use in transformed parameters or transformed data blocks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">draws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#TransformedParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">draws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Execute the mathematical operation using NumPy or PyTorch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>draws</strong> (<em>Union</em><em>[</em><em>torch.Tensor</em><em>, </em><em>custom_types.SampleType</em><em>]</em>) – Input values for the operation</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the mathematical operation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[torch.Tensor, npt.NDArray]</p>
</dd>
</dl>
<p>This abstract method defines the core computational logic for the
transformation. It must handle both NumPy and PyTorch inputs
appropriately to maintain backend compatibility.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">torch_parametrization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em></dt>
<dd><p>Get PyTorch representation with transformations applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>PyTorch tensor with operation applied to parent tensors</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
<p>This property applies the transformation operation to the PyTorch
parameterizations of all parent parameters, maintaining gradient
flow for optimization.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">to_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#TransformedParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan code for the transformation operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>to_format</strong> (<em>str</em>) – Formatted parameter strings</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan code for the operation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If STAN_OPERATOR is not defined for simple operations</p>
</dd>
</dl>
<p>This method must be implemented to provide appropriate Stan code
for the mathematical operation represented by this transformation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scistanpy.model.components.transformations.transformed_parameters.</span></span><span class="sig-name descname"><span class="pre">UnaryTransformedParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.CombinableParameterType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#UnaryTransformedParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformedParameter</span></code></p>
<p>Base class for transformations involving exactly one parameter.</p>
<p>This class provides a specialized interface for unary mathematical operations
such as negation, absolute value, logarithms, and exponentials. It enforces
the single-parameter constraint and provides appropriate method signatures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist1</strong> (<em>custom_types.CombinableParameterType</em>) – Parameter for the operation</p></li>
<li><p><strong>kwargs</strong> – Additional arguments passed to parent class</p></li>
</ul>
</dd>
</dl>
<p>Unary operations are essential for mathematical transformations and provide
common functions needed in statistical modeling and parameter reparameterization.</p>
<p>Subclasses must implement run_np_torch_op with the single-parameter signature
and can optionally override write_stan_operation for custom Stan formatting.</p>
<p>Initialize a model component with specified shape and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>tuple</em><em>[</em><em>custom_types.Integer</em><em>, </em><em>...</em><em>]</em><em>, </em><em>custom_types.Integer</em><em>]</em>) – Shape of the component.</p></li>
<li><p><strong>model_params</strong> (<em>custom_types.CombinableParameterType</em>) – Named parameters this component depends on</p></li>
</ul>
</dd>
</dl>
<p>The initialization process:
1. Normalizes shape specification to tuple format (i.e., integer to 1-element tuple)
2. Validates parameter constraints and bounds
3. Converts non-component parameters to constants
4. Establishes parent-child relationships
5. Validates and sets component shape through broadcasting</p>
<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#UnaryTransformedParameter.run_np_torch_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run_np_torch_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">custom_types.SampleType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarType_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Execute unary operation on single input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> – Input operand</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of unary operation</p>
</dd>
</dl>
<p>This method implements the core unary mathematical operation
for both NumPy and PyTorch backends.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">write_stan_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/scistanpy/model/components/transformations/transformed_parameters.html#UnaryTransformedParameter.write_stan_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate Stan code for unary operations using STAN_OPERATOR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist1</strong> (<em>str</em>) – Formatted string for the parameter</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stan code with prefix operator</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p>Generates Stan code in the format “OPERATOR dist1” for
standard unary operations.</p>
</dd></dl>

</dd></dl>

</section>
<section id="mathematical-transformations">
<h2>Mathematical Transformations<a class="headerlink" href="#mathematical-transformations" title="Link to this heading">¶</a></h2>
<p>The transformations system allows you to create complex mathematical relationships:</p>
<p><strong>Example Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scistanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ssp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Basic parameter</span>
<span class="n">log_rate</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Transform to ensure positive values</span>
<span class="n">rate</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_rate</span><span class="p">)</span>

<span class="c1"># Use in further calculations</span>
<span class="n">concentration</span> <span class="o">=</span> <span class="n">initial_conc</span> <span class="o">*</span> <span class="n">ssp</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">rate</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="transformation-types">
<h2>Transformation Types<a class="headerlink" href="#transformation-types" title="Link to this heading">¶</a></h2>
<p>SciStanPy provides several types of transformations:</p>
<ul class="simple">
<li><p><strong>Unary transformations</strong>: Operations on single parameters (exp, log, abs, etc.)</p></li>
<li><p><strong>Binary transformations</strong>: Operations between parameters (+, -, *, /, etc.)</p></li>
<li><p><strong>Specialized transformations</strong>: Domain-specific mathematical functions</p></li>
</ul>
<p>All transformations:</p>
<ul class="simple">
<li><p><strong>Preserve gradients</strong>: Support automatic differentiation</p></li>
<li><p><strong>Generate Stan code</strong>: Automatically convert to Stan syntax</p></li>
<li><p><strong>Handle broadcasting</strong>: Work with arrays and scalars consistently</p></li>
<li><p><strong>Validate inputs</strong>: Check mathematical constraints</p></li>
</ul>
</section>
<section id="stan-code-generation">
<h2>Stan Code Generation<a class="headerlink" href="#stan-code-generation" title="Link to this heading">¶</a></h2>
<p>Transformations automatically generate appropriate Stan code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Python expression</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">ssp</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_param</span><span class="p">)</span> <span class="o">+</span> <span class="n">constant_value</span>

<span class="c1"># Automatically generates Stan code like:</span>
<span class="c1"># result = exp(log_param) + constant_value;</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../../index.html">SciStanPy</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">SciStanPy API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#scope">Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#top-level-package">Top-Level Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#module-overview">Module Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html#quick-navigation">Quick Navigation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../custom_types.html">Custom Types API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../defaults.html">Defaults API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../exceptions.html">Exceptions API Reference</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">Model API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../plotting/index.html">Plotting API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../operations.html">Operations API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../utils.html">Utils API Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#usage-notes">Usage Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#stability">Stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#missing-something">Missing Something?</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">SciStanPy API Reference</a><ul>
  <li><a href="../../index.html">Model API Reference</a><ul>
  <li><a href="../index.html">Model Components API Reference</a><ul>
      <li>Previous: <a href="../parameters.html" title="previous chapter">Parameters API Reference</a></li>
      <li>Next: <a href="cdfs.html" title="next chapter">CDFs API Reference</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Bruce Wittmann.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.3.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../../../../_sources/docs/api/model/components/transformations/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>